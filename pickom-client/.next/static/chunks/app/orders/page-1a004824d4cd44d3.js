(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1778],{6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>o,HW:()=>n,TK:()=>s,op:()=>d,wz:()=>i});var r=a(51070);let i=async e=>(await r.x.get("/user/".concat(e))).data,s=async(e,t)=>(await r.x.put("/user/".concat(e),t)).data,n=async()=>(await r.x.get("/auth/me")).data,o=async(e,t)=>(await r.x.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,d=async e=>(await r.x.get("/user/".concat(e,"/balance"))).data},13520:(e,t,a)=>{Promise.resolve().then(a.bind(a,73454))},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var r=a(23915),i=a(45404);let s=(0,r.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),n=(0,i.xI)(s)},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>o,S1:()=>u,TS:()=>x,XE:()=>d,confirmRecipient:()=>p,createDeliveryRequest:()=>s,qM:()=>c,rg:()=>f,updateDeliveryRequest:()=>l,vd:()=>i,zW:()=>n});var r=a(51070);let i=async()=>r.B.get("/delivery/pickers"),s=async e=>r.x.post("/delivery/requests",e),n=async()=>r.x.get("/delivery/requests"),o=async e=>r.x.get("/delivery/requests/".concat(e)),d=async(e,t)=>r.x.put("/delivery/requests/".concat(e,"/status"),{status:t}),l=async(e,t)=>r.x.patch("/delivery/requests/".concat(e),t),c=async()=>r.x.get("/delivery/completed"),u=async()=>r.x.get("/delivery/cancelled"),p=async(e,t)=>r.x.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),f=async e=>r.x.post("/delivery/find-receiver",{email:e}),x=async()=>r.x.get("/delivery/incoming")},42776:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});let r={primary:{main:"#FF9500",light:"#FFB340",dark:"#E68600",contrastText:"#000000"},avatar:{main:"#6366F1",light:"#8B8EF5",dark:"#4F46E5"},status:{active:"#FFC107",confirmed:"#2196F3",completed:"#4CAF50",cancelled:"#9E9E9E",error:"#f44336"},light:{background:{default:"#ffffff",paper:"#ffffff",elevated:"#f5f5f5",hover:"#f9f9f9"},text:{primary:"#1a1a1a",secondary:"#666666",disabled:"#9e9e9e"},border:{main:"#e0e0e0",light:"#f0f0f0",dark:"#d0d0d0"},action:{hover:"rgba(0, 0, 0, 0.04)",selected:"rgba(0, 0, 0, 0.08)",disabled:"rgba(0, 0, 0, 0.26)"}},dark:{background:{default:"#000000",paper:"#1a1a1a",elevated:"#2a2a2a",hover:"#252525"},text:{primary:"#ffffff",secondary:"#b0b0b0",disabled:"#666666"},border:{main:"#3a3a3a",light:"#2a2a2a",dark:"#4a4a4a"},action:{hover:"rgba(255, 255, 255, 0.08)",selected:"rgba(255, 255, 255, 0.16)",disabled:"rgba(255, 255, 255, 0.3)"}}}},51070:(e,t,a)=>{"use strict";a.d(t,{B:()=>n,x:()=>s});var r=a(23464),i=a(14140);let s=r.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(async e=>{let t=i.j.currentUser;if(t){let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}return e},e=>Promise.reject(e));let n=r.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}})},73454:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(95155),i=a(12115),s=a(54581),n=a(71116),o=a(3127),d=a(70541),l=a(18096),c=a(14426),u=a(92302),p=a(38464),f=a(35695),x=a(43452),h=a(72705),b=a(41101),m=a(58343),g=a(91204),v=a(42776),y=a(86335);let j=(0,i.memo)(function(e){let{order:t,onViewDetails:a,onContactPicker:i}=e,o=(0,y.GP)(t.pickupDateTime,"MMM dd, yyyy"),d=(0,y.GP)(t.pickupDateTime,"HH:mm"),l=t.picker&&i;return(0,r.jsxs)(s.default,{sx:{backgroundColor:"background.paper",borderRadius:2,p:2,mb:2,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:"divider",transition:"box-shadow 0.2s","&:hover":{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.12)"}},children:[(0,r.jsxs)(h.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[(0,r.jsx)(n.default,{variant:"caption",color:"text.secondary",children:t.trackingNumber}),(0,r.jsx)(b.A,{label:(0,g.ps)(t.status),size:"small",sx:{backgroundColor:(0,g.qY)(t.status),color:"#fff",fontWeight:"bold",fontSize:"0.75rem"}})]}),(0,r.jsxs)(s.default,{sx:{mb:2},children:[(0,r.jsx)(n.default,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Route"}),(0,r.jsx)(n.default,{variant:"body1",sx:{fontWeight:"bold",fontSize:"0.95rem"},children:(0,g.dH)(t)})]}),(0,r.jsxs)(h.A,{direction:"row",spacing:2,sx:{mb:2},children:[(0,r.jsxs)(s.default,{sx:{flex:1},children:[(0,r.jsx)(n.default,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Pickup Date"}),(0,r.jsx)(n.default,{variant:"body2",sx:{fontWeight:500},children:o})]}),(0,r.jsxs)(s.default,{sx:{flex:1},children:[(0,r.jsx)(n.default,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:"Time"}),(0,r.jsx)(n.default,{variant:"body2",sx:{fontWeight:500},children:d})]})]}),(0,r.jsx)(s.default,{sx:{mb:2},children:(0,r.jsxs)(n.default,{variant:"h6",sx:{fontWeight:"bold",color:v.T.primary.main},children:[t.price," ",t.currency]})}),t.picker&&(0,r.jsxs)(s.default,{sx:{mb:2,p:1.5,backgroundColor:"background.default",borderRadius:1},children:[(0,r.jsx)(n.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Picker"}),(0,r.jsxs)(h.A,{direction:"row",spacing:1.5,alignItems:"center",children:[(0,r.jsx)(m.H8,{type:"picker",name:t.picker.fullName,src:t.picker.avatarUrl,size:"small"}),(0,r.jsxs)(s.default,{sx:{flex:1},children:[(0,r.jsx)(n.default,{variant:"body2",sx:{fontWeight:600},children:t.picker.fullName}),(0,r.jsxs)(n.default,{variant:"caption",color:"text.secondary",children:["⭐ ",t.picker.rating.toFixed(1)]})]})]})]}),(0,r.jsxs)(h.A,{direction:"row",spacing:1,children:[(0,r.jsx)(m.$n,{variant:"outlined",size:"small",onClick:()=>a(t.id),fullWidth:!0,children:"View Details"}),l&&(0,r.jsx)(m.$n,{variant:"contained",size:"small",onClick:()=>i(t.id),fullWidth:!0,children:"Contact"})]})]})});var k=a(97704),C=a(21787),A=a(6864);function w(){let e=(0,f.useRouter)(),[t,h]=(0,i.useState)(g.Re.ACTIVE),[b,m]=(0,i.useState)([]),[v,y]=(0,i.useState)(!0),[w,E]=(0,i.useState)("");(0,i.useEffect)(()=>{(async()=>{y(!0),E("");try{let e=(await (0,C.zW)()).data,t=await Promise.all(e.map(async e=>{let t,a;switch(e.status){case"pending":default:t=g.Re.PENDING;break;case"accepted":case"picked_up":t=g.Re.ACTIVE;break;case"delivered":t=g.Re.COMPLETED;break;case"cancelled":t=g.Re.CANCELLED}if(e.pickerId)try{let{user:t}=await (0,A.wz)(e.pickerId);a={id:t.uid,fullName:t.name||"Picker",rating:t.rating||0,avatarUrl:t.avatarUrl}}catch(t){console.error("Failed to fetch picker data for pickerId:",e.pickerId,t),a={id:e.pickerId,fullName:"Picker",rating:0}}return{id:e.id.toString(),trackingNumber:"PCK".concat(e.id.toString().padStart(6,"0")),status:t,deliveryMethod:"within-city",packageType:"SMALL_PARCEL",pickup:{address:e.fromAddress},dropoff:{address:e.toAddress},createdAt:new Date(e.createdAt),pickupDateTime:new Date(e.createdAt),price:e.price,currency:"USD",picker:a}}));m(t)}catch(e){console.error("Failed to fetch orders:",e),E("Failed to load orders. Please try again.")}finally{y(!1)}})()},[]);let I=(0,i.useMemo)(()=>b.filter(e=>e.status===t),[b,t]),D=t=>{e.push("/delivery-details/".concat(t))},F=async t=>{let r=b.find(e=>e.id===t);if(null==r?void 0:r.picker)try{let{createChat:i}=await a.e(6509).then(a.bind(a,16509)),{chatId:s}=(await i({participantId:r.picker.id,deliveryId:parseInt(t)})).data;e.push("/chat/".concat(s))}catch(e){console.error("Failed to create chat:",e)}};return(0,r.jsx)(s.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,r.jsxs)(s.default,{sx:{position:"relative",width:"100%",maxWidth:375,height:812},children:[(0,r.jsx)(x.MobileContainer,{showFrame:!1,children:(0,r.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",p:2,borderBottom:1,borderColor:"divider"},children:[(0,r.jsx)(o.A,{onClick:()=>{e.back()},sx:{mr:1,p:1},children:(0,r.jsx)(p.A,{})}),(0,r.jsx)(n.default,{variant:"h5",sx:{fontWeight:600,fontSize:"1.5rem"},children:"My Orders"})]}),(0,r.jsxs)(d.A,{value:t,onChange:(e,t)=>{h(t)},variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider",minHeight:48,"& .MuiTab-root":{minHeight:48,fontSize:"0.875rem",fontWeight:500,textTransform:"none"}},children:[(0,r.jsx)(l.A,{label:"Active",value:g.Re.ACTIVE}),(0,r.jsx)(l.A,{label:"Pending",value:g.Re.PENDING}),(0,r.jsx)(l.A,{label:"Completed",value:g.Re.COMPLETED}),(0,r.jsx)(l.A,{label:"Cancelled",value:g.Re.CANCELLED})]}),(0,r.jsx)(s.default,{sx:{flex:1,overflow:"auto",pb:8,px:2,pt:2},children:v?(0,r.jsx)(s.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:8},children:(0,r.jsx)(c.default,{})}):w?(0,r.jsx)(s.default,{sx:{py:2},children:(0,r.jsx)(u.A,{severity:"error",children:w})}):0===I.length?(()=>{let e={[g.Re.ACTIVE]:{emoji:"\uD83D\uDE9A",title:"No active deliveries",description:"You have no orders currently in delivery"},[g.Re.PENDING]:{emoji:"⏳",title:"No pending orders",description:"All your orders have been picked up or completed"},[g.Re.COMPLETED]:{emoji:"✅",title:"No completed orders",description:"Your completed deliveries will appear here"},[g.Re.CANCELLED]:{emoji:"❌",title:"No cancelled orders",description:"You have no cancelled orders"}}[t];return(0,r.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8,px:3},children:[(0,r.jsx)(n.default,{sx:{fontSize:"4rem",mb:2},children:e.emoji}),(0,r.jsx)(n.default,{variant:"h6",sx:{fontWeight:600,mb:1,textAlign:"center"},children:e.title}),(0,r.jsx)(n.default,{variant:"body2",color:"text.secondary",sx:{textAlign:"center"},children:e.description})]})})():I.map(e=>(0,r.jsx)(j,{order:e,onViewDetails:D,onContactPicker:F},e.id))})]})}),(0,r.jsx)(k.default,{})]})})}},91204:(e,t,a)=>{"use strict";a.d(t,{$2:()=>s,HX:()=>i,Re:()=>r,dH:()=>l,po:()=>n,ps:()=>d,qY:()=>o});var r=function(e){return e.PENDING="pending",e.ACTIVE="active",e.COMPLETED="completed",e.CANCELLED="cancelled",e}({});function i(e){return"pending"===e.status||"active"===e.status}function s(e){return"completed"===e.status&&!e.review}function n(e){return"active"===e.status&&!!e.picker}function o(e){switch(e){case"pending":return"#FF9500";case"active":return"#2196F3";case"completed":return"#4CAF50";default:return"#9E9E9E"}}function d(e){switch(e){case"pending":return"Pending";case"active":return"Active";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return"Unknown"}}function l(e){let t=e.pickup.city||e.pickup.address,a=e.dropoff.city||e.dropoff.address;return"".concat(t," → ").concat(a)}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var r=a(95155),i=a(12115),s=a(35695),n=a(18407),o=a(40541),d=a(9111),l=a(26564),c=a(11335),u=a(21888),p=a(43290),f=a(60807);let x=e=>e>99?"99+":e,h=(0,i.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:h=0,userRole:b}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=(0,s.useRouter)(),g=(0,s.usePathname)(),[v,y]=(0,i.useState)(()=>localStorage.getItem("userRole"));(0,i.useEffect)(()=>{if(!b){let e=null;g.startsWith("/available-deliveries")?e="picker":g.startsWith("/delivery-methods")&&(e="sender"),e&&e!==v&&(y(e),localStorage.setItem("userRole",e))}},[g,b,v]);let j=b||v,k=(0,i.useMemo)(()=>g.startsWith("/delivery-methods")||g.startsWith("/orders")||g.startsWith("/available-deliveries")?0:g.startsWith("/chat")?1:g.startsWith("/notifications")?2:3*!!g.startsWith("/profile"),[g]),[C,A]=(0,i.useState)(k),w=(0,i.useCallback)((e,t)=>{switch(A(t),t){case 0:"picker"===j?m.push("/available-deliveries"):m.push("/delivery-methods");break;case 1:m.push("/chats");break;case 2:m.push("/notifications");break;case 3:m.push("/profile")}},[m,j]);return(0,r.jsx)(n.A,{className:e,sx:{position:"absolute",bottom:0,left:0,right:0,zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"none"},elevation:0,children:(0,r.jsxs)(o.A,{value:C,onChange:w,sx:{backgroundColor:"background.paper"},children:[(0,r.jsx)(d.A,{label:"Orders",icon:(0,r.jsx)(l.default,{badgeContent:x(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(c.default,{})})}),(0,r.jsx)(d.A,{label:"Chat",icon:(0,r.jsx)(l.default,{badgeContent:x(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(u.A,{})})}),(0,r.jsx)(d.A,{label:"Notifications",icon:(0,r.jsx)(l.default,{badgeContent:x(h),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(p.A,{})})}),(0,r.jsx)(d.A,{label:"Profile",icon:(0,r.jsx)(f.default,{})})]})})})}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,1101,8449,1190,9283,1986,7262,2649,7212,3295,8343,8441,5964,7358],()=>e(e.s=13520)),_N_E=e.O()}]);