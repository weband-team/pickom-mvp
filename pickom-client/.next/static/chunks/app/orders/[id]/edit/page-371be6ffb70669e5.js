(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5969],{6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>i,TK:()=>r,op:()=>o,wz:()=>l});var s=a(51070);let l=async e=>(await s.x.get("/user/".concat(e))).data,r=async(e,t)=>(await s.x.put("/user/".concat(e),t)).data,i=async()=>(await s.x.get("/auth/me")).data,n=async(e,t)=>(await s.x.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,o=async e=>(await s.x.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>i});var s=a(23915),l=a(45404);let r=(0,s.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),i=(0,l.xI)(r)},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>n,S1:()=>u,TS:()=>x,XE:()=>o,confirmRecipient:()=>h,createDeliveryRequest:()=>r,qM:()=>d,rg:()=>p,updateDeliveryRequest:()=>c,vd:()=>l,zW:()=>i});var s=a(51070);let l=async()=>s.B.get("/delivery/pickers"),r=async e=>s.x.post("/delivery/requests",e),i=async()=>s.x.get("/delivery/requests"),n=async e=>s.x.get("/delivery/requests/".concat(e)),o=async(e,t)=>s.x.put("/delivery/requests/".concat(e,"/status"),{status:t}),c=async(e,t)=>s.x.patch("/delivery/requests/".concat(e),t),d=async()=>s.x.get("/delivery/completed"),u=async()=>s.x.get("/delivery/cancelled"),h=async(e,t)=>s.x.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),p=async e=>s.x.post("/delivery/find-receiver",{email:e}),x=async()=>s.x.get("/delivery/incoming")},23833:(e,t,a)=>{Promise.resolve().then(a.bind(a,86856))},38464:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(31418),l=a(95155);let r=(0,s.A)((0,l.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},51070:(e,t,a)=>{"use strict";a.d(t,{B:()=>i,x:()=>r});var s=a(23464),l=a(14140);let r=s.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(async e=>{let t=l.j.currentUser;if(t){let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}return e},e=>Promise.reject(e));let i=s.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}})},51935:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(31418),l=a(95155);let r=(0,s.A)((0,l.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},72705:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var s=a(12115),l=a(52596),r=a(72890),i=a(90870),n=a(17472);let o=(0,a(11772).Ay)();var c=a(25560),d=a(5300),u=a(85799),h=a(648),p=a(83130),x=a(95155);let g=(0,u.A)(),f=o("div",{name:"MuiStack",slot:"Root"});function v(e){return(0,c.A)({props:e,name:"MuiStack",defaultTheme:g})}let b=e=>{let{ownerState:t,theme:a}=e,s={display:"flex",flexDirection:"column",...(0,h.NI)({theme:a},(0,h.kW)({values:t.direction,breakpoints:a.breakpoints.values}),e=>({flexDirection:e}))};if(t.spacing){let e=(0,p.LX)(a),l=Object.keys(a.breakpoints.values).reduce((e,a)=>(("object"==typeof t.spacing&&null!=t.spacing[a]||"object"==typeof t.direction&&null!=t.direction[a])&&(e[a]=!0),e),{}),i=(0,h.kW)({values:t.direction,base:l}),n=(0,h.kW)({values:t.spacing,base:l});"object"==typeof i&&Object.keys(i).forEach((e,t,a)=>{if(!i[e]){let s=t>0?i[a[t-1]]:"column";i[e]=s}}),s=(0,r.A)(s,(0,h.NI)({theme:a},n,(a,s)=>t.useFlexGap?{gap:(0,p._W)(e,a)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[s?i[s]:t.direction])]:(0,p._W)(e,a)}}))}return(0,h.iZ)(a.breakpoints,s)};var m=a(75955),y=a(10186);let j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{createStyledComponent:t=f,useThemeProps:a=v,componentName:r="MuiStack"}=e,o=t(b);return s.forwardRef(function(e,t){let c=a(e),{component:u="div",direction:h="column",spacing:p=0,divider:g,children:f,className:v,useFlexGap:b=!1,...m}=(0,d.A)(c),y=(0,n.A)({root:["root"]},e=>(0,i.Ay)(r,e),{});return(0,x.jsx)(o,{as:u,ownerState:{direction:h,spacing:p,useFlexGap:b},ref:t,className:(0,l.A)(y.root,v),...m,children:g?function(e,t){let a=s.Children.toArray(e).filter(Boolean);return a.reduce((e,l,r)=>(e.push(l),r<a.length-1&&e.push(s.cloneElement(t,{key:"separator-".concat(r)})),e),[])}(f,g):f})})}({createStyledComponent:(0,m.Ay)("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>(0,y.b)({props:e,name:"MuiStack"})})},86856:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(95155),l=a(12115),r=a(54581),i=a(14426),n=a(92302),o=a(3127),c=a(71116),d=a(72705),u=a(41218),h=a(16632),p=a(38464),x=a(51935),g=a(35695),f=a(43452),v=a(58343),b=a(97704),m=a(21787),y=a(6864);function j(e){let{params:t}=e,a=(0,l.use)(t),j=(0,g.useRouter)(),k=Number(a.id),[A,C]=(0,l.useState)(null),[W,S]=(0,l.useState)(!0),[w,I]=(0,l.useState)(!1),[B,M]=(0,l.useState)(""),[F,H]=(0,l.useState)(""),[R,z]=(0,l.useState)(""),[D,N]=(0,l.useState)(""),[P,T]=(0,l.useState)(""),[q,L]=(0,l.useState)(""),[E,_]=(0,l.useState)(0),[O,U]=(0,l.useState)("small"),[$,K]=(0,l.useState)(0),[X,Y]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{S(!0),M("");try{var e,t;let a=await (0,y.HW)();H(a.user.uid);let s=(await (0,m.IT)(k)).data;if(C(s),s.senderId!==a.user.uid)return void M("You are not authorized to edit this delivery");if("pending"!==s.status)return void M("You can only edit pending deliveries");z(s.title||""),N(s.description||""),T((null==(e=s.fromLocation)?void 0:e.address)||""),L((null==(t=s.toLocation)?void 0:t.address)||""),_(s.price||0),U(s.size||"small"),K(s.weight||0),Y(s.notes||"")}catch(e){console.error("Failed to fetch delivery:",e),M("Failed to load delivery. Please try again.")}finally{S(!1)}})()},[k]);let V=async()=>{if(A){I(!0),M("");try{await (0,m.updateDeliveryRequest)(k,{title:R,description:D,price:E,size:O,weight:$,notes:X}),alert("Delivery updated successfully!"),j.push("/orders/".concat(k))}catch(e){console.error("Failed to update delivery:",e),M("Failed to update delivery. Please try again.")}finally{I(!1)}}},G=()=>{j.push("/orders/".concat(k))};return W?(0,s.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,s.jsx)(i.default,{})}):B?(0,s.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,s.jsx)(r.default,{sx:{position:"relative",width:"100%",maxWidth:375},children:(0,s.jsx)(f.MobileContainer,{showFrame:!1,children:(0,s.jsxs)(r.default,{sx:{p:3},children:[(0,s.jsx)(n.A,{severity:"error",children:B}),(0,s.jsx)(v.$n,{fullWidth:!0,onClick:()=>j.push("/orders"),sx:{mt:2},children:"Back to Orders"})]})})})}):A?(0,s.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,s.jsxs)(r.default,{sx:{position:"relative",width:"100%",maxWidth:375,minHeight:812},children:[(0,s.jsx)(f.MobileContainer,{showFrame:!1,children:(0,s.jsxs)(r.default,{sx:{minHeight:"100vh",backgroundColor:"background.default",pb:10},children:[(0,s.jsxs)(r.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:1,borderColor:"divider",backgroundColor:"background.paper"},children:[(0,s.jsx)(o.A,{onClick:G,size:"small",children:(0,s.jsx)(p.A,{})}),(0,s.jsx)(c.default,{variant:"h6",sx:{fontWeight:600},children:"Edit Delivery"}),(0,s.jsx)(o.A,{onClick:V,disabled:w,size:"small",sx:{color:"primary.main"},children:(0,s.jsx)(x.A,{})})]}),(0,s.jsx)(r.default,{sx:{p:2},children:(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Basic Information"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(v.ks,{label:"Title",value:R,onChange:e=>z(e.target.value),placeholder:"Package title",fullWidth:!0}),(0,s.jsx)(v.ks,{label:"Description",value:D,onChange:e=>N(e.target.value),placeholder:"Describe your package",multiline:!0,rows:3,fullWidth:!0})]})]})}),(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Addresses"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(v.ks,{label:"Pickup Address",value:P,onChange:e=>T(e.target.value),placeholder:"From where?",fullWidth:!0}),(0,s.jsx)(v.ks,{label:"Delivery Address",value:q,onChange:e=>L(e.target.value),placeholder:"To where?",fullWidth:!0})]})]})}),(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Package Details"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(v.l6,{label:"Package Size",value:O,onChange:e=>U(e),options:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}],fullWidth:!0}),(0,s.jsx)(v.ks,{label:"Weight (kg)",type:"number",value:$.toString(),onChange:e=>K(Number(e.target.value)),placeholder:"0",fullWidth:!0}),(0,s.jsx)(v.ks,{label:"Price (zÅ‚)",type:"number",value:E.toString(),onChange:e=>_(Number(e.target.value)),placeholder:"0",fullWidth:!0}),(0,s.jsx)(v.ks,{label:"Notes",value:X,onChange:e=>Y(e.target.value),placeholder:"Additional notes",multiline:!0,rows:2,fullWidth:!0})]})]})}),(0,s.jsxs)(d.A,{direction:"row",spacing:2,sx:{pt:2},children:[(0,s.jsx)(v.$n,{variant:"outlined",fullWidth:!0,onClick:G,disabled:w,children:"Cancel"}),(0,s.jsx)(v.$n,{variant:"contained",fullWidth:!0,onClick:V,disabled:w,children:w?"Saving...":"Save Changes"})]})]})})]})}),(0,s.jsx)(b.default,{})]})}):null}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(95155),l=a(12115),r=a(35695),i=a(18407),n=a(40541),o=a(9111),c=a(26564),d=a(11335),u=a(21888),h=a(43290),p=a(60807);let x=e=>e>99?"99+":e,g=(0,l.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:g=0,userRole:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=(0,r.useRouter)(),b=(0,r.usePathname)(),[m,y]=(0,l.useState)(()=>localStorage.getItem("userRole"));(0,l.useEffect)(()=>{if(!f){let e=null;b.startsWith("/available-deliveries")?e="picker":b.startsWith("/delivery-methods")&&(e="sender"),e&&e!==m&&(y(e),localStorage.setItem("userRole",e))}},[b,f,m]);let j=f||m,k=(0,l.useMemo)(()=>b.startsWith("/delivery-methods")||b.startsWith("/orders")||b.startsWith("/available-deliveries")?0:b.startsWith("/chat")?1:b.startsWith("/notifications")?2:3*!!b.startsWith("/profile"),[b]),[A,C]=(0,l.useState)(k),W=(0,l.useCallback)((e,t)=>{switch(C(t),t){case 0:"picker"===j?v.push("/available-deliveries"):v.push("/delivery-methods");break;case 1:v.push("/chats");break;case 2:v.push("/notifications");break;case 3:v.push("/profile")}},[v,j]);return(0,s.jsx)(i.A,{className:e,sx:{position:"absolute",bottom:0,left:0,right:0,zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"none"},elevation:0,children:(0,s.jsxs)(n.A,{value:A,onChange:W,sx:{backgroundColor:"background.paper"},children:[(0,s.jsx)(o.A,{label:"Orders",icon:(0,s.jsx)(c.default,{badgeContent:x(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(d.default,{})})}),(0,s.jsx)(o.A,{label:"Chat",icon:(0,s.jsx)(c.default,{badgeContent:x(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(u.A,{})})}),(0,s.jsx)(o.A,{label:"Notifications",icon:(0,s.jsx)(c.default,{badgeContent:x(g),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(h.A,{})})}),(0,s.jsx)(o.A,{label:"Profile",icon:(0,s.jsx)(p.default,{})})]})})})}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,1101,8449,1190,9283,1986,7262,2649,7212,5394,8343,8441,5964,7358],()=>e(e.s=23833)),_N_E=e.O()}]);