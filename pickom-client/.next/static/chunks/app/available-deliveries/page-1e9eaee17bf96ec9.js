(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2445,6509],{6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>s,TK:()=>l,op:()=>o,wz:()=>r});var i=a(51070);let r=async e=>(await i.x.get("/user/".concat(e))).data,l=async(e,t)=>(await i.x.put("/user/".concat(e),t)).data,s=async()=>(await i.x.get("/auth/me")).data,n=async(e,t)=>(await i.x.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,o=async e=>(await i.x.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>s});var i=a(23915),r=a(45404);let l=(0,i.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),s=(0,r.xI)(l)},16509:(e,t,a)=>{"use strict";a.d(t,{TJ:()=>n,_z:()=>o,createChat:()=>r,iS:()=>d,m7:()=>s,ug:()=>l});var i=a(51070);let r=async e=>i.x.post("/chat/create",e),l=async()=>i.x.get("/chat"),s=async e=>i.x.get("/chat/delivery/".concat(e)),n=async e=>i.x.get("/chat/".concat(e)),o=async(e,t)=>i.x.post("/chat/".concat(e,"/messages"),t),d=async e=>i.x.patch("/chat/".concat(e,"/messages/mark-read"))},21717:(e,t,a)=>{"use strict";a.d(t,{n:()=>r});var i=a(51070);let r={getUserNotifications:async()=>(await i.x.get("/notifications")).data,getUnreadCount:async()=>(await i.x.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await i.x.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await i.x.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await i.x.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await i.x.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await i.x.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await i.x.post("/notifications/status-update",e)).data,createNotification:async e=>(await i.x.post("/notifications/create",e)).data}},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>n,S1:()=>u,TS:()=>f,XE:()=>o,confirmRecipient:()=>x,createDeliveryRequest:()=>l,qM:()=>c,rg:()=>h,updateDeliveryRequest:()=>d,vd:()=>r,zW:()=>s});var i=a(51070);let r=async()=>i.B.get("/delivery/pickers"),l=async e=>i.x.post("/delivery/requests",e),s=async()=>i.x.get("/delivery/requests"),n=async e=>i.x.get("/delivery/requests/".concat(e)),o=async(e,t)=>i.x.put("/delivery/requests/".concat(e,"/status"),{status:t}),d=async(e,t)=>i.x.patch("/delivery/requests/".concat(e),t),c=async()=>i.x.get("/delivery/completed"),u=async()=>i.x.get("/delivery/cancelled"),x=async(e,t)=>i.x.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),h=async e=>i.x.post("/delivery/find-receiver",{email:e}),f=async()=>i.x.get("/delivery/incoming")},27604:(e,t,a)=>{"use strict";a.d(t,{K:()=>s});var i=a(12115),r=a(21717),l=a(16509);function s(){let[e,t]=(0,i.useState)(0),[a,s]=(0,i.useState)(0),[n,o]=(0,i.useState)(0),[d,c]=(0,i.useState)(!0),u=(0,i.useCallback)(async()=>{try{let[e,a]=await Promise.all([(0,l.ug)().catch(()=>({data:[]})),r.n.getUnreadCount().catch(()=>0)]),i=e.data.reduce((e,t)=>e+(t.unreadCount||0),0);t(i),s(a),o(0)}catch(e){console.error("Failed to fetch navigation badge counts:",e)}finally{c(!1)}},[]);return(0,i.useEffect)(()=>{u()},[u]),(0,i.useEffect)(()=>{let e=setInterval(u,3e4);return()=>clearInterval(e)},[u]),(0,i.useEffect)(()=>{let e=()=>{u()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[u]),{unreadChats:e,unreadNotifications:a,activeOrders:n,isLoading:d,refresh:u}}},38815:(e,t,a)=>{Promise.resolve().then(a.bind(a,82838))},51070:(e,t,a)=>{"use strict";a.d(t,{B:()=>s,x:()=>l});var i=a(23464),r=a(14140);let l=i.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(async e=>{let t=r.j.currentUser;if(t){let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}return e},e=>Promise.reject(e));let s=i.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}})},82838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>et});var i=a(95155),r=a(12115),l=a(54581),s=a(71116),n=a(48158),o=a(93874),d=a(41101),c=a(95888),u=a(78449),x=a(68534),h=a(70541),f=a(18096),p=a(14426),y=a(92302),v=a(5716),g=a(3127),m=a(31747),b=a(11414),j=a(74637),C=a(12837),w=a(11335),k=a(26886),A=a(69242),S=a(35695),T=a(43452),W=a(97704),I=a(21787),D=a(6864),P=a(21717),z=a(41218),O=a(16632),E=a(74802),N=a(74588),R=a(58674),F=a(28890);function L(e){let{isOnline:t,price:a,rating:n,onToggleOnline:o,onViewCard:c,onEdit:u}=e,[h,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{f(!0)},[]);let p=!!h&&t;return(0,i.jsx)(z.A,{sx:{mb:2,backgroundColor:"background.paper",borderLeft:4,borderColor:"divider",transition:"all 0.3s ease"},children:(0,i.jsxs)(O.A,{sx:{py:2,"&:last-child":{pb:2}},children:[(0,i.jsx)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[p?(0,i.jsx)(E.default,{sx:{color:"success.main",fontSize:20}}):(0,i.jsx)(N.A,{sx:{color:"grey.500",fontSize:20}}),(0,i.jsx)(s.default,{variant:"subtitle2",fontWeight:600,children:"My Picker Card"}),(0,i.jsx)(d.A,{label:p?"Online":"Offline",size:"small",color:p?"success":"default",sx:{height:20,fontSize:"0.7rem"}})]})}),(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:2,mb:1.5},children:[(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",children:["Base price: ",(0,i.jsxs)("strong",{children:[a," zł"]})]}),(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",children:["Rating: ",(0,i.jsxs)("strong",{children:["⭐ ",n.toFixed(1)]})]})]}),(0,i.jsxs)(l.default,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[(0,i.jsx)(x.A,{variant:p?"outlined":"contained",color:"success",size:"small",onClick:o,sx:{flex:"1 1 auto",minHeight:44},children:p?"Go Offline":"Go Online"}),(0,i.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(R.A,{}),onClick:c,sx:{flex:"1 1 auto",minHeight:44},children:"View Card"}),(0,i.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(F.A,{}),onClick:u,sx:{flex:"0 1 auto",minHeight:44,minWidth:44,px:1},children:"Edit"})]})]})})}var M=a(72705),_=a(58343),B=a(66518);let H=()=>(0,i.jsx)(l.default,{sx:{width:40,height:4,backgroundColor:"action.disabled",borderRadius:2,position:"absolute",top:8,left:"calc(50% - 20px)"}});function q(e){let{open:t,onClose:a,onEdit:n,picker:o}=e,[d,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{c(document.querySelector("[data-mobile-container]"))},[]),(0,i.jsxs)(v.A,{anchor:"bottom",open:t,onClose:a,onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,container:d,ModalProps:{keepMounted:!1},PaperProps:{sx:{maxHeight:"90vh",maxWidth:"375px",margin:"0 auto",borderTopLeftRadius:16,borderTopRightRadius:16,backgroundColor:"background.paper"}},children:[(0,i.jsx)(H,{}),(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:1},children:[(0,i.jsx)(s.default,{variant:"h6",sx:{fontWeight:600},children:"My Picker Card Preview"}),(0,i.jsx)(g.A,{onClick:a,size:"small",children:(0,i.jsx)(A.A,{})})]}),(0,i.jsxs)(l.default,{sx:{px:3,pb:2,overflowY:"auto"},children:[(0,i.jsx)(l.default,{sx:B.de.base,children:(0,i.jsxs)(M.A,{direction:"row",spacing:2,alignItems:"flex-start",children:[(0,i.jsx)(_.H8,{type:"picker",name:o.fullName,src:o.avatarUrl,online:o.isOnline}),(0,i.jsxs)(l.default,{sx:{flex:1,minWidth:0},children:[(0,i.jsxs)(M.A,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[(0,i.jsx)(s.default,{variant:"subtitle2",sx:{fontWeight:"bold"},children:o.fullName}),o.isVerified&&(0,i.jsx)(_.wl,{type:"verified",verified:!0,size:"small",showLabel:!1})]}),(0,i.jsx)(_.Gk,{value:o.rating,readOnly:!0,size:"small",showValue:!0}),(0,i.jsx)(s.default,{variant:"body2",color:"text.secondary",sx:{mt:.5,mb:1},children:o.description}),(0,i.jsxs)(l.default,{sx:{display:"flex",gap:.5,mb:2,alignItems:"center"},children:[o.isPhoneVerified&&(0,i.jsx)(l.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(_.wl,{type:"phone",verified:!0,size:"small",showLabel:!1})}),o.isEmailVerified&&(0,i.jsx)(l.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(_.wl,{type:"email",verified:!0,size:"small",showLabel:!1})}),(0,i.jsx)(l.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(_.wl,{type:"delivery",verified:!0,value:o.deliveryCount,size:"small",showLabel:!1})})]}),(0,i.jsx)(M.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:(0,i.jsxs)(l.default,{children:[(0,i.jsxs)(s.default,{variant:"h6",sx:{fontWeight:"bold",color:B.w4.colors.primary},children:[o.price," zł"]}),(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",children:[o.duration," min"]})]})})]})]})}),(0,i.jsx)(s.default,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:2,textAlign:"center",fontStyle:"italic"},children:"This is how senders see your card"})]}),(0,i.jsxs)(l.default,{sx:{px:3,py:2,borderTop:1,borderColor:"divider",display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:a,variant:"outlined",fullWidth:!0,children:"Close"}),(0,i.jsx)(x.A,{onClick:n,variant:"contained",fullWidth:!0,children:"Edit Card"})]})]})}var U=a(27088),V=a(17348),Y=a(79892),J=a(77894);let K={price:50,vehicle:"car",workArea:"City Center",bio:"Fast and reliable delivery service",isOnline:!1},G=()=>{let e=localStorage.getItem("pickerCardSettings");return e?{...K,...JSON.parse(e)}:K},$=e=>{let t={...G(),...e};localStorage.setItem("pickerCardSettings",JSON.stringify(t))},X=()=>(0,i.jsx)(l.default,{sx:{width:40,height:4,backgroundColor:"action.disabled",borderRadius:2,position:"absolute",top:8,left:"calc(50% - 20px)"}});function Z(e){let{open:t,onClose:a,onSave:n,initialSettings:o}=e,[d,c]=(0,r.useState)(null),[h,f]=(0,r.useState)(o.price),[p,y]=(0,r.useState)(o.vehicle),[m,b]=(0,r.useState)(o.workArea),[j,C]=(0,r.useState)(o.bio),[w,k]=(0,r.useState)({});(0,r.useEffect)(()=>{c(document.querySelector("[data-mobile-container]"))},[]);let S=()=>{f(o.price),y(o.vehicle),b(o.workArea),C(o.bio),k({}),a()};return(0,i.jsxs)(v.A,{anchor:"bottom",open:t,onClose:S,onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,container:d,ModalProps:{keepMounted:!1},PaperProps:{sx:{maxHeight:"90vh",maxWidth:"375px",margin:"0 auto",borderTopLeftRadius:16,borderTopRightRadius:16,backgroundColor:"background.paper"}},children:[(0,i.jsx)(X,{}),(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:1},children:[(0,i.jsx)(s.default,{variant:"h6",sx:{fontWeight:600},children:"Edit Picker Card"}),(0,i.jsx)(g.A,{onClick:S,size:"small",children:(0,i.jsx)(A.A,{})})]}),(0,i.jsx)(l.default,{sx:{px:3,pb:2,overflowY:"auto"},children:(0,i.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:2.5,py:1},children:[(0,i.jsx)(u.default,{label:"Base Price (zł)",type:"number",value:h,onChange:e=>f(Number(e.target.value)),error:!!w.price,helperText:w.price||"Your base delivery price",fullWidth:!0,inputProps:{min:1,max:1e3}}),(0,i.jsxs)(U.A,{fullWidth:!0,children:[(0,i.jsx)(V.A,{children:"Vehicle Type"}),(0,i.jsxs)(Y.A,{value:p,label:"Vehicle Type",onChange:e=>y(e.target.value),children:[(0,i.jsx)(J.A,{value:"car",children:"\uD83D\uDE97 Car"}),(0,i.jsx)(J.A,{value:"bike",children:"\uD83D\uDEB4 Bike"}),(0,i.jsx)(J.A,{value:"scooter",children:"\uD83D\uDEF4 Scooter"}),(0,i.jsx)(J.A,{value:"walking",children:"\uD83D\uDEB6 Walking"})]})]}),(0,i.jsx)(u.default,{label:"Work Area/Zone",value:m,onChange:e=>b(e.target.value),fullWidth:!0,helperText:"E.g., City Center, Downtown, etc."}),(0,i.jsx)(u.default,{label:"Bio/Description",value:j,onChange:e=>C(e.target.value),multiline:!0,rows:4,fullWidth:!0,error:!!w.bio,helperText:w.bio||"".concat(j.length,"/200 characters"),inputProps:{maxLength:200}})]})}),(0,i.jsxs)(l.default,{sx:{px:3,py:2,borderTop:1,borderColor:"divider",display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:S,variant:"outlined",fullWidth:!0,children:"Cancel"}),(0,i.jsx)(x.A,{onClick:()=>{if(!(()=>{let e={};return(h<=0||h>1e3)&&(e.price="Price must be between 1 and 1000 zł"),j.length>200&&(e.bio="Bio must be 200 characters or less"),k(e),0===Object.keys(e).length})())return;let e={price:h,vehicle:p,workArea:m,bio:j,isOnline:o.isOnline};$(e),n(e),a()},variant:"contained",fullWidth:!0,children:"Save Changes"})]})]})}var Q=a(27604),ee=a(98226);function et(){var e,t;let z=(0,S.useRouter)(),{unreadChats:O,unreadNotifications:E}=(0,Q.K)(),[N,R]=(0,r.useState)([]),[F,M]=(0,r.useState)(!0),[_,B]=(0,r.useState)(""),[H,U]=(0,r.useState)("available"),[V,Y]=(0,r.useState)(""),[J,K]=(0,r.useState)([]),[X,et]=(0,r.useState)(!1),[ea,ei]=(0,r.useState)(()=>{{let e=localStorage.getItem("pickerPlannedTrips");return e?JSON.parse(e):[]}}),[er,el]=(0,r.useState)({fromCity:"",toCity:"",departureDateTime:"",arrivalDateTime:""}),[es,en]=(0,r.useState)(()=>G()),[eo,ed]=(0,r.useState)(!1),[ec,eu]=(0,r.useState)(!1),[ex,eh]=(0,r.useState)(!1),[ef,ep]=(0,r.useState)(null),[ey,ev]=(0,r.useState)(0),[eg,em]=(0,r.useState)(""),[eb,ej]=(0,r.useState)(!1),eC={id:"current-user",fullName:"John Doe",email:"john@example.com",avatarUrl:"",rating:4.7,isVerified:!0,isOnline:es.isOnline,isPhoneVerified:!0,isEmailVerified:!0,price:es.price,duration:30,trustLevel:85,reviewCount:42,distance:0,vehicle:es.vehicle,completedDeliveries:127,deliveryCount:127,description:es.bio,age:19,country:"Poland",city:"Warsaw",userType:ee.u.PICKER};(0,r.useEffect)(()=>{(async()=>{try{let{user:e}=await (0,D.HW)();Y(e.uid);let t=es.isOnline;e.isOnline!==t&&(console.log("Syncing online status: local=".concat(t,", backend=").concat(e.isOnline)),await (0,D.$H)(e.uid,t))}catch(e){console.error("Failed to load current user:",e)}})()},[]),(0,r.useEffect)(()=>{(async()=>{M(!0),B("");try{let e=await (0,I.zW)();R(e.data)}catch(e){console.error("Failed to fetch deliveries:",e),B("Failed to load delivery requests. Please try again.")}finally{M(!1)}})()},[]),(0,r.useEffect)(()=>{"invitations"===H&&ew()},[H]);let ew=async()=>{et(!0);try{let e=await P.n.getUserNotifications();console.log("All notifications:",e);let t=e.filter(e=>"new_delivery"===e.type&&e.related_delivery_id);console.log("Invitation notifications:",t);let a=(await Promise.all(t.map(async e=>{try{console.log("Fetching delivery:",e.related_delivery_id);let t=await (0,I.IT)(e.related_delivery_id);return console.log("Delivery data:",t.data),t.data}catch(t){return console.error("Failed to fetch delivery:",e.related_delivery_id,t),null}}))).filter(e=>null!==e&&"pending"===e.status);console.log("Filtered invitations:",a),K(a)}catch(e){console.error("Failed to load invitations:",e)}finally{et(!1)}},ek=(0,r.useMemo)(()=>N.filter(e=>"pending"===e.status),[N]),eA=(0,r.useMemo)(()=>N.filter(e=>"accepted"===e.status||"picked_up"===e.status),[N]),eS=(0,r.useMemo)(()=>N.filter(e=>"delivered"===e.status||"cancelled"===e.status),[N]),eT=(0,r.useMemo)(()=>{switch(H){case"available":default:return ek;case"active":return eA;case"history":return eS;case"invitations":return J}},[H,ek,eA,eS,J]),eW=async()=>{if(!ef||ey<=0)return void alert("Please enter a valid price");ej(!0);try{let{createOffer:e}=await a.e(8780).then(a.bind(a,78780));await e({deliveryId:ef.id,price:ey,message:eg||void 0}),alert("Offer submitted successfully!"),eh(!1),ep(null)}catch(a){var e,t;console.error("Failed to create offer:",a),alert((null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to create offer. Please try again.")}finally{ej(!1)}},eI=async()=>{let e=(()=>{let e=!G().isOnline;return $({isOnline:e}),e})();if(en(G()),V)try{await (0,D.$H)(V,e),console.log("Online status synced with backend:",e)}catch(e){console.error("Failed to sync online status with backend:",e)}},eD=e=>t=>{el(a=>({...a,[e]:t.target.value}))};return(0,i.jsx)(l.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,i.jsxs)(l.default,{sx:{position:"relative",width:"100%",maxWidth:375,height:812},children:[(0,i.jsx)(T.MobileContainer,{showFrame:!1,children:(0,i.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,i.jsx)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:1,borderColor:"divider"},children:(0,i.jsx)(s.default,{variant:"h5",sx:{fontWeight:600,fontSize:"1.5rem"},children:"Delivery Requests"})}),(0,i.jsx)(l.default,{sx:{px:2,pt:2},children:(0,i.jsx)(L,{isOnline:es.isOnline,price:es.price,rating:eC.rating,onToggleOnline:eI,onViewCard:()=>{ed(!0)},onEdit:()=>{eu(!0)}})}),(0,i.jsxs)(n.A,{sx:{boxShadow:"none",borderBottom:1,borderColor:"divider"},children:[(0,i.jsx)(o.A,{expandIcon:(0,i.jsx)(m.A,{}),sx:{backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)(b.A,{color:"primary"}),(0,i.jsx)(s.default,{variant:"subtitle1",sx:{fontWeight:600},children:"Plan a Trip"}),ea.length>0&&(0,i.jsx)(d.A,{label:ea.length,size:"small",color:"primary",sx:{height:20,fontSize:"0.75rem"}})]})}),(0,i.jsx)(c.A,{sx:{p:2},children:(0,i.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsx)(u.default,{label:"From City",value:er.fromCity,onChange:eD("fromCity"),size:"small",fullWidth:!0}),(0,i.jsx)(u.default,{label:"To City",value:er.toCity,onChange:eD("toCity"),size:"small",fullWidth:!0}),(0,i.jsx)(u.default,{label:"Departure Date & Time",type:"datetime-local",value:er.departureDateTime,onChange:eD("departureDateTime"),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0}}),(0,i.jsx)(u.default,{label:"Arrival Date & Time",type:"datetime-local",value:er.arrivalDateTime,onChange:eD("arrivalDateTime"),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0}}),(0,i.jsx)(x.A,{variant:"contained",startIcon:(0,i.jsx)(j.A,{}),onClick:()=>{if(!er.fromCity||!er.toCity||!er.departureDateTime||!er.arrivalDateTime)return;let e=[...ea,{id:Date.now().toString(),fromCity:er.fromCity,toCity:er.toCity,departureDateTime:er.departureDateTime,arrivalDateTime:er.arrivalDateTime,createdAt:new Date().toISOString()}];ei(e),localStorage.setItem("pickerPlannedTrips",JSON.stringify(e)),el({fromCity:"",toCity:"",departureDateTime:"",arrivalDateTime:""})},disabled:!er.fromCity||!er.toCity||!er.departureDateTime||!er.arrivalDateTime,sx:{textTransform:"none"},children:"Add Trip"}),ea.length>0&&(0,i.jsxs)(l.default,{sx:{mt:2},children:[(0,i.jsxs)(s.default,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:["Planned Trips (",ea.length,")"]}),ea.map(e=>(0,i.jsx)(l.default,{sx:{p:1.5,mb:1,borderRadius:1,backgroundColor:"background.default",border:1,borderColor:"divider"},children:(0,i.jsxs)(l.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)(l.default,{sx:{flex:1},children:[(0,i.jsxs)(s.default,{variant:"body2",sx:{fontWeight:600},children:[e.fromCity," → ",e.toCity]}),(0,i.jsxs)(s.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Depart: ",new Date(e.departureDateTime).toLocaleString("en-US")]}),(0,i.jsxs)(s.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Arrive: ",new Date(e.arrivalDateTime).toLocaleString("en-US")]})]}),(0,i.jsx)(x.A,{size:"small",color:"error",onClick:()=>(e=>{let t=ea.filter(t=>t.id!==e);ei(t),localStorage.setItem("pickerPlannedTrips",JSON.stringify(t))})(e.id),sx:{textTransform:"none",minWidth:"auto"},children:"Delete"})]})},e.id))]})]})})]}),(0,i.jsxs)(h.A,{value:H,onChange:(e,t)=>{U(t)},variant:"scrollable",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider",minHeight:48,"& .MuiTabs-flexContainer":{pl:0},"& .MuiTabs-scroller":{ml:0},"& .MuiTab-root":{minHeight:48,fontSize:"0.75rem",fontWeight:500,textTransform:"none",minWidth:80,pl:2,pr:2,"&:first-of-type":{pl:0}}},children:[(0,i.jsx)(f.A,{label:"Available (".concat(ek.length,")"),value:"available"}),(0,i.jsx)(f.A,{label:(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,i.jsx)(C.A,{sx:{fontSize:16}}),"Invitations (",J.length,")"]}),value:"invitations"}),(0,i.jsx)(f.A,{label:"Active (".concat(eA.length,")"),value:"active"}),(0,i.jsx)(f.A,{label:"History (".concat(eS.length,")"),value:"history"})]}),(0,i.jsx)(l.default,{sx:{flex:1,overflow:"auto",pb:8},children:F||"invitations"===H&&X?(0,i.jsx)(l.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:8},children:(0,i.jsx)(p.default,{})}):_?(0,i.jsx)(l.default,{sx:{p:3},children:(0,i.jsx)(y.A,{severity:"error",children:_})}):0===eT.length?(0,i.jsxs)(l.default,{sx:{p:3,textAlign:"center",py:8},children:["invitations"===H?(0,i.jsx)(C.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}):(0,i.jsx)(w.default,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,i.jsxs)(s.default,{variant:"h6",sx:{mb:1,fontWeight:600},children:["available"===H&&"No available deliveries","active"===H&&"No active deliveries","history"===H&&"No delivery history","invitations"===H&&"No invitations"]}),(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",children:["available"===H&&"Check back later for new delivery requests","active"===H&&"Accepted deliveries will appear here","history"===H&&"Your completed and cancelled deliveries will appear here","invitations"===H&&"Senders will invite you to deliver their packages"]})]}):(0,i.jsx)(l.default,{sx:{p:2},children:eT.map(e=>{var t,a;return(0,i.jsxs)(l.default,{onClick:()=>{var t;return t=e.id,void z.push("/delivery-details/".concat(t))},sx:{p:2,mb:2,borderRadius:2,backgroundColor:"background.paper",border:1,borderColor:"divider",cursor:"pointer",transition:"all 0.2s","&:hover":{boxShadow:2,borderColor:"primary.main"}},children:[(0,i.jsxs)(l.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,i.jsxs)(s.default,{variant:"subtitle2",sx:{fontWeight:600},children:["Delivery #",e.id]}),e.deliveryType&&(0,i.jsx)(d.A,{label:"within-city"===e.deliveryType?"Within City":"Inter-City",size:"small",color:"within-city"===e.deliveryType?"primary":"warning",icon:"within-city"===e.deliveryType?(0,i.jsx)(k.A,{sx:{fontSize:14}}):(0,i.jsx)(b.A,{sx:{fontSize:14}}),sx:{height:20,fontSize:"0.7rem"}})]}),(0,i.jsx)(d.A,{label:(e=>{switch(e){case"pending":return"Pending";case"accepted":return"Accepted";case"picked_up":return"In Transit";case"delivered":return"Delivered";case"cancelled":return"Cancelled";default:return e}})(e.status),size:"small",color:(e=>{switch(e){case"pending":return"warning";case"accepted":return"info";case"picked_up":return"primary";case"delivered":return"success";case"cancelled":return"error";default:return"default"}})(e.status),sx:{height:20,fontSize:"0.75rem"}})]}),(0,i.jsxs)(l.default,{sx:{mb:1},children:[(0,i.jsx)(s.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:"From"}),(0,i.jsx)(s.default,{variant:"body2",sx:{fontWeight:500},children:null==(t=e.fromLocation)?void 0:t.address})]}),(0,i.jsxs)(l.default,{sx:{mb:1},children:[(0,i.jsx)(s.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:"To"}),(0,i.jsx)(s.default,{variant:"body2",sx:{fontWeight:500},children:null==(a=e.toLocation)?void 0:a.address})]}),(0,i.jsxs)(l.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[(0,i.jsxs)(s.default,{variant:"h6",sx:{color:"primary.main",fontWeight:"bold"},children:[Number(e.price||0).toFixed(2)," zl"]}),(0,i.jsx)(s.default,{variant:"caption",color:"text.secondary",children:new Date(e.createdAt).toLocaleDateString("en-US")})]}),"available"===H&&(0,i.jsx)(x.A,{variant:"contained",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),ep(e),ev(Number(e.price)||0),em(""),eh(!0)},children:"Make Offer"}),"invitations"===H&&(0,i.jsx)(x.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Invitation"}),"active"===H&&(0,i.jsx)(x.A,{variant:"contained",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Details"}),"history"===H&&(0,i.jsx)(x.A,{variant:"outlined",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Details"})]},e.id)})})})]})}),(0,i.jsx)(W.default,{unreadChatsCount:O,unreadNotificationsCount:E}),(0,i.jsx)(q,{open:eo,onClose:()=>ed(!1),onEdit:()=>{ed(!1),eu(!0)},picker:eC}),(0,i.jsx)(Z,{open:ec,onClose:()=>eu(!1),onSave:e=>{en(e),eu(!1)},initialSettings:es}),(0,i.jsxs)(v.A,{anchor:"bottom",open:ex,onClose:()=>!eb&&eh(!1),onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,PaperProps:{sx:{maxHeight:"90vh",maxWidth:"375px",margin:"0 auto",borderTopLeftRadius:16,borderTopRightRadius:16,backgroundColor:"background.paper"}},children:[(0,i.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:2},children:[(0,i.jsx)(s.default,{variant:"h6",sx:{fontWeight:600},children:"Make an Offer"}),(0,i.jsx)(g.A,{onClick:()=>eh(!1),size:"small",disabled:eb,children:(0,i.jsx)(A.A,{})})]}),(0,i.jsx)(l.default,{sx:{px:3,pb:3},children:ef&&(0,i.jsxs)(l.default,{children:[(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["From: ",null==(e=ef.toLocation)?void 0:e.address]}),(0,i.jsxs)(s.default,{variant:"body2",color:"text.secondary",sx:{mb:3},children:["To: ",null==(t=ef.toLocation)?void 0:t.address]}),(0,i.jsx)(u.default,{label:"Your Price (zł)",type:"number",fullWidth:!0,value:ey,onChange:e=>ev(Number(e.target.value)),sx:{mb:2},inputProps:{min:0,step:.01},disabled:eb}),(0,i.jsx)(u.default,{label:"Message (optional)",multiline:!0,rows:3,fullWidth:!0,value:eg,onChange:e=>em(e.target.value),placeholder:"Add a message to the sender...",disabled:eb,sx:{mb:3}}),(0,i.jsxs)(l.default,{sx:{display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:()=>eh(!1),disabled:eb,variant:"outlined",fullWidth:!0,children:"Cancel"}),(0,i.jsx)(x.A,{onClick:eW,variant:"contained",disabled:eb||ey<=0,fullWidth:!0,children:eb?"Submitting...":"Submit Offer"})]})]})})]})]})})}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var i=a(95155),r=a(12115),l=a(35695),s=a(18407),n=a(40541),o=a(9111),d=a(26564),c=a(11335),u=a(21888),x=a(43290),h=a(60807);let f=e=>e>99?"99+":e,p=(0,r.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:p=0,userRole:y}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=(0,l.useRouter)(),g=(0,l.usePathname)(),[m,b]=(0,r.useState)(()=>localStorage.getItem("userRole"));(0,r.useEffect)(()=>{if(!y){let e=null;g.startsWith("/available-deliveries")?e="picker":g.startsWith("/delivery-methods")&&(e="sender"),e&&e!==m&&(b(e),localStorage.setItem("userRole",e))}},[g,y,m]);let j=y||m,C=(0,r.useMemo)(()=>g.startsWith("/delivery-methods")||g.startsWith("/orders")||g.startsWith("/available-deliveries")?0:g.startsWith("/chat")?1:g.startsWith("/notifications")?2:3*!!g.startsWith("/profile"),[g]),[w,k]=(0,r.useState)(C),A=(0,r.useCallback)((e,t)=>{switch(k(t),t){case 0:"picker"===j?v.push("/available-deliveries"):v.push("/delivery-methods");break;case 1:v.push("/chats");break;case 2:v.push("/notifications");break;case 3:v.push("/profile")}},[v,j]);return(0,i.jsx)(s.A,{className:e,sx:{position:"absolute",bottom:0,left:0,right:0,zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"none"},elevation:0,children:(0,i.jsxs)(n.A,{value:w,onChange:A,sx:{backgroundColor:"background.paper"},children:[(0,i.jsx)(o.A,{label:"Orders",icon:(0,i.jsx)(d.default,{badgeContent:f(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(c.default,{})})}),(0,i.jsx)(o.A,{label:"Chat",icon:(0,i.jsx)(d.default,{badgeContent:f(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(u.A,{})})}),(0,i.jsx)(o.A,{label:"Notifications",icon:(0,i.jsx)(d.default,{badgeContent:f(p),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(x.A,{})})}),(0,i.jsx)(o.A,{label:"Profile",icon:(0,i.jsx)(h.default,{})})]})})})},98226:(e,t,a)=>{"use strict";a.d(t,{u:()=>i,y:()=>r});var i=function(e){return e.SENDER="sender",e.PICKER="picker",e}({}),r=function(e){return e.WITHIN_CITY="within_city",e.INTER_CITY="inter_city",e.INTERNATIONAL="international",e.COMBINED="combined",e}({})}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,1101,8449,1190,9283,1986,7262,2649,7212,5394,1274,9146,8343,8441,5964,7358],()=>e(e.s=38815)),_N_E=e.O()}]);