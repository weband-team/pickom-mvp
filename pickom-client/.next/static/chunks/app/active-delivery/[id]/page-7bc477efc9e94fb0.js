(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2790],{375:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>M});var r=a(95155),i=a(12115),l=a(54581),n=a(14426),s=a(92302),o=a(3127),d=a(71116),c=a(41101),u=a(41218),h=a(16632),f=a(74964),x=a(68534),p=a(36114),m=a(54492),g=a(99927),v=a(76871),b=a(71977),j=a(38464),y=a(52836),k=a(11335),w=a(63645),A=a(21888),C=a(74802),S=a(35695),W=a(43452),I=a(97704),D=a(54670),T=a(21787),_=a(6864);function M(e){let{params:t}=e,a=(0,i.use)(t),M=(0,S.useRouter)(),P=Number(a.id),[R,z]=(0,i.useState)(null),[H,N]=(0,i.useState)(null),[E,F]=(0,i.useState)(!0),[U,B]=(0,i.useState)(""),[O,V]=(0,i.useState)({open:!1,newStatus:null}),[X,L]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{F(!0),B("");try{let e=(await (0,T.IT)(P)).data;z(e);let t=(await (0,_.wz)(e.senderId)).user,a={uid:t.uid,fullName:t.name,avatarUrl:t.avatarUrl,rating:4.8,totalOrders:45,isPhoneVerified:!!t.phone,isEmailVerified:!0,memberSince:t.createdAt,phone:t.phone,email:t.email};N(a)}catch(e){console.error("Failed to fetch delivery:",e),B("Failed to load delivery details. Please try again.")}finally{F(!1)}})()},[P]);let G=e=>{V({open:!0,newStatus:e})},Y=async()=>{if(O.newStatus){L(!0);try{await (0,T.XE)(P,O.newStatus),z(e=>e?{...e,status:O.newStatus}:null),alert({picked_up:"Delivery marked as picked up! The sender has been notified.",delivered:"Delivery marked as delivered! Great job!"}[O.newStatus]),"delivered"===O.newStatus&&M.push("/available-deliveries")}catch(e){console.error("Failed to update status:",e),alert("Failed to update status. Please try again.")}finally{L(!1),V({open:!1,newStatus:null})}}},Z=()=>{V({open:!1,newStatus:null})};if(E)return(0,r.jsx)(l.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(n.default,{})});if(U||!R||!H)return(0,r.jsx)(l.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,r.jsx)(s.A,{severity:"error",sx:{maxWidth:375},children:U||"Delivery not found"})});let q="accepted"===R.status,J="picked_up"===R.status;return(0,r.jsx)(l.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,r.jsxs)(l.default,{sx:{position:"relative",width:"100%",maxWidth:375,height:812},children:[(0,r.jsx)(W.MobileContainer,{showFrame:!1,children:(0,r.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,r.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:1,p:2,borderBottom:1,borderColor:"divider"},children:[(0,r.jsx)(o.A,{onClick:()=>{M.push("/available-deliveries")},size:"small",children:(0,r.jsx)(j.A,{})}),(0,r.jsxs)(d.default,{variant:"h6",sx:{fontWeight:600,flex:1},children:["Active Delivery #",R.id]}),(0,r.jsx)(c.A,{label:(e=>{switch(e){case"accepted":return"Accepted";case"picked_up":return"Picked Up";case"delivered":return"Delivered";default:return e}})(R.status),size:"small",color:(e=>{switch(e){case"accepted":return"info";case"picked_up":return"primary";case"delivered":return"success";default:return"default"}})(R.status),sx:{fontWeight:600}})]}),(0,r.jsxs)(l.default,{sx:{flex:1,overflow:"auto",pb:20},children:[(0,r.jsx)(u.A,{sx:{m:2,boxShadow:1},children:(0,r.jsxs)(h.A,{children:[(0,r.jsx)(d.default,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Route Details"}),(0,r.jsxs)(l.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(y.A,{sx:{color:"success.main",mt:.5}}),(0,r.jsxs)(l.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Pickup"}),(0,r.jsx)(d.default,{variant:"body2",sx:{fontWeight:500},children:R.fromAddress})]})]}),(0,r.jsxs)(l.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(y.A,{sx:{color:"error.main",mt:.5}}),(0,r.jsxs)(l.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Dropoff"}),(0,r.jsx)(d.default,{variant:"body2",sx:{fontWeight:500},children:R.toAddress})]})]}),(0,r.jsxs)(l.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(k.default,{sx:{color:"text.secondary",mt:.5}}),(0,r.jsxs)(l.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Package"}),(0,r.jsxs)(d.default,{variant:"body2",sx:{fontWeight:500},children:[R.size.charAt(0).toUpperCase()+R.size.slice(1)," parcel",R.weight&&" â€¢ ".concat(R.weight," kg")]})]})]}),R.notes&&(0,r.jsxs)(l.default,{sx:{mt:2,p:1.5,borderRadius:1,backgroundColor:"action.hover"},children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Notes"}),(0,r.jsx)(d.default,{variant:"body2",children:R.notes})]}),(0,r.jsx)(f.A,{sx:{my:2}}),(0,r.jsxs)(l.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(w.A,{sx:{fontSize:20,color:"primary.main"}}),(0,r.jsxs)(d.default,{variant:"h6",sx:{color:"primary.main",fontWeight:"bold"},children:[R.price," zÅ‚"]})]})]})}),(0,r.jsxs)(l.default,{sx:{mx:2,mb:2},children:[(0,r.jsx)(d.default,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Sender Information"}),(0,r.jsx)(D.A,{sender:H,variant:"full",showContact:!0})]})]}),(0,r.jsx)(l.default,{sx:{position:"absolute",bottom:0,left:0,right:0,p:2,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",boxShadow:3,pb:10},children:(0,r.jsxs)(l.default,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[(0,r.jsx)(x.A,{variant:"outlined",startIcon:(0,r.jsx)(A.A,{}),onClick:()=>{console.log("Chat with sender"),alert("Chat functionality coming soon!")},fullWidth:!0,sx:{minHeight:48,textTransform:"none"},children:"Chat with Sender"}),q&&(0,r.jsx)(x.A,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(C.default,{}),onClick:()=>G("picked_up"),fullWidth:!0,sx:{minHeight:48,textTransform:"none",fontWeight:600},children:"Mark as Picked Up"}),J&&(0,r.jsx)(x.A,{variant:"contained",color:"success",startIcon:(0,r.jsx)(C.default,{}),onClick:()=>G("delivered"),fullWidth:!0,sx:{minHeight:48,textTransform:"none",fontWeight:600},children:"Mark as Delivered"})]})})]})}),(0,r.jsx)(I.default,{}),(0,r.jsxs)(p.A,{open:O.open,onClose:Z,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(m.A,{children:"picked_up"===O.newStatus?"Confirm Pickup":"Confirm Delivery"}),(0,r.jsx)(g.A,{children:(0,r.jsx)(v.A,{children:"picked_up"===O.newStatus?(0,r.jsxs)(r.Fragment,{children:["You are about to mark this delivery as ",(0,r.jsx)("strong",{children:"picked up"}),". The sender will be notified that you have collected the package."]}):(0,r.jsxs)(r.Fragment,{children:["You are about to mark this delivery as ",(0,r.jsx)("strong",{children:"delivered"}),". The sender will be notified that the package has been delivered successfully. This will complete the delivery."]})})}),(0,r.jsxs)(b.A,{sx:{px:3,py:2},children:[(0,r.jsx)(x.A,{onClick:Z,variant:"outlined",disabled:X,children:"Cancel"}),(0,r.jsx)(x.A,{onClick:Y,variant:"contained",color:"picked_up"===O.newStatus?"primary":"success",disabled:X,children:X?"Updating...":"Confirm"})]})]})]})})}},2582:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var r=a(31418),i=a(95155);let l=(0,r.A)((0,i.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email")},26290:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var r=a(31418),i=a(95155);let l=(0,r.A)((0,i.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone")},43452:(e,t,a)=>{"use strict";a.d(t,{MobileContainer:()=>s});var r=a(95155);a(12115);var i=a(54581),l=a(18407),n=a(35695);let s=e=>{let{children:t,width:a=375,height:s=812,showFrame:o=!0,backgroundColor:d,showBottomNav:c=!0}=e,u=(0,n.usePathname)(),h=(null==u?void 0:u.includes("/login"))||(null==u?void 0:u.includes("/register")),f=c&&!h;return o?(0,r.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:3,backgroundColor:"#f5f5f5"},children:(0,r.jsx)(l.A,{elevation:3,sx:{width:a,height:f?"calc(".concat(s,"px - 70px)"):s,borderRadius:6,overflow:"hidden",position:"relative",bgcolor:d||"background.default",border:"8px solid #000000","&::before":{content:'""',position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",width:134,height:6,backgroundColor:"#000000",borderRadius:3,zIndex:1},"&::after":{content:'""',position:"absolute",bottom:8,left:"50%",transform:"translateX(-50%)",width:134,height:5,backgroundColor:"#000000",borderRadius:2.5,zIndex:1}},children:(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100%",height:"100%",paddingTop:6,overflow:"auto",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{paddingBottom:4,minHeight:"100%"},children:t})})})}):(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100%",maxWidth:a,height:f?"calc(100vh - 70px)":"100vh",maxHeight:f?"calc(".concat(s,"px - 70px)"):s,bgcolor:d||"background.default",overflow:"hidden",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{paddingBottom:0,minHeight:"100%",overflow:"auto",height:"100%"},children:t})})}},51155:(e,t,a)=>{Promise.resolve().then(a.bind(a,375))},72705:(e,t,a)=>{"use strict";a.d(t,{A:()=>y});var r=a(12115),i=a(52596),l=a(72890),n=a(90870),s=a(17472);let o=(0,a(11772).Ay)();var d=a(25560),c=a(5300),u=a(85799),h=a(648),f=a(83130),x=a(95155);let p=(0,u.A)(),m=o("div",{name:"MuiStack",slot:"Root"});function g(e){return(0,d.A)({props:e,name:"MuiStack",defaultTheme:p})}let v=e=>{let{ownerState:t,theme:a}=e,r={display:"flex",flexDirection:"column",...(0,h.NI)({theme:a},(0,h.kW)({values:t.direction,breakpoints:a.breakpoints.values}),e=>({flexDirection:e}))};if(t.spacing){let e=(0,f.LX)(a),i=Object.keys(a.breakpoints.values).reduce((e,a)=>(("object"==typeof t.spacing&&null!=t.spacing[a]||"object"==typeof t.direction&&null!=t.direction[a])&&(e[a]=!0),e),{}),n=(0,h.kW)({values:t.direction,base:i}),s=(0,h.kW)({values:t.spacing,base:i});"object"==typeof n&&Object.keys(n).forEach((e,t,a)=>{if(!n[e]){let r=t>0?n[a[t-1]]:"column";n[e]=r}}),r=(0,l.A)(r,(0,h.NI)({theme:a},s,(a,r)=>t.useFlexGap?{gap:(0,f._W)(e,a)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[r?n[r]:t.direction])]:(0,f._W)(e,a)}}))}return(0,h.iZ)(a.breakpoints,r)};var b=a(75955),j=a(10186);let y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{createStyledComponent:t=m,useThemeProps:a=g,componentName:l="MuiStack"}=e,o=t(v);return r.forwardRef(function(e,t){let d=a(e),{component:u="div",direction:h="column",spacing:f=0,divider:p,children:m,className:g,useFlexGap:v=!1,...b}=(0,c.A)(d),j=(0,s.A)({root:["root"]},e=>(0,n.Ay)(l,e),{});return(0,x.jsx)(o,{as:u,ownerState:{direction:h,spacing:f,useFlexGap:v},ref:t,className:(0,i.A)(j.root,g),...b,children:p?function(e,t){let a=r.Children.toArray(e).filter(Boolean);return a.reduce((e,i,l)=>(e.push(i),l<a.length-1&&e.push(r.cloneElement(t,{key:"separator-".concat(l)})),e),[])}(m,p):m})})}({createStyledComponent:(0,b.Ay)("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>(0,j.b)({props:e,name:"MuiStack"})})},76871:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var r=a(12115),i=a(52596),l=a(17472),n=a(36437),s=a(75955),o=a(10186),d=a(71116),c=a(55170),u=a(90870);function h(e){return(0,u.Ay)("MuiDialogContentText",e)}(0,c.A)("MuiDialogContentText",["root"]);var f=a(95155);let x=(0,s.Ay)(d.default,{shouldForwardProp:e=>(0,n.A)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root"})({}),p=r.forwardRef(function(e,t){let a=(0,o.b)({props:e,name:"MuiDialogContentText"}),{children:r,className:n,...s}=a,d=(e=>{let{classes:t}=e,a=(0,l.A)({root:["root"]},h,t);return{...t,...a}})(s);return(0,f.jsx)(x,{component:"p",variant:"body1",color:"textSecondary",ref:t,ownerState:s,className:(0,i.A)(d.root,n),...a,classes:d})})}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,1101,9283,5394,6233,8441,5964,7358],()=>e(e.s=51155)),_N_E=e.O()}]);