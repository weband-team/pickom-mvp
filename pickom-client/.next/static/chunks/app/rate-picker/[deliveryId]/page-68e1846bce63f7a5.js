(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5048],{20517:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var l=i(95155),a=i(12115),r=i(54581),n=i(14426),s=i(92302),d=i(3127),o=i(71116),u=i(41218),c=i(16632),h=i(42663),x=i(1154),f=i(78449),m=i(68534),g=i(38464),v=i(68558),b=i(7304),y=i(35695),p=i(43452),j=i(97704),k=i(21787),C=i(6864),S=i(18986);function w(e){var t;let{params:i}=e,w=(0,a.use)(i),I=(0,y.useRouter)(),[A,z]=(0,a.useState)(null),[W,F]=(0,a.useState)(!0),[N,R]=(0,a.useState)(""),[_,E]=(0,a.useState)(!1),[H,P]=(0,a.useState)(5),[M,O]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{F(!0),R("");try{let e=(await (0,k.IT)(Number(w.deliveryId))).data;if(!e.pickerId)return void R("No picker assigned to this delivery");let t=await (0,C.wz)(e.pickerId);z(t.user)}catch(e){console.error("Failed to fetch picker:",e),R("Failed to load picker information")}finally{F(!1)}})()},[w.deliveryId]);let U=async()=>{if(A&&0!==H){E(!0);try{await (0,S.GS)({deliveryId:Number(w.deliveryId),toUserId:A.uid,rating:H,comment:M||void 0}),alert("Rating submitted successfully!"),I.push("/delivery-methods?tab=manage")}catch(i){var e,t;console.error("Failed to submit rating:",i),(null==(t=i.response)||null==(e=t.data)?void 0:e.message)?alert(i.response.data.message):alert("Failed to submit rating. Please try again.")}finally{E(!1)}}};return W?(0,l.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default"},children:(0,l.jsx)(n.default,{})}):N?(0,l.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default",p:2},children:(0,l.jsx)(s.A,{severity:"error",sx:{maxWidth:375},children:N})}):(0,l.jsx)(r.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default",p:2},children:(0,l.jsxs)(r.default,{sx:{position:"relative",width:"100%",maxWidth:375,height:812},children:[(0,l.jsx)(p.MobileContainer,{showFrame:!1,children:(0,l.jsxs)(r.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,l.jsxs)(r.default,{sx:{display:"flex",alignItems:"center",gap:1,p:2,borderBottom:1,borderColor:"divider"},children:[(0,l.jsx)(d.A,{onClick:()=>I.push("/delivery-methods?tab=manage"),size:"small",children:(0,l.jsx)(g.A,{})}),(0,l.jsx)(o.default,{variant:"h6",sx:{fontWeight:600},children:"Rate Picker"})]}),(0,l.jsxs)(r.default,{sx:{p:3,flex:1,overflow:"auto"},children:[(0,l.jsx)(u.A,{sx:{mb:3},children:(0,l.jsxs)(c.A,{sx:{textAlign:"center"},children:[(0,l.jsx)(h.default,{src:null==A?void 0:A.avatarUrl,sx:{width:80,height:80,mx:"auto",mb:2,bgcolor:"primary.main",fontSize:32},children:null==A||null==(t=A.name)?void 0:t[0]}),(0,l.jsx)(o.default,{variant:"h6",sx:{fontWeight:600,mb:.5},children:null==A?void 0:A.name}),(0,l.jsx)(o.default,{variant:"body2",color:"text.secondary",children:"How was your delivery experience?"})]})}),(0,l.jsxs)(r.default,{sx:{mb:3,textAlign:"center"},children:[(0,l.jsx)(o.default,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Rating"}),(0,l.jsx)(x.A,{value:H,onChange:(e,t)=>P(t||0),size:"large",icon:(0,l.jsx)(v.default,{fontSize:"inherit"}),emptyIcon:(0,l.jsx)(b.A,{fontSize:"inherit"}),sx:{fontSize:48,"& .MuiRating-iconFilled":{color:"primary.main"}}})]}),(0,l.jsx)(f.default,{label:"Comment (optional)",multiline:!0,rows:4,fullWidth:!0,value:M,onChange:e=>O(e.target.value),placeholder:"Share your experience...",sx:{mb:3}}),(0,l.jsx)(m.A,{variant:"contained",fullWidth:!0,size:"large",onClick:U,disabled:_||0===H,children:_?"Submitting...":"Submit Rating"})]})]})}),(0,l.jsx)(j.default,{})]})})}},64937:(e,t,i)=>{Promise.resolve().then(i.bind(i,20517))}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,8449,1986,5394,3030,8441,5964,7358],()=>e(e.s=64937)),_N_E=e.O()}]);