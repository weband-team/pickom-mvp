(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6085],{21704:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var l=i(95155),a=i(12115),n=i(54581),r=i(14426),s=i(92302),d=i(3127),o=i(71116),u=i(41218),c=i(16632),h=i(42663),x=i(1154),f=i(78449),m=i(68534),g=i(38464),v=i(68558),b=i(7304),j=i(35695),y=i(43452),p=i(97704),C=i(21787),S=i(6864),k=i(18986);function w(e){var t;let{params:i}=e,w=(0,a.use)(i),I=(0,j.useRouter)(),[A,z]=(0,a.useState)(null),[W,F]=(0,a.useState)(!0),[R,_]=(0,a.useState)(""),[N,E]=(0,a.useState)(!1),[H,M]=(0,a.useState)(5),[O,P]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{F(!0),_("");try{let e=(await (0,C.IT)(Number(w.deliveryId))).data;if(!e.senderId)return void _("Sender information not found");let t=await (0,S.wz)(e.senderId);z(t.user)}catch(e){console.error("Failed to fetch sender:",e),_("Failed to load sender information")}finally{F(!1)}})()},[w.deliveryId]);let U=async()=>{if(A&&0!==H){E(!0);try{await (0,k.GS)({deliveryId:Number(w.deliveryId),toUserId:A.uid,rating:H,comment:O||void 0}),alert("Rating submitted successfully!"),I.push("/available-deliveries")}catch(i){var e,t;console.error("Failed to submit rating:",i),(null==(t=i.response)||null==(e=t.data)?void 0:e.message)?alert(i.response.data.message):alert("Failed to submit rating. Please try again.")}finally{E(!1)}}};return W?(0,l.jsx)(n.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default"},children:(0,l.jsx)(r.default,{})}):R?(0,l.jsx)(n.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default",p:2},children:(0,l.jsx)(s.A,{severity:"error",sx:{maxWidth:375},children:R})}):(0,l.jsx)(n.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"background.default",p:2},children:(0,l.jsxs)(n.default,{sx:{position:"relative",width:"100%",maxWidth:375,height:812},children:[(0,l.jsx)(y.MobileContainer,{showFrame:!1,children:(0,l.jsxs)(n.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,l.jsxs)(n.default,{sx:{display:"flex",alignItems:"center",gap:1,p:2,borderBottom:1,borderColor:"divider"},children:[(0,l.jsx)(d.A,{onClick:()=>I.push("/available-deliveries"),size:"small",children:(0,l.jsx)(g.A,{})}),(0,l.jsx)(o.default,{variant:"h6",sx:{fontWeight:600},children:"Rate Sender"})]}),(0,l.jsxs)(n.default,{sx:{p:3,flex:1,overflow:"auto"},children:[(0,l.jsx)(u.A,{sx:{mb:3},children:(0,l.jsxs)(c.A,{sx:{textAlign:"center"},children:[(0,l.jsx)(h.default,{src:null==A?void 0:A.avatarUrl,sx:{width:80,height:80,mx:"auto",mb:2,bgcolor:"secondary.main",fontSize:32},children:null==A||null==(t=A.name)?void 0:t[0]}),(0,l.jsx)(o.default,{variant:"h6",sx:{fontWeight:600,mb:.5},children:null==A?void 0:A.name}),(0,l.jsx)(o.default,{variant:"body2",color:"text.secondary",children:"How was your experience with this sender?"})]})}),(0,l.jsxs)(n.default,{sx:{mb:3,textAlign:"center"},children:[(0,l.jsx)(o.default,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Rating"}),(0,l.jsx)(x.A,{value:H,onChange:(e,t)=>M(t||0),size:"large",icon:(0,l.jsx)(v.default,{fontSize:"inherit"}),emptyIcon:(0,l.jsx)(b.A,{fontSize:"inherit"}),sx:{fontSize:48,"& .MuiRating-iconFilled":{color:"primary.main"}}})]}),(0,l.jsx)(f.default,{label:"Comment (optional)",multiline:!0,rows:4,fullWidth:!0,value:O,onChange:e=>P(e.target.value),placeholder:"Share your experience...",sx:{mb:3}}),(0,l.jsx)(m.A,{variant:"contained",fullWidth:!0,size:"large",onClick:U,disabled:N||0===H,children:N?"Submitting...":"Submit Rating"})]})]})}),(0,l.jsx)(p.default,{})]})})}},99938:(e,t,i)=>{Promise.resolve().then(i.bind(i,21704))}},e=>{e.O(0,[3965,7225,8795,4611,8534,5207,8449,1986,5394,3030,8441,5964,7358],()=>e(e.s=99938)),_N_E=e.O()}]);