(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var r=a(23915),i=a(45404);let o=(0,r.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),n=(0,i.xI)(o)},15933:(e,t,a)=>{"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}a.d(t,{_:()=>r})},21717:(e,t,a)=>{"use strict";a.d(t,{n:()=>i});var r=a(51070);let i={getUserNotifications:async()=>(await r.x.get("/notifications")).data,getUnreadCount:async()=>(await r.x.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await r.x.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await r.x.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await r.x.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await r.x.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await r.x.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await r.x.post("/notifications/status-update",e)).data,createNotification:async e=>(await r.x.post("/notifications/create",e)).data}},32963:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(95155),i=a(12115),o=a(71234);function n(){let{createOfferReceivedNotification:e,createOfferAcceptedNotification:t,createIncomingDeliveryNotification:a,createStatusUpdateNotification:n,createCustomNotification:c}=(0,o.E)(),[s,l]=(0,i.useState)(!1),d=async()=>{l(!0);try{await e({senderId:"X43wZP2lAdNA9GyhMxxRjd4rQPg1",deliveryId:1,pickerName:"Иван Петров",price:25})}catch(e){console.error("Error creating offer received notification:",e)}finally{l(!1)}},u=async()=>{l(!0);try{await t({senderId:"X43wZP2lAdNA9GyhMxxRjd4rQPg1",deliveryId:1})}catch(e){console.error("Error creating offer accepted notification:",e)}finally{l(!1)}},f=async()=>{l(!0);try{await a({recipientId:"X43wZP2lAdNA9GyhMxxRjd4rQPg1",deliveryId:2,senderName:"Анна Коваль"})}catch(e){console.error("Error creating incoming delivery notification:",e)}finally{l(!1)}},g=async()=>{l(!0);try{await n({userId:"X43wZP2lAdNA9GyhMxxRjd4rQPg1",deliveryId:1,status:"picked_up",message:"Курьер забрал вашу посылку и направляется к получателю."})}catch(e){console.error("Error creating status update notification:",e)}finally{l(!1)}},h=async()=>{l(!0);try{await c({user_id:"X43wZP2lAdNA9GyhMxxRjd4rQPg1",title:"Специальное предложение",message:"У нас есть специальное предложение для вас!",type:"new_delivery",read:!1,related_delivery_id:3})}catch(e){console.error("Error creating custom notification:",e)}finally{l(!1)}};return(0,r.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-sm border",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Действия с уведомлениями"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("button",{onClick:d,disabled:s,className:"px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:'\uD83D\uDCBC Создать "Новое предложение"'}),(0,r.jsx)("button",{onClick:u,disabled:s,className:"px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:'✅ Создать "Предложение принято"'}),(0,r.jsx)("button",{onClick:f,disabled:s,className:"px-4 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:'\uD83D\uDCE5 Создать "Входящая доставка"'}),(0,r.jsx)("button",{onClick:g,disabled:s,className:"px-4 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:'\uD83D\uDCE6 Создать "Обновление статуса"'}),(0,r.jsx)("button",{onClick:h,disabled:s,className:"px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed md:col-span-2 transition-colors",children:"\uD83D\uDD14 Создать кастомное уведомление"})]}),s&&(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Создание уведомления..."})]})]})}},43452:(e,t,a)=>{"use strict";a.d(t,{MobileContainer:()=>c});var r=a(95155);a(12115);var i=a(54581),o=a(18407),n=a(35695);let c=e=>{let{children:t,width:a=375,height:c=812,showFrame:s=!0,backgroundColor:l,showBottomNav:d=!0}=e,u=(0,n.usePathname)(),f=(null==u?void 0:u.includes("/login"))||(null==u?void 0:u.includes("/register")),g=d&&!f;return s?(0,r.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:3,backgroundColor:"#f5f5f5"},children:(0,r.jsx)(o.A,{elevation:3,sx:{width:a,height:g?"calc(".concat(c,"px - 70px)"):c,borderRadius:6,overflow:"hidden",position:"relative",bgcolor:l||"background.default",border:"8px solid #000000","&::before":{content:'""',position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",width:134,height:6,backgroundColor:"#000000",borderRadius:3,zIndex:1},"&::after":{content:'""',position:"absolute",bottom:8,left:"50%",transform:"translateX(-50%)",width:134,height:5,backgroundColor:"#000000",borderRadius:2.5,zIndex:1}},children:(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100%",height:"100%",paddingTop:6,overflow:"auto",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{paddingBottom:4,minHeight:"100%"},children:t})})})}):(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100%",maxWidth:a,height:g?"calc(100vh - 70px)":"100vh",maxHeight:g?"calc(".concat(c,"px - 70px)"):c,bgcolor:l||"background.default",overflow:"hidden",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{paddingBottom:0,minHeight:"100%",overflow:"auto",height:"100%"},children:t})})}},48579:(e,t,a)=>{Promise.resolve().then(a.bind(a,32963)),Promise.resolve().then(a.bind(a,43452))},51070:(e,t,a)=>{"use strict";a.d(t,{B:()=>n,x:()=>o});var r=a(23464),i=a(14140);let o=r.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(async e=>{let t=i.j.currentUser;if(t){let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}return e},e=>Promise.reject(e));let n=r.A.create({baseURL:"".concat("http://localhost:4242"),withCredentials:!0,headers:{"Content-Type":"application/json"}})},71234:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var r=a(12115),i=a(21717),o=a(31530);let n=()=>{let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(0),[c,s]=(0,r.useState)(!0),[l,d]=(0,r.useState)(null),u=(0,r.useCallback)(async()=>{try{s(!0),d(null);let[e,a]=await Promise.all([i.n.getUserNotifications(),i.n.getUnreadCount()]);t(e),n(a)}catch(e){d(e instanceof Error?e.message:"Failed to load notifications"),console.error("Error fetching notifications:",e)}finally{s(!1)}},[]),f=(0,r.useCallback)(async e=>{try{await i.n.markAsRead(e),t(t=>t.map(t=>t.id===e?{...t,read:!0}:t)),n(e=>Math.max(0,e-1))}catch(t){let e=t instanceof Error?t.message:"Failed to mark notification as read";o.default.error(e),console.error("Error marking notification as read:",t)}},[]),g=(0,r.useCallback)(async()=>{try{await i.n.markAllAsRead(),t(e=>e.map(e=>({...e,read:!0}))),n(0),o.default.success("All notifications marked as read")}catch(t){let e=t instanceof Error?t.message:"Failed to mark all as read";o.default.error(e),console.error("Error marking all notifications as read:",t)}},[]),h=(0,r.useCallback)(async e=>{try{let a=await i.n.notifyOfferReceived(e);return t(e=>[a,...e]),n(e=>e+1),o.default.success("Offer notification created"),a}catch(t){let e=t instanceof Error?t.message:"Failed to create notification";throw o.default.error(e),console.error("Error creating offer received notification:",t),t}},[]),p=(0,r.useCallback)(async e=>{try{let a=await i.n.notifyOfferAccepted(e);return t(e=>[a,...e]),n(e=>e+1),o.default.success("Offer accepted notification created"),a}catch(t){let e=t instanceof Error?t.message:"Failed to create notification";throw o.default.error(e),console.error("Error creating offer accepted notification:",t),t}},[]),y=(0,r.useCallback)(async e=>{try{let a=await i.n.notifyIncomingDelivery(e);return t(e=>[a,...e]),n(e=>e+1),o.default.success("Incoming delivery notification created"),a}catch(t){let e=t instanceof Error?t.message:"Failed to create notification";throw o.default.error(e),console.error("Error creating incoming delivery notification:",t),t}},[]),b=(0,r.useCallback)(async e=>{try{let a=await i.n.notifyStatusUpdate(e);return t(e=>[a,...e]),n(e=>e+1),o.default.success("Status update notification created"),a}catch(t){let e=t instanceof Error?t.message:"Failed to create notification";throw o.default.error(e),console.error("Error creating status update notification:",t),t}},[]),m=(0,r.useCallback)(async e=>{try{let a=await i.n.createNotification(e);return t(e=>[a,...e]),n(e=>e+1),o.default.success("Notification created"),a}catch(t){let e=t instanceof Error?t.message:"Failed to create notification";throw o.default.error(e),console.error("Error creating custom notification:",t),t}},[]),x=e.filter(e=>!e.read);return(0,r.useEffect)(()=>{u()},[u]),{notifications:e,unreadNotifications:x,unreadCount:a,isLoading:c,error:l,fetchNotifications:u,markAsRead:f,markAllAsRead:g,createOfferReceivedNotification:h,createOfferAcceptedNotification:p,createIncomingDeliveryNotification:y,createStatusUpdateNotification:b,createCustomNotification:m}}}},e=>{e.O(0,[3965,7225,4611,1530,8441,5964,7358],()=>e(e.s=48579)),_N_E=e.O()}]);