(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{18591:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>A});var r=a(95155),n=a(54581),i=a(14426),o=a(92302),s=a(3127),l=a(71116),c=a(68534),d=a(38464),u=a(28890),f=a(22122),h=a(15808),x=a(35695),g=a(12115),y=a(45404),m=a(14140),p=a(28069),j=a(43452),v=a(2791),b=a(66617),k=a(98226),C=a(97704),w=a(27604),S=a(46894);function A(){let e=(0,x.useRouter)(),{unreadChats:t,unreadNotifications:a,activeOrders:A}=(0,w.K)(),[I,E]=(0,g.useState)(null),[P,T]=(0,g.useState)(!0),[N,R]=(0,g.useState)(""),[O,U]=(0,g.useState)(!1);(0,g.useEffect)(()=>{(async()=>{try{let e=await (0,p.Nq)();E(e.data.user)}catch(t){R("Failed to load profile. Please login again."),setTimeout(()=>e.push("/login"),2e3)}finally{T(!1)}})()},[e]);let F=async()=>{try{U(!0),await (0,p.vx)(),await (0,y.CI)(m.j),localStorage.removeItem("userRole"),localStorage.removeItem("pickerOnlineStatus"),localStorage.removeItem("pickerPlannedTrips"),e.push("/login")}catch(e){R("Failed to sign out. Please try again."),U(!1)}};return P?(0,r.jsx)(n.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:(0,r.jsx)(i.default,{})}):N||!I?(0,r.jsx)(n.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",p:2},children:(0,r.jsx)(o.A,{severity:"error",children:N||"Failed to load profile"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.MobileContainer,{showFrame:!1,children:(0,r.jsxs)(n.default,{sx:{p:3,pb:6,backgroundColor:"background.default",minHeight:"100vh"},children:[(0,r.jsxs)(n.default,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(s.A,{onClick:()=>{e.back()},sx:{p:1,"&:hover":{backgroundColor:"action.hover"}},children:(0,r.jsx)(d.A,{})}),(0,r.jsx)(S.U,{})]}),(0,r.jsx)(v.b,{user:{id:I.uid,fullName:I.name,email:I.email,age:I.age||0,country:I.country||"",city:I.city||"",userType:"picker"===I.role?k.u.PICKER:k.u.SENDER,avatarUrl:I.avatarUrl,description:I.bio||"No description yet.",rating:I.rating||0,isVerified:I.isVerified||!1}}),I.about&&(0,r.jsxs)(n.default,{sx:{mb:3},children:[(0,r.jsx)(l.default,{variant:"h6",sx:{mb:1.5},children:"About"}),(0,r.jsx)(l.default,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6},children:I.about})]}),(0,r.jsx)(b.P,{rating:I.rating||0,totalRatings:I.totalRatings||0,role:I.role,completedDeliveries:I.completedDeliveries||0,totalOrders:I.totalOrders||0}),(0,r.jsxs)(n.default,{children:[(0,r.jsx)(l.default,{variant:"h6",sx:{mb:2},children:"Information"}),(0,r.jsxs)(n.default,{sx:{display:"flex",flexDirection:"column",gap:1},children:[I.location&&(0,r.jsxs)(n.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Location:"}),(0,r.jsxs)(l.default,{variant:"body2",children:[I.location.lat.toFixed(4),", ",I.location.lng.toFixed(4)]})]}),(0,r.jsxs)(n.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Email:"}),(0,r.jsx)(l.default,{variant:"body2",children:I.email})]}),I.phone&&(0,r.jsxs)(n.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Phone:"}),(0,r.jsx)(l.default,{variant:"body2",children:I.phone})]}),(0,r.jsxs)(n.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Role:"}),(0,r.jsx)(l.default,{variant:"body2",children:"picker"===I.role?"Picker":"Sender"})]})]})]}),(0,r.jsx)(n.default,{sx:{mt:4},children:(0,r.jsx)(c.A,{fullWidth:!0,variant:"contained",startIcon:(0,r.jsx)(u.A,{}),onClick:()=>e.push("/profile/edit"),sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Edit Profile"})}),(0,r.jsx)(n.default,{sx:{mt:2},children:(0,r.jsx)(c.A,{fullWidth:!0,variant:"outlined",startIcon:(0,r.jsx)(f.A,{}),onClick:()=>e.push("/earnings"),sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500},children:"picker"===I.role?"My Earnings":"My Balance"})}),(0,r.jsx)(n.default,{sx:{mt:2},children:(0,r.jsx)(c.A,{fullWidth:!0,variant:"outlined",color:"error",startIcon:(0,r.jsx)(h.A,{}),onClick:F,disabled:O,sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500},children:O?"Signing out...":"Sign Out"})})]})}),(0,r.jsx)(C.default,{unreadChatsCount:t,unreadNotificationsCount:a,activeOrdersCount:A})]})}},21717:(e,t,a)=>{"use strict";a.d(t,{n:()=>n});var r=a(51070);let n={getUserNotifications:async()=>(await r.xh.get("/notifications")).data,getUnreadCount:async()=>(await r.xh.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await r.xh.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await r.xh.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await r.xh.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await r.xh.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await r.xh.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await r.xh.post("/notifications/status-update",e)).data,createNotification:async e=>(await r.xh.post("/notifications/create",e)).data}},27604:(e,t,a)=>{"use strict";a.d(t,{K:()=>o});var r=a(12115),n=a(21717),i=a(16509);function o(){let[e,t]=(0,r.useState)(0),[a,o]=(0,r.useState)(0),[s,l]=(0,r.useState)(0),[c,d]=(0,r.useState)(!0),u=(0,r.useCallback)(async()=>{try{let[e,a]=await Promise.all([(0,i.ug)().catch(()=>({data:[]})),n.n.getUnreadCount().catch(()=>0)]),r=e.data.reduce((e,t)=>e+(t.unreadCount||0),0);t(r),o(a),l(0)}catch(e){console.error("Failed to fetch navigation badge counts:",e)}finally{d(!1)}},[]);return(0,r.useEffect)(()=>{u()},[u]),(0,r.useEffect)(()=>{let e=setInterval(u,3e4);return()=>clearInterval(e)},[u]),(0,r.useEffect)(()=>{let e=()=>{u()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[u]),{unreadChats:e,unreadNotifications:a,activeOrders:s,isLoading:c,refresh:u}}},28069:(e,t,a)=>{"use strict";a.d(t,{Nq:()=>l,c4:()=>i,mH:()=>s,mg:()=>o,vx:()=>c});var r=a(51070),n=a(14140);let i=async()=>{let e=n.j.currentUser;return e?await e.getIdToken():null},o=async e=>r.Bb.post("/auth/login",{},{headers:{Authorization:"Bearer ".concat(e)}}),s=async(e,t,a,n)=>r.Bb.post("/auth/register",{role:e,phone:a,name:n},{headers:{Authorization:"Bearer ".concat(t)}}),l=async()=>r.xh.get("/auth/me"),c=async()=>r.xh.post("/auth/logout")},46894:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});var r=a(95155);a(12115);var n=a(3127),i=a(77934),o=a(98387),s=a(83391);let l=e=>{let{sx:t}=e,{mode:a,toggleTheme:l}=(0,s.e)();return(0,r.jsx)(n.A,{onClick:l,sx:{color:"dark"===a?"#ffffff":"#1a1a1a",backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",border:1,borderColor:"dark"===a?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)","&:hover":{backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.15)":"rgba(0, 0, 0, 0.08)"},...t},"aria-label":"Toggle theme",children:"dark"===a?(0,r.jsx)(i.A,{}):(0,r.jsx)(o.A,{})})}},83391:(e,t,a)=>{"use strict";a.d(t,{I:()=>s,e:()=>o});var r=a(95155),n=a(12115);let i=(0,n.createContext)(void 0),o=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("useThemeMode must be used within ThemeModeProvider");return e},s=e=>{let{children:t,defaultMode:a="light"}=e,[o,s]=(0,n.useState)(a);return(0,n.useEffect)(()=>{let e=localStorage.getItem("pickom-theme");e&&("light"===e||"dark"===e)&&s(e)},[]),(0,n.useEffect)(()=>{localStorage.setItem("pickom-theme",o)},[o]),(0,r.jsx)(i.Provider,{value:{mode:o,toggleTheme:()=>{s(e=>"light"===e?"dark":"light")},setTheme:e=>{s(e)}},children:t})}},86586:(e,t,a)=>{Promise.resolve().then(a.bind(a,18591))}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,121,9433,8441,5964,7358],()=>e(e.s=86586)),_N_E=e.O()}]);