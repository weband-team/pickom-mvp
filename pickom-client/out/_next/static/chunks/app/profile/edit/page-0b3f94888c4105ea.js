(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4029],{6580:(e,t,a)=>{Promise.resolve().then(a.bind(a,33616))},6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>l,TK:()=>i,op:()=>s,wz:()=>o});var r=a(51070);let o=async e=>(await r.xh.get("/user/".concat(e))).data,i=async(e,t)=>(await r.xh.put("/user/".concat(e),t)).data,l=async()=>(await r.xh.get("/auth/me")).data,n=async(e,t)=>(await r.xh.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,s=async e=>(await r.xh.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var r=a(23915),o=a(45404);let i=(0,r.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),l=(0,o.xI)(i)},28069:(e,t,a)=>{"use strict";a.d(t,{Nq:()=>s,c4:()=>i,mH:()=>n,mg:()=>l,vx:()=>d});var r=a(51070),o=a(14140);let i=async()=>{let e=o.j.currentUser;return e?await e.getIdToken():null},l=async e=>r.Bb.post("/auth/login",{},{headers:{Authorization:"Bearer ".concat(e)}}),n=async(e,t,a,o)=>r.Bb.post("/auth/register",{role:e,phone:a,name:o},{headers:{Authorization:"Bearer ".concat(t)}}),s=async()=>r.xh.get("/auth/me"),d=async()=>r.xh.post("/auth/logout")},33616:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var r=a(95155),o=a(12115),i=a(54581),l=a(14426),n=a(3127),s=a(71116),d=a(42663),c=a(92302),u=a(41218),h=a(16632),g=a(78449),p=a(68534),b=a(38464),f=a(76377),x=a(51935),m=a(35695),v=a(43452),j=a(97704),k=a(46894),y=a(28069),C=a(6864);let w=(0,a(55028).default)(()=>Promise.all([a.e(9484),a.e(1761),a.e(2054)]).then(a.bind(a,92054)),{loadableGenerated:{webpack:()=>[92054]},ssr:!1,loading:()=>(0,r.jsx)(i.default,{sx:{height:"300px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(l.default,{})})});function I(){let e=(0,m.useRouter)(),[t,a]=(0,o.useState)(!0),[I,A]=(0,o.useState)(!1),[S,W]=(0,o.useState)(""),[P,L]=(0,o.useState)(""),[T,U]=(0,o.useState)(""),[F,B]=(0,o.useState)({name:"",phone:"",email:"",avatarUrl:"",about:"",locationLat:"",locationLng:"",locationPlaceId:""}),[M,R]=(0,o.useState)("");(0,o.useEffect)(()=>{(async()=>{try{var t,r,o,i,l;let e=(await (0,y.Nq)()).data.user;U(e.uid),B({name:e.name||"",phone:e.phone||"",email:e.email||"",avatarUrl:e.avatarUrl||"",about:e.about||"",locationLat:(null==(r=e.location)||null==(t=r.lat)?void 0:t.toString())||"",locationLng:(null==(i=e.location)||null==(o=i.lng)?void 0:o.toString())||"",locationPlaceId:(null==(l=e.location)?void 0:l.placeId)||""})}catch(t){W("Failed to load profile. Please login again."),setTimeout(()=>e.push("/login"),2e3)}finally{a(!1)}})()},[e]);let z=e=>{let t=e.replace(/\s+/g,"").replace(/[()-]/g,"");return t.startsWith("+")?t.length>=10&&t.length<=15?{isValid:!0,formatted:t}:{isValid:!1,formatted:t,error:"Phone number should be 10-15 digits"}:/^\d+$/.test(t)?t.length>=9&&t.length<=14?{isValid:!0,formatted:"+"+t}:{isValid:!1,formatted:t,error:"Phone number should be 9-14 digits"}:{isValid:!1,formatted:t,error:"Phone number can only contain digits"}},N=e=>t=>{let a=t.target.value;if("phone"===e)if(B({...F,[e]:a}),a.trim()){let e=z(a);e.isValid?R(""):R(e.error||"Invalid phone format")}else R("");else B({...F,[e]:a});W(""),L("")},E=async t=>{if(t.preventDefault(),!F.name.trim())return void W("Name is required");if(!F.phone.trim())return void W("Phone is required");let a=z(F.phone);if(!a.isValid)return void W(a.error||"Invalid phone number format");A(!0),W(""),L("");try{let t=F.locationLat&&F.locationLng?{lat:parseFloat(F.locationLat),lng:parseFloat(F.locationLng),placeId:F.locationPlaceId||void 0}:void 0;await (0,C.TK)(T,{name:F.name,phone:a.formatted,avatarUrl:F.avatarUrl||void 0,about:F.about||void 0,location:t}),L("Profile updated successfully!"),setTimeout(()=>{e.push("/profile")},1500)}catch(e){var r,o;W((null==(o=e.response)||null==(r=o.data)?void 0:r.message)||"Failed to update profile. Please try again.")}finally{A(!1)}};return t?(0,r.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:(0,r.jsx)(l.default,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.MobileContainer,{showFrame:!1,children:(0,r.jsxs)(i.default,{sx:{p:3,pb:10,backgroundColor:"background.default",minHeight:"100vh"},children:[(0,r.jsxs)(i.default,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(n.A,{onClick:()=>{e.back()},sx:{p:1,"&:hover":{backgroundColor:"action.hover"}},children:(0,r.jsx)(b.A,{})}),(0,r.jsx)(s.default,{variant:"h6",sx:{fontWeight:600},children:"Edit Profile"}),(0,r.jsx)(k.U,{})]}),(0,r.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",mb:3},children:(0,r.jsxs)(i.default,{sx:{position:"relative"},children:[(0,r.jsx)(d.default,{src:F.avatarUrl,alt:F.name,sx:{width:100,height:100,border:"4px solid",borderColor:"background.paper",boxShadow:2}}),(0,r.jsx)(n.A,{sx:{position:"absolute",bottom:0,right:0,backgroundColor:"primary.main",color:"white",width:36,height:36,"&:hover":{backgroundColor:"primary.dark"}},size:"small",children:(0,r.jsx)(f.A,{fontSize:"small"})})]})}),S&&(0,r.jsx)(c.A,{severity:"error",sx:{mb:2},children:S}),P&&(0,r.jsx)(c.A,{severity:"success",sx:{mb:2},children:P}),(0,r.jsx)(u.A,{children:(0,r.jsx)(h.A,{children:(0,r.jsx)("form",{onSubmit:E,children:(0,r.jsxs)(i.default,{sx:{display:"flex",flexDirection:"column",gap:2.5},children:[(0,r.jsx)(g.default,{label:"Full Name",variant:"outlined",fullWidth:!0,required:!0,value:F.name,onChange:N("name"),disabled:I,sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper"}}}),(0,r.jsx)(g.default,{label:"Phone Number",variant:"outlined",fullWidth:!0,required:!0,type:"tel",value:F.phone,onChange:N("phone"),disabled:I,placeholder:"+48123456789",error:!!M,helperText:M||"Use international format starting with + (e.g., +48123456789)",sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper"}}}),(0,r.jsx)(g.default,{label:"Email",variant:"outlined",fullWidth:!0,required:!0,type:"email",value:F.email,disabled:!0,helperText:"Email cannot be changed for security reasons",sx:{"& .MuiOutlinedInput-root":{backgroundColor:"action.disabledBackground"}}}),(0,r.jsx)(g.default,{label:"Avatar URL",variant:"outlined",fullWidth:!0,value:F.avatarUrl,onChange:N("avatarUrl"),disabled:I,placeholder:"https://example.com/avatar.jpg",sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper"}}}),(0,r.jsx)(g.default,{label:"About",variant:"outlined",fullWidth:!0,multiline:!0,rows:4,value:F.about,onChange:N("about"),disabled:I,placeholder:"Tell us about yourself...",sx:{"& .MuiOutlinedInput-root":{backgroundColor:"background.paper"}}}),(0,r.jsxs)(i.default,{sx:{mt:2,mb:1},children:[(0,r.jsx)(s.default,{variant:"subtitle2",sx:{mb:2,color:"text.secondary"},children:"Your Location"}),(0,r.jsx)(w,{onLocationSelect:(e,t)=>{B({...F,locationLat:e.toString(),locationLng:t.toString()}),W(""),L("")},initialPosition:F.locationLat&&F.locationLng?{lat:parseFloat(F.locationLat),lng:parseFloat(F.locationLng)}:void 0})]}),(0,r.jsx)(p.A,{type:"submit",fullWidth:!0,variant:"contained",startIcon:I?(0,r.jsx)(l.default,{size:20,color:"inherit"}):(0,r.jsx)(x.A,{}),disabled:I,sx:{py:1.5,mt:2,textTransform:"none",fontSize:"1rem",fontWeight:500},children:I?"Saving...":"Save Changes"})]})})})})]})}),(0,r.jsx)(j.default,{})]})}},43452:(e,t,a)=>{"use strict";a.d(t,{MobileContainer:()=>n});var r=a(95155);a(12115);var o=a(54581),i=a(18407),l=a(35695);let n=e=>{let{children:t,width:a=375,height:n=812,showFrame:s=!0,backgroundColor:d,showBottomNav:c=!0}=e,u=(0,l.usePathname)(),h=(null==u?void 0:u.includes("/login"))||(null==u?void 0:u.includes("/register")),g=c&&!h;return s?(0,r.jsx)(o.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:3,backgroundColor:"#f5f5f5"},children:(0,r.jsx)(i.A,{elevation:3,sx:{width:a,height:g?"calc(".concat(n,"px - 70px)"):n,borderRadius:6,overflow:"hidden",position:"relative",bgcolor:d||"background.default",border:"8px solid #000000","&::before":{content:'""',position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",width:134,height:6,backgroundColor:"#000000",borderRadius:3,zIndex:1},"&::after":{content:'""',position:"absolute",bottom:8,left:"50%",transform:"translateX(-50%)",width:134,height:5,backgroundColor:"#000000",borderRadius:2.5,zIndex:1}},children:(0,r.jsx)(o.default,{"data-mobile-container":!0,sx:{width:"100%",height:"100%",paddingTop:"calc(24px + var(--safe-area-top))",overflow:"auto",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(o.default,{sx:{paddingBottom:"calc(16px + var(--safe-area-bottom))",minHeight:"100%"},children:t})})})}):(0,r.jsx)(o.default,{"data-mobile-container":!0,sx:{width:"100vw",height:"100vh",bgcolor:d||"background.default",overflow:"hidden",position:"fixed",left:0,right:0,bottom:0,pt:"env(safe-area-inset-top)",pb:g?"68px":0,margin:0,"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(o.default,{sx:{width:"100%",height:"100%",overflow:"auto",margin:0,padding:0,"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:t})})}},46894:(e,t,a)=>{"use strict";a.d(t,{U:()=>s});var r=a(95155);a(12115);var o=a(3127),i=a(77934),l=a(98387),n=a(83391);let s=e=>{let{sx:t}=e,{mode:a,toggleTheme:s}=(0,n.e)();return(0,r.jsx)(o.A,{onClick:s,sx:{color:"dark"===a?"#ffffff":"#1a1a1a",backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",border:1,borderColor:"dark"===a?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)","&:hover":{backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.15)":"rgba(0, 0, 0, 0.08)"},...t},"aria-label":"Toggle theme",children:"dark"===a?(0,r.jsx)(i.A,{}):(0,r.jsx)(l.A,{})})}},51070:(e,t,a)=>{"use strict";a.d(t,{Bb:()=>n,H$:()=>i,xh:()=>l,y3:()=>s});var r=a(23464),o=a(14140);let i=a(6267).Ii.isNativePlatform()?"http://10.0.2.2:4242":"http://localhost:4242",l=r.A.create({baseURL:i,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(async e=>{let t=o.j.currentUser;if(t)try{let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}catch(e){}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>Promise.reject(e));let n=r.A.create({baseURL:i,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function s(){try{return await r.A.get("".concat(i,"/api"),{timeout:5e3}),!0}catch(e){return!1}}n.interceptors.response.use(e=>e,e=>Promise.reject(e))},83391:(e,t,a)=>{"use strict";a.d(t,{I:()=>n,e:()=>l});var r=a(95155),o=a(12115);let i=(0,o.createContext)(void 0),l=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useThemeMode must be used within ThemeModeProvider");return e},n=e=>{let{children:t,defaultMode:a="light"}=e,[l,n]=(0,o.useState)(a);return(0,o.useEffect)(()=>{let e=localStorage.getItem("pickom-theme");e&&("light"===e||"dark"===e)&&n(e)},[]),(0,o.useEffect)(()=>{localStorage.setItem("pickom-theme",l)},[l]),(0,r.jsx)(i.Provider,{value:{mode:l,toggleTheme:()=>{n(e=>"light"===e?"dark":"light")},setTheme:e=>{n(e)}},children:t})}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(95155),o=a(12115),i=a(35695),l=a(18407),n=a(40541),s=a(9111),d=a(26564),c=a(11335),u=a(21888),h=a(43290),g=a(60807);let p=e=>e>99?"99+":e,b=(0,o.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:b=0,userRole:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},x=(0,i.useRouter)(),m=(0,i.usePathname)(),[v,j]=(0,o.useState)(()=>localStorage.getItem("userRole"));(0,o.useEffect)(()=>{if(!f){let e=null;m.startsWith("/available-deliveries")?e="picker":m.startsWith("/delivery-methods")&&(e="sender"),e&&e!==v&&(j(e),localStorage.setItem("userRole",e))}},[m,f,v]);let k=f||v,y=(0,o.useMemo)(()=>m.startsWith("/delivery-methods")||m.startsWith("/orders")||m.startsWith("/available-deliveries")?0:m.startsWith("/chat")?1:m.startsWith("/notifications")?2:3*!!m.startsWith("/profile"),[m]),[C,w]=(0,o.useState)(y),I=(0,o.useCallback)((e,t)=>{switch(w(t),t){case 0:"picker"===k?x.push("/available-deliveries"):x.push("/delivery-methods");break;case 1:x.push("/chats");break;case 2:x.push("/notifications");break;case 3:x.push("/profile")}},[x,k]);return(0,r.jsx)(l.A,{className:e,sx:{position:"fixed",bottom:0,left:0,right:0,width:"100vw",zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:0,paddingRight:0,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)"},elevation:0,children:(0,r.jsxs)(n.A,{value:C,onChange:I,sx:{backgroundColor:"background.paper",width:"100%",height:"68px",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"},children:[(0,r.jsx)(s.A,{label:"Orders",icon:(0,r.jsx)(d.default,{badgeContent:p(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(c.default,{})})}),(0,r.jsx)(s.A,{label:"Chat",icon:(0,r.jsx)(d.default,{badgeContent:p(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(u.A,{})})}),(0,r.jsx)(s.A,{label:"Notifications",icon:(0,r.jsx)(d.default,{badgeContent:p(b),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(h.A,{})})}),(0,r.jsx)(s.A,{label:"Profile",icon:(0,r.jsx)(g.default,{})})]})})})}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,5207,8449,5394,348,8441,5964,7358],()=>e(e.s=6580)),_N_E=e.O()}]);