(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{18591:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var n=a(95155),r=a(54581),i=a(14426),o=a(92302),s=a(3127),l=a(71116),c=a(68534),d=a(38464),u=a(28890),f=a(22122),h=a(72093),x=a(15808),g=a(35695),y=a(12115),m=a(45404),p=a(14140),j=a(28069),v=a(43452),b=a(2791),k=a(66617),C=a(98226),w=a(97704),S=a(27604),A=a(46894);function I(){let e=(0,g.useRouter)(),{unreadChats:t,unreadNotifications:a,activeOrders:I}=(0,S.K)(),[E,P]=(0,y.useState)(null),[T,N]=(0,y.useState)(!0),[R,O]=(0,y.useState)(""),[U,F]=(0,y.useState)(!1);(0,y.useEffect)(()=>{(async()=>{try{let e=await (0,j.Nq)();P(e.data.user)}catch(t){O("Failed to load profile. Please login again."),setTimeout(()=>e.push("/login"),2e3)}finally{N(!1)}})()},[e]);let W=async()=>{try{F(!0),await (0,j.vx)(),await (0,m.CI)(p.j),localStorage.removeItem("userRole"),localStorage.removeItem("pickerOnlineStatus"),localStorage.removeItem("pickerPlannedTrips"),e.push("/login")}catch(e){O("Failed to sign out. Please try again."),F(!1)}};return T?(0,n.jsx)(r.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:(0,n.jsx)(i.default,{})}):R||!E?(0,n.jsx)(r.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",p:2},children:(0,n.jsx)(o.A,{severity:"error",children:R||"Failed to load profile"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.MobileContainer,{showFrame:!1,children:(0,n.jsxs)(r.default,{sx:{p:3,pb:6,backgroundColor:"background.default",minHeight:"100vh"},children:[(0,n.jsxs)(r.default,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)(s.A,{onClick:()=>{e.back()},sx:{p:1,"&:hover":{backgroundColor:"action.hover"}},children:(0,n.jsx)(d.A,{})}),(0,n.jsx)(A.U,{})]}),(0,n.jsx)(b.b,{user:{id:E.uid,fullName:E.name,email:E.email,age:E.age||0,country:E.country||"",city:E.city||"",userType:"picker"===E.role?C.u.PICKER:C.u.SENDER,avatarUrl:E.avatarUrl,description:E.bio||"No description yet.",rating:E.rating||0,isVerified:E.isVerified||!1}}),E.about&&(0,n.jsxs)(r.default,{sx:{mb:3},children:[(0,n.jsx)(l.default,{variant:"h6",sx:{mb:1.5},children:"About"}),(0,n.jsx)(l.default,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6},children:E.about})]}),(0,n.jsx)(k.P,{rating:E.rating||0,totalRatings:E.totalRatings||0,role:E.role,completedDeliveries:E.completedDeliveries||0,totalOrders:E.totalOrders||0}),(0,n.jsxs)(r.default,{children:[(0,n.jsx)(l.default,{variant:"h6",sx:{mb:2},children:"Information"}),(0,n.jsxs)(r.default,{sx:{display:"flex",flexDirection:"column",gap:1},children:[E.location&&(0,n.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Location:"}),(0,n.jsxs)(l.default,{variant:"body2",children:[E.location.lat.toFixed(4),", ",E.location.lng.toFixed(4)]})]}),(0,n.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Email:"}),(0,n.jsx)(l.default,{variant:"body2",children:E.email})]}),E.phone&&(0,n.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Phone:"}),(0,n.jsx)(l.default,{variant:"body2",children:E.phone})]}),(0,n.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)(l.default,{variant:"body2",color:"text.secondary",children:"Role:"}),(0,n.jsx)(l.default,{variant:"body2",children:"picker"===E.role?"Picker":"Sender"})]})]})]}),(0,n.jsx)(r.default,{sx:{mt:4},children:(0,n.jsx)(c.A,{fullWidth:!0,variant:"contained",startIcon:(0,n.jsx)(u.A,{}),onClick:()=>e.push("/profile/edit"),sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Edit Profile"})}),(0,n.jsx)(r.default,{sx:{mt:2},children:(0,n.jsx)(c.A,{fullWidth:!0,variant:"outlined",startIcon:(0,n.jsx)(f.A,{}),onClick:()=>e.push("/earnings"),sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500},children:"picker"===E.role?"My Earnings":"My Balance"})}),(0,n.jsx)(r.default,{sx:{mt:2},children:(0,n.jsx)(c.A,{fullWidth:!0,variant:"outlined",startIcon:(0,n.jsx)(h.default,{}),onClick:()=>e.push("/payment-methods"),sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500},children:"Payment Methods"})}),(0,n.jsx)(r.default,{sx:{mt:2},children:(0,n.jsx)(c.A,{fullWidth:!0,variant:"outlined",color:"error",startIcon:(0,n.jsx)(x.A,{}),onClick:W,disabled:U,sx:{py:1.5,textTransform:"none",fontSize:"1rem",fontWeight:500},children:U?"Signing out...":"Sign Out"})})]})}),(0,n.jsx)(w.default,{unreadChatsCount:t,unreadNotificationsCount:a,activeOrdersCount:I})]})}},21717:(e,t,a)=>{"use strict";a.d(t,{n:()=>r});var n=a(51070);let r={getUserNotifications:async()=>(await n.xh.get("/notifications")).data,getUnreadCount:async()=>(await n.xh.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await n.xh.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await n.xh.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await n.xh.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await n.xh.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await n.xh.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await n.xh.post("/notifications/status-update",e)).data,createNotification:async e=>(await n.xh.post("/notifications/create",e)).data}},27604:(e,t,a)=>{"use strict";a.d(t,{K:()=>o});var n=a(12115),r=a(21717),i=a(16509);function o(){let[e,t]=(0,n.useState)(0),[a,o]=(0,n.useState)(0),[s,l]=(0,n.useState)(0),[c,d]=(0,n.useState)(!0),u=(0,n.useCallback)(async()=>{try{let[e,a]=await Promise.all([(0,i.ug)().catch(()=>({data:[]})),r.n.getUnreadCount().catch(()=>0)]),n=e.data.reduce((e,t)=>e+(t.unreadCount||0),0);t(n),o(a),l(0)}catch(e){console.error("Failed to fetch navigation badge counts:",e)}finally{d(!1)}},[]);return(0,n.useEffect)(()=>{u()},[u]),(0,n.useEffect)(()=>{let e=setInterval(u,3e4);return()=>clearInterval(e)},[u]),(0,n.useEffect)(()=>{let e=()=>{u()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[u]),{unreadChats:e,unreadNotifications:a,activeOrders:s,isLoading:c,refresh:u}}},28069:(e,t,a)=>{"use strict";a.d(t,{Nq:()=>l,c4:()=>i,mH:()=>s,mg:()=>o,vx:()=>c});var n=a(51070),r=a(14140);let i=async()=>{let e=r.j.currentUser;return e?await e.getIdToken():null},o=async e=>n.Bb.post("/auth/login",{},{headers:{Authorization:"Bearer ".concat(e)}}),s=async(e,t,a,r)=>n.Bb.post("/auth/register",{role:e,phone:a,name:r},{headers:{Authorization:"Bearer ".concat(t)}}),l=async()=>n.xh.get("/auth/me"),c=async()=>n.xh.post("/auth/logout")},46894:(e,t,a)=>{"use strict";a.d(t,{U:()=>l});var n=a(95155);a(12115);var r=a(3127),i=a(77934),o=a(98387),s=a(83391);let l=e=>{let{sx:t}=e,{mode:a,toggleTheme:l}=(0,s.e)();return(0,n.jsx)(r.A,{onClick:l,sx:{color:"dark"===a?"#ffffff":"#1a1a1a",backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",border:1,borderColor:"dark"===a?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)","&:hover":{backgroundColor:"dark"===a?"rgba(255, 255, 255, 0.15)":"rgba(0, 0, 0, 0.08)"},...t},"aria-label":"Toggle theme",children:"dark"===a?(0,n.jsx)(i.A,{}):(0,n.jsx)(o.A,{})})}},83391:(e,t,a)=>{"use strict";a.d(t,{I:()=>s,e:()=>o});var n=a(95155),r=a(12115);let i=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useThemeMode must be used within ThemeModeProvider");return e},s=e=>{let{children:t,defaultMode:a="light"}=e,[o,s]=(0,r.useState)(a);return(0,r.useEffect)(()=>{let e=localStorage.getItem("pickom-theme");e&&("light"===e||"dark"===e)&&s(e)},[]),(0,r.useEffect)(()=>{localStorage.setItem("pickom-theme",o)},[o]),(0,n.jsx)(i.Provider,{value:{mode:o,toggleTheme:()=>{s(e=>"light"===e?"dark":"light")},setTheme:e=>{s(e)}},children:t})}},86586:(e,t,a)=>{Promise.resolve().then(a.bind(a,18591))}},e=>{e.O(0,[3965,7225,3964,8202,6592,8534,7844,5709,9433,8441,5964,7358],()=>e(e.s=86586)),_N_E=e.O()}]);