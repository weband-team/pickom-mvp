(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8856],{14140:(e,a,r)=>{"use strict";r.d(a,{j:()=>o});var t=r(23915),i=r(45404);let l=(0,t.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),o=(0,i.xI)(l)},21787:(e,a,r)=>{"use strict";r.d(a,{IT:()=>s,S1:()=>h,TS:()=>m,XE:()=>d,confirmRecipient:()=>p,createDeliveryRequest:()=>o,fI:()=>l,qM:()=>u,rg:()=>x,updateDeliveryRequest:()=>c,vd:()=>i,zW:()=>n});var t=r(51070);let i=async()=>t.Bb.get("/delivery/pickers"),l=async function(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"within-city";return t.Bb.get("/delivery/pickers/nearby?lat=".concat(e,"&lng=").concat(a,"&deliveryType=").concat(r))},o=async e=>t.xh.post("/delivery/requests",e),n=async()=>t.xh.get("/delivery/requests"),s=async e=>t.xh.get("/delivery/requests/".concat(e)),d=async(e,a)=>t.xh.put("/delivery/requests/".concat(e,"/status"),{status:a}),c=async(e,a)=>t.xh.patch("/delivery/requests/".concat(e),a),u=async()=>t.xh.get("/delivery/completed"),h=async()=>t.xh.get("/delivery/cancelled"),p=async(e,a)=>t.xh.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:a}),x=async e=>t.xh.post("/delivery/find-receiver",{email:e}),m=async()=>t.xh.get("/delivery/incoming")},33960:(e,a,r)=>{Promise.resolve().then(r.bind(r,45120))},45120:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>P});var t=r(95155),i=r(12115),l=r(35695),o=r(54581),n=r(71116),s=r(71803),d=r(70541),c=r(18096),u=r(78449),h=r(33989),p=r(92302),x=r(41218),m=r(60785),g=r(3127),f=r(50086),v=r(29982),b=r(19505),y=r(58343),j=function(e){return e.SMALL_PARCEL="small-parcel",e.LARGE_PARCEL="large-parcel",e.DOCUMENT="document",e.OTHER="other",e}({}),C=r(16950),k=r(97644),A=r(14426),L=r(42663),R=r(41101),E=r(21787);function S(e){let{recipientId:a,recipientPhone:r,onRecipientIdChange:l,onRecipientPhoneChange:d}=e,[c,u]=(0,i.useState)(()=>a?"email":r?"phone":"none"),[h,x]=(0,i.useState)(""),[m,g]=(0,i.useState)(!1),[f,v]=(0,i.useState)(null),[b,j]=(0,i.useState)(null),S=(0,i.useRef)(null),P=(0,i.useCallback)(async e=>{if(!e.trim()){v(null),j(null),l("");return}g(!0),j(null);try{let a=await (0,E.rg)(e.trim());a.data?(v(a.data),l(a.data.email),j(null)):(v(null),l(""),j("User not found"))}catch(e){v(null),l(""),j("Failed to search. Please try again.")}finally{g(!1)}},[l]);return(0,i.useEffect)(()=>()=>{S.current&&clearTimeout(S.current)},[]),(0,t.jsxs)(o.default,{sx:{mb:3},children:[(0,t.jsx)(n.default,{variant:"h6",sx:{mb:2},children:"Receiver (Optional)"}),(0,t.jsxs)(C.A,{value:c,exclusive:!0,onChange:(e,a)=>{null!==a&&(u(a),x(""),v(null),j(null),"none"===a?(l(""),d("")):"email"===a?d(""):"phone"===a&&l(""))},fullWidth:!0,sx:{mb:2},children:[(0,t.jsx)(k.A,{value:"none",children:"No Receiver"}),(0,t.jsx)(k.A,{value:"email",children:"Email"}),(0,t.jsx)(k.A,{value:"phone",children:"Phone Number"})]}),"email"===c&&(0,t.jsxs)(s.A,{spacing:2,children:[(0,t.jsx)(y.ks,{label:"Search by Email",value:h,onChange:e=>{let a=e.target.value;x(a),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{P(a)},500)},placeholder:"receiver@example.com",fullWidth:!0}),m&&(0,t.jsx)(o.default,{sx:{display:"flex",justifyContent:"center",p:1},children:(0,t.jsx)(A.default,{size:20})}),b&&!m&&(0,t.jsx)(p.A,{severity:"warning",children:b}),f&&!m&&(0,t.jsxs)(o.default,{sx:{p:2,border:"2px solid",borderColor:"success.main",borderRadius:2,backgroundColor:"success.light",display:"flex",alignItems:"center",gap:2},children:[f.avatarUrl&&(0,t.jsx)(L.default,{src:f.avatarUrl,alt:f.name,sx:{width:48,height:48}}),(0,t.jsxs)(o.default,{sx:{flex:1},children:[(0,t.jsx)(n.default,{variant:"subtitle1",fontWeight:"bold",children:f.name}),(0,t.jsx)(n.default,{variant:"body2",color:"text.secondary",children:f.email})]}),(0,t.jsx)(R.A,{label:"Found",color:"success",size:"small"})]})]}),"phone"===c&&(0,t.jsx)(y.ks,{label:"Receiver Phone Number",type:"tel",value:r,onChange:e=>d(e.target.value),placeholder:"+1234567890",fullWidth:!0})]})}function P(){let e=(0,l.useRouter)(),[a,C]=(0,i.useState)(""),[k,A]=(0,i.useState)(""),[L,R]=(0,i.useState)(""),[E,P]=(0,i.useState)(""),[w,D]=(0,i.useState)(""),[T,I]=(0,i.useState)(""),[M,O]=(0,i.useState)(""),[U,_]=(0,i.useState)(""),[F,z]=(0,i.useState)(null),[W,N]=(0,i.useState)(!1),[q,B]=(0,i.useState)(""),[H,G]=(0,i.useState)(""),[Y,X]=(0,i.useState)("file"),[$,J]=(0,i.useState)(""),K=async()=>{if(!$.trim())return void G("Please enter an image URL");G("");try{let e=await fetch($);if(!e.ok)throw Error("Failed to load image");let a=await e.blob();if(a.size>0xa00000)return void G("Image size must be less than 10MB");if(!a.type.startsWith("image/"))return void G("URL must point to an image file");let r=new FileReader;r.onload=e=>{var a;let r=null==(a=e.target)?void 0:a.result;B(r),G("")},r.onerror=()=>{G("Failed to process image")},r.readAsDataURL(a)}catch(e){G("Failed to load image from URL. Make sure the URL is valid and accessible.")}},Q=()=>F===j.DOCUMENT||F===j.SMALL_PARCEL?"small":F===j.LARGE_PARCEL?"large":"medium";return(0,t.jsx)(o.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,t.jsx)(y.kc,{showFrame:!1,children:(0,t.jsxs)(o.default,{sx:{p:3,pb:6},children:[(0,t.jsxs)(o.default,{sx:{textAlign:"center",mb:4},children:[(0,t.jsx)(y.Lm,{size:"medium"}),(0,t.jsx)(n.default,{variant:"h4",sx:{mt:2,mb:1},children:"Select Package Type"})]}),(0,t.jsxs)(s.A,{spacing:2,sx:{mb:3},children:[(0,t.jsx)(o.default,{onClick:()=>{z(j.SMALL_PARCEL)},sx:{p:3,border:F===j.SMALL_PARCEL?"3px solid":"2px solid",borderColor:F===j.SMALL_PARCEL?"primary.main":"divider",borderRadius:2,cursor:"pointer",backgroundColor:F===j.SMALL_PARCEL?"action.selected":"background.paper",transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:"action.hover",transform:"translateY(-2px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"}},children:(0,t.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,t.jsx)(n.default,{fontSize:"2rem",children:"\uD83D\uDCE6"}),(0,t.jsxs)(o.default,{children:[(0,t.jsx)(n.default,{variant:"h6",sx:{color:F===j.SMALL_PARCEL?"primary.main":"text.primary",fontWeight:F===j.SMALL_PARCEL?"bold":"normal"},children:"Small Parcel"}),(0,t.jsx)(n.default,{variant:"body2",color:"text.secondary",children:"Documents, small items up to 2kg"})]})]})}),(0,t.jsx)(o.default,{onClick:()=>{z(j.LARGE_PARCEL)},sx:{p:3,border:F===j.LARGE_PARCEL?"3px solid":"2px solid",borderColor:F===j.LARGE_PARCEL?"primary.main":"divider",borderRadius:2,cursor:"pointer",backgroundColor:F===j.LARGE_PARCEL?"action.selected":"background.paper",transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:"action.hover",transform:"translateY(-2px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"}},children:(0,t.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,t.jsx)(n.default,{fontSize:"2rem",children:"\uD83D\uDCEB"}),(0,t.jsxs)(o.default,{children:[(0,t.jsx)(n.default,{variant:"h6",sx:{color:F===j.LARGE_PARCEL?"primary.main":"text.primary",fontWeight:F===j.LARGE_PARCEL?"bold":"normal"},children:"Large Parcel"}),(0,t.jsx)(n.default,{variant:"body2",color:"text.secondary",children:"Furniture, large packages over 2kg"})]})]})}),(0,t.jsx)(o.default,{onClick:()=>{z(j.DOCUMENT)},sx:{p:3,border:F===j.DOCUMENT?"3px solid":"2px solid",borderColor:F===j.DOCUMENT?"primary.main":"divider",borderRadius:2,cursor:"pointer",backgroundColor:F===j.DOCUMENT?"action.selected":"background.paper",transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:"action.hover",transform:"translateY(-2px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"}},children:(0,t.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,t.jsx)(n.default,{fontSize:"2rem",children:"\uD83D\uDCC4"}),(0,t.jsxs)(o.default,{children:[(0,t.jsx)(n.default,{variant:"h6",sx:{color:F===j.DOCUMENT?"primary.main":"text.primary",fontWeight:F===j.DOCUMENT?"bold":"normal"},children:"Document"}),(0,t.jsx)(n.default,{variant:"body2",color:"text.secondary",children:"Papers, contracts, certificates"})]})]})}),(0,t.jsx)(o.default,{onClick:()=>{z(j.OTHER)},sx:{p:3,border:F===j.OTHER?"3px solid":"2px solid",borderColor:F===j.OTHER?"primary.main":"divider",borderRadius:2,cursor:"pointer",backgroundColor:F===j.OTHER?"action.selected":"background.paper",transition:"all 0.2s ease-in-out","&:hover":{backgroundColor:"action.hover",transform:"translateY(-2px)",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"}},children:(0,t.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,t.jsx)(n.default,{fontSize:"2rem",children:"❓"}),(0,t.jsxs)(o.default,{children:[(0,t.jsx)(n.default,{variant:"h6",sx:{color:F===j.OTHER?"primary.main":"text.primary",fontWeight:F===j.OTHER?"bold":"normal"},children:"Other"}),(0,t.jsx)(n.default,{variant:"body2",color:"text.secondary",children:"Tell us what you're sending"})]})]})})]}),(0,t.jsxs)(o.default,{sx:{mb:3},children:[(0,t.jsx)(n.default,{variant:"h6",sx:{mb:2},children:"Package Details"}),(0,t.jsxs)(s.A,{spacing:2,children:[(0,t.jsx)(y.ks,{label:"What are you sending?",value:a,onChange:e=>C(e.target.value),placeholder:"e.g., Documents, Flowers, Phone",required:!0,fullWidth:!0}),(0,t.jsx)(y.ks,{label:"Description (optional)",value:k,onChange:e=>A(e.target.value),multiline:!0,rows:2,placeholder:"Additional details about the package",fullWidth:!0}),(0,t.jsx)(y.ks,{label:"Price (zł)",type:"number",value:L,onChange:e=>R(e.target.value),required:!0,fullWidth:!0}),(0,t.jsx)(y.ks,{label:"Weight (kg) - optional",type:"number",value:E,onChange:e=>P(e.target.value),fullWidth:!0})]})]}),(0,t.jsxs)(o.default,{sx:{mb:3},children:[(0,t.jsx)(n.default,{variant:"h6",sx:{mb:2},children:"Special Instructions (Optional)"}),(0,t.jsx)(y.ks,{multiline:!0,rows:3,value:w,onChange:e=>D(e.target.value),fullWidth:!0,placeholder:"e.g., Call before delivery, Fragile"})]}),(0,t.jsxs)(o.default,{sx:{mb:3},children:[(0,t.jsx)(n.default,{variant:"h6",sx:{mb:2},children:"Package Photo (Optional)"}),q?(0,t.jsxs)(o.default,{children:[(0,t.jsxs)(x.A,{sx:{position:"relative"},children:[(0,t.jsx)(m.A,{component:"img",image:q,alt:"Package preview",sx:{maxHeight:300,objectFit:"contain",backgroundColor:"grey.100"}}),(0,t.jsx)(g.A,{onClick:()=>{B(""),G(""),J("")},sx:{position:"absolute",top:8,right:8,backgroundColor:"background.paper","&:hover":{backgroundColor:"error.light",color:"error.contrastText"}},children:(0,t.jsx)(b.A,{})})]}),(0,t.jsx)(n.default,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Image uploaded successfully"})]}):(0,t.jsxs)(o.default,{children:[(0,t.jsxs)(d.A,{value:Y,onChange:(e,a)=>{X(a),G("")},sx:{mb:2,borderBottom:1,borderColor:"divider"},children:[(0,t.jsx)(c.A,{label:"Upload File",value:"file"}),(0,t.jsx)(c.A,{label:"From URL",value:"url"})]}),"file"===Y?(0,t.jsxs)(o.default,{children:[(0,t.jsx)("input",{accept:"image/*",style:{display:"none"},id:"package-image-upload",type:"file",onChange:e=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(!r)return;if(!r.type.startsWith("image/"))return void G("Please select an image file");if(r.size>0xa00000)return void G("Image size must be less than 10MB");let t=new FileReader;t.onload=e=>{var a;B(null==(a=e.target)?void 0:a.result),G("")},t.onerror=()=>{G("Failed to read image")},t.readAsDataURL(r)}}),(0,t.jsx)("label",{htmlFor:"package-image-upload",children:(0,t.jsxs)(o.default,{sx:{border:"2px dashed",borderColor:H?"error.main":"divider",borderRadius:2,p:3,textAlign:"center",cursor:"pointer",transition:"all 0.2s","&:hover":{borderColor:"primary.main",backgroundColor:"action.hover"}},children:[(0,t.jsx)(f.A,{sx:{fontSize:48,color:"text.secondary",mb:1}}),(0,t.jsx)(n.default,{variant:"body1",color:"text.secondary",children:"Click to upload package photo"}),(0,t.jsx)(n.default,{variant:"caption",color:"text.secondary",children:"Max size: 10MB"})]})})]}):(0,t.jsxs)(o.default,{children:[(0,t.jsxs)(s.A,{direction:"row",spacing:1,children:[(0,t.jsx)(u.default,{fullWidth:!0,placeholder:"https://example.com/image.jpg",value:$,onChange:e=>J(e.target.value),error:!!H,size:"small",InputProps:{startAdornment:(0,t.jsx)(h.default,{position:"start",children:(0,t.jsx)(v.A,{})})}}),(0,t.jsx)(y.$n,{onClick:K,disabled:!$.trim(),sx:{whiteSpace:"nowrap"},children:"Load Image"})]}),(0,t.jsx)(n.default,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Enter image URL (Max size: 10MB)"})]}),H&&(0,t.jsx)(p.A,{severity:"error",sx:{mt:2},children:H})]})]}),F===j.OTHER&&(0,t.jsx)(o.default,{sx:{mb:3},children:(0,t.jsx)(y.ks,{label:"Please describe what you're sending",value:T,onChange:e=>I(e.target.value),fullWidth:!0,required:!0})}),(0,t.jsx)(S,{recipientId:M,recipientPhone:U,onRecipientIdChange:O,onRecipientPhoneChange:_}),(0,t.jsxs)(s.A,{direction:"row",justifyContent:"space-between",sx:{mt:2},children:[(0,t.jsx)(y.$n,{variant:"outlined",onClick:()=>e.back(),children:"Back"}),(0,t.jsx)(y.$n,{onClick:async()=>{N(!0);try{let t=localStorage.getItem("deliveryData");if(!t){(await r.e(1530).then(r.bind(r,31530))).default.error("Delivery information not found. Please start from the beginning."),e.push("/delivery-methods");return}let i=JSON.parse(t);if(!i.fromLocation||!i.toLocation){(await r.e(1530).then(r.bind(r,31530))).default.error("Location information not found. Please start from the beginning."),e.push("/delivery-methods");return}let l=i.selectedMethod||"within-city",{createDeliveryRequest:o}=await Promise.resolve().then(r.bind(r,21787)),n=(await r.e(1530).then(r.bind(r,31530))).default,s=n.loading("Creating delivery..."),d=(await o({title:a,description:k||void 0,fromLocation:i.fromLocation,toLocation:i.toLocation,deliveryType:l,price:parseFloat(L),size:Q(),weight:E?parseFloat(E):void 0,notes:w||void 0,recipientEmail:M||void 0,recipientPhone:U||void 0,packageImageUrl:q||void 0})).data.id;n.success("Delivery created successfully!",{id:s});let c={...i,deliveryId:d,deliveryType:l,packageType:F,title:a,description:k||void 0,size:Q(),price:parseFloat(L),weight:E?parseFloat(E):void 0,notes:w||void 0,otherDescription:F===j.OTHER?T:void 0,recipientEmail:M||void 0,recipientPhone:U||void 0};localStorage.setItem("deliveryData",JSON.stringify(c)),e.push("/searching-pickers")}catch(l){var t,i;let e=(await r.e(1530).then(r.bind(r,31530))).default,a=(null==(i=l.response)||null==(t=i.data)?void 0:t.message)||"Failed to create delivery. Please try again.";e.error(a),N(!1)}},disabled:!F||!a||!L||F===j.OTHER&&!T||W,loading:W,variant:F&&a&&L?"contained":"outlined",sx:{"&.Mui-disabled":{backgroundColor:"action.disabled",color:"text.disabled",borderColor:"divider"}},children:"Create Order & Find Pickers"})]})]})})})}},51070:(e,a,r)=>{"use strict";r.d(a,{Bb:()=>d,xh:()=>s,y3:()=>c});var t=r(23464),i=r(14140),l=r(6267),o=r(87358);let n=l.Ii.isNativePlatform()?"https://pickom.qirelab.com":o.env.NEXT_PUBLIC_API_URL||"https://pickom.qirelab.com",s=t.A.create({baseURL:n,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(async e=>{let a=i.j.currentUser;if(a)try{let r=await a.getIdToken();e.headers.Authorization="Bearer ".concat(r)}catch(e){}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>Promise.reject(e));let d=t.A.create({baseURL:n,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function c(){try{return await t.A.get("".concat(n,"/api"),{timeout:5e3}),!0}catch(e){return!1}}d.interceptors.response.use(e=>e,e=>Promise.reject(e))}},e=>{e.O(0,[3965,7225,3964,8202,6592,8534,7844,1101,5207,8652,8449,1190,7615,1986,2649,7212,8142,702,8343,8441,5964,7358],()=>e(e.s=33960)),_N_E=e.O()}]);