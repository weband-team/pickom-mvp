(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4956,6509],{1081:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>k});var a=i(95155),n=i(12115),l=i(35695),r=i(54581),s=i(14426),o=i(70541),d=i(18096),c=i(71116),u=i(41218),h=i(41101),p=i(72705),f=i(26564),y=i(83729),x=i(3127),v=i(74802),m=i(74863),g=i(58343),b=i(97704),C=i(21787),j=i(27604);let T=(0,i(55028).default)(()=>Promise.all([i.e(9484),i.e(1761),i.e(8142),i.e(6166)]).then(i.bind(i,66166)),{loadableGenerated:{webpack:()=>[66166]},ssr:!1,loading:()=>(0,a.jsx)(r.default,{sx:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(s.default,{})})}),I={selectedMethod:"",title:"",description:"",price:0,size:"",weight:0,notes:"",withinCity:{fromLocation:null,toLocation:null,pickupDateTime:null},interCity:{fromLocation:null,toLocation:null,preferredDeliveryDate:null},international:{pickupCountry:"",pickupCity:"",pickupAddress:"",destinationCountry:"",destinationCity:"",destinationAddress:"",deliveryDate:null}};function E(e,t){switch(t.type){case"SET_METHOD":return{...e,selectedMethod:t.payload};case"SET_TITLE":return{...e,title:t.payload};case"SET_DESCRIPTION":return{...e,description:t.payload};case"SET_PRICE":return{...e,price:t.payload};case"SET_SIZE":return{...e,size:t.payload};case"SET_WEIGHT":return{...e,weight:t.payload};case"SET_NOTES":return{...e,notes:t.payload};case"SET_WITHIN_CITY_FIELD":return{...e,withinCity:{...e.withinCity,[t.field]:t.value}};case"SET_INTER_CITY_FIELD":return{...e,interCity:{...e.interCity,[t.field]:t.value}};case"SET_INTERNATIONAL_FIELD":return{...e,international:{...e.international,[t.field]:t.value}};case"RESET":return I;default:return e}}function A(e){let{deliveries:t,loading:i,onRefresh:f}=e,y=(0,l.useRouter)(),[x,v]=(0,n.useState)("current"),m=[...t].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),b=m.filter(e=>["pending","accepted","picked_up"].includes(e.status)),C=m.filter(e=>["delivered","cancelled"].includes(e.status)),j=e=>{if(!e)return"N/A";let t=e.split(",").map(e=>e.trim());return t.length>=2?"".concat(t[0],", ").concat(t[1]):t[0]||e},T="current"===x?b:C;return i?(0,a.jsx)(r.default,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,a.jsx)(s.default,{})}):(0,a.jsxs)(r.default,{children:[(0,a.jsxs)(o.A,{value:x,onChange:(e,t)=>v(t),variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider",mb:2,minHeight:40,width:"100%","& .MuiTabs-flexContainer":{width:"100%"},"& .MuiTab-root":{minHeight:40,fontSize:"0.875rem",textTransform:"uppercase",flex:1,maxWidth:"none"}},children:[(0,a.jsx)(d.A,{label:"Current (".concat(b.length,")"),value:"current"}),(0,a.jsx)(d.A,{label:"Past (".concat(C.length,")"),value:"past"})]}),0===T.length?(0,a.jsx)(r.default,{sx:{textAlign:"center",py:4},children:(0,a.jsx)(c.default,{color:"text.secondary",children:"current"===x?"No current deliveries":"No past deliveries"})}):T.map(e=>{var t,i;return(0,a.jsxs)(u.A,{sx:{mb:2,p:2,transition:"all 0.2s","&:hover":{boxShadow:4}},children:[(0,a.jsxs)(r.default,{sx:{display:"flex",alignItems:"flex-start",gap:1,mb:1},children:[(0,a.jsxs)(r.default,{sx:{flex:1},children:[(0,a.jsx)(c.default,{variant:"subtitle1",sx:{fontWeight:600,mb:.5},children:e.title}),(0,a.jsx)(c.default,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:new Date(e.createdAt).toLocaleDateString("en-US")})]}),(0,a.jsxs)(r.default,{sx:{display:"flex",gap:.5,flexWrap:"wrap",justifyContent:"flex-end"},children:["inter-city"===e.deliveryType&&(0,a.jsx)(h.A,{label:"Inter-City",size:"small",color:"info",sx:{height:20,fontSize:"0.7rem"}}),(0,a.jsx)(h.A,{label:e.status.replace("_"," "),size:"small",color:"delivered"===e.status?"success":"cancelled"===e.status?"error":"pending"===e.status?"warning":"primary",sx:{height:20,fontSize:"0.7rem",textTransform:"capitalize"}})]})]}),(0,a.jsxs)(c.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[j((null==(t=e.fromLocation)?void 0:t.address)||"")," →"," ",j((null==(i=e.toLocation)?void 0:i.address)||"")]}),(0,a.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,a.jsxs)(c.default,{variant:"body2",sx:{fontWeight:600},children:[e.price," zł"]}),(0,a.jsx)(c.default,{variant:"caption",color:"text.secondary",children:e.size})]}),(0,a.jsxs)(p.A,{direction:"row",spacing:1,children:[(0,a.jsx)(g.$n,{size:"small",variant:"outlined",fullWidth:!0,onClick:()=>y.push("/delivery-methods/".concat(e.id,"/offers")),children:"View Offers"}),(0,a.jsx)(g.$n,{size:"small",variant:"contained",fullWidth:!0,onClick:()=>{localStorage.setItem("searchPickersDeliveryId",e.id.toString()),localStorage.setItem("deliveryData",JSON.stringify({deliveryId:e.id,fromLocation:e.fromLocation,toLocation:e.toLocation,deliveryType:e.deliveryType||"within-city"})),y.push("/picker-results")},children:"Search Pickers"})]})]},e.id)})]})}function L(e){let{deliveries:t,loading:n,onRefresh:o}=e;(0,l.useRouter)();let d=t.filter(e=>"pending"===e.status&&!e.recipientConfirmed),f=t.filter(e=>!0===e.recipientConfirmed&&"delivered"!==e.status),y=t.filter(e=>"delivered"===e.status),x=async(e,t)=>{try{let{confirmRecipient:a}=await Promise.resolve().then(i.bind(i,21787));await a(e,t),alert(t?"Delivery accepted!":"Delivery rejected"),o()}catch(e){alert("Failed to process confirmation")}};return n?(0,a.jsx)(r.default,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,a.jsx)(s.default,{})}):(0,a.jsxs)(r.default,{children:[d.length>0&&(0,a.jsxs)(r.default,{sx:{mb:4},children:[(0,a.jsxs)(c.default,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:["Pending Confirmation (",d.length,")"]}),d.map(e=>{var t,i;return(0,a.jsxs)(u.A,{sx:{mb:2,p:2},children:[(0,a.jsx)(c.default,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:e.title}),(0,a.jsxs)(c.default,{variant:"body2",color:"text.secondary",children:[(null==(t=e.fromLocation)?void 0:t.address)||"N/A"," → ",(null==(i=e.toLocation)?void 0:i.address)||"N/A"]}),(0,a.jsxs)(c.default,{variant:"body2",sx:{mt:1},children:["Size: ",e.size," | Price: ",e.price," zł"]}),(0,a.jsxs)(p.A,{direction:"row",spacing:1,sx:{mt:2},children:[(0,a.jsx)(g.$n,{size:"small",variant:"contained",color:"success",onClick:()=>x(e.id,!0),children:"Accept"}),(0,a.jsx)(g.$n,{size:"small",variant:"outlined",color:"error",onClick:()=>x(e.id,!1),children:"Reject"})]})]},e.id)})]}),f.length>0&&(0,a.jsxs)(r.default,{sx:{mb:4},children:[(0,a.jsxs)(c.default,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:["Active (",f.length,")"]}),f.map(e=>{var t,i;return(0,a.jsxs)(u.A,{sx:{mb:2,p:2},children:[(0,a.jsx)(c.default,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:e.title}),(0,a.jsxs)(c.default,{variant:"body2",color:"text.secondary",children:[(null==(t=e.fromLocation)?void 0:t.address)||"N/A"," → ",(null==(i=e.toLocation)?void 0:i.address)||"N/A"]}),(0,a.jsx)(h.A,{label:"picked_up"===e.status?"In Transit":e.status,size:"small",color:"primary",sx:{mt:1}})]},e.id)})]}),y.length>0&&(0,a.jsxs)(r.default,{sx:{mb:4},children:[(0,a.jsxs)(c.default,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:["Delivered (",y.length,")"]}),y.map(e=>{var t,i;return(0,a.jsxs)(u.A,{sx:{mb:2,p:2},children:[(0,a.jsx)(c.default,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:e.title}),(0,a.jsxs)(c.default,{variant:"body2",color:"text.secondary",children:[(null==(t=e.fromLocation)?void 0:t.address)||"N/A"," → ",(null==(i=e.toLocation)?void 0:i.address)||"N/A"]}),(0,a.jsx)(h.A,{label:"Delivered",size:"small",color:"success",sx:{mt:1}})]},e.id)})]}),0===t.length&&(0,a.jsx)(r.default,{sx:{textAlign:"center",py:4},children:(0,a.jsx)(c.default,{color:"text.secondary",children:"No incoming deliveries"})})]})}function k(){let e=(0,l.useRouter)(),[t,i]=(0,n.useReducer)(E,I),[s,u]=(0,n.useState)(!1),[h,k]=(0,n.useState)("create"),[S,_]=(0,n.useState)([]),[D,N]=(0,n.useState)([]),[w,R]=(0,n.useState)(!1),[F,W]=(0,n.useState)(!1),{unreadChats:z,unreadNotifications:P,activeOrders:M}=(0,j.K)();(0,n.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("tab");"manage"===e?k("manage"):"incoming"===e&&k("incoming")},[]),(0,n.useEffect)(()=>{"manage"===h?O():"incoming"===h&&H()},[h]);let O=async()=>{R(!0);try{let e=await (0,C.zW)();_(e.data)}catch(e){}finally{R(!1)}},H=async()=>{W(!0);try{let e=await (0,C.TS)();N(e.data)}catch(e){}finally{W(!1)}},B=[{value:"RU",label:"Russia"},{value:"KZ",label:"Kazakhstan"},{value:"UZ",label:"Uzbekistan"},{value:"KG",label:"Kyrgyzstan"},{value:"TJ",label:"Tajikistan"},{value:"BY",label:"Belarus"},{value:"AM",label:"Armenia"},{value:"AZ",label:"Azerbaijan"},{value:"GE",label:"Georgia"},{value:"MD",label:"Moldova"},{value:"US",label:"United States"},{value:"DE",label:"Germany"},{value:"FR",label:"France"},{value:"GB",label:"United Kingdom"},{value:"CN",label:"China"},{value:"TR",label:"Turkey"}],U=t.withinCity.fromLocation&&t.withinCity.toLocation,Y=t.interCity.fromLocation&&t.interCity.toLocation,K=t.international.pickupCountry&&t.international.pickupCity,q=(()=>{let{selectedMethod:e,withinCity:i,interCity:a,international:n}=t;switch(e){case"within-city":return i.fromLocation&&i.toLocation&&i.pickupDateTime;case"inter-city":return a.fromLocation&&a.toLocation&&a.preferredDeliveryDate;case"international":return n.pickupCountry&&n.pickupCity&&n.pickupAddress&&n.destinationCountry&&n.destinationCity&&n.destinationAddress&&n.deliveryDate;default:return!1}})();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.kc,{showFrame:!1,children:(0,a.jsxs)(r.default,{sx:{p:3,pb:10,backgroundColor:"background.default",minHeight:"100vh"},children:[(0,a.jsx)(r.default,{sx:{mb:3,display:"flex",alignItems:"center"},children:(0,a.jsx)(c.default,{variant:"h5",sx:{fontWeight:"bold"},children:"Delivery Management"})}),(0,a.jsxs)(o.A,{value:h,onChange:(e,t)=>k(t),variant:"fullWidth",sx:{mb:3,borderBottom:1,borderColor:"divider",width:"100%","& .MuiTabs-flexContainer":{width:"100%"},"& .MuiTab-root":{flex:1,maxWidth:"none"}},children:[(0,a.jsx)(d.A,{value:"create",label:"Create"}),(0,a.jsx)(d.A,{value:"manage",label:"Sent"}),(0,a.jsx)(d.A,{value:"incoming",label:"Incoming"})]}),"create"===h&&(0,a.jsxs)(r.default,{children:[(0,a.jsxs)(r.default,{sx:{mb:4},children:[(0,a.jsx)(c.default,{variant:"h6",sx:{mb:2},children:"Choose Delivery Method"}),(0,a.jsx)(p.A,{direction:"row",spacing:1,sx:{mb:3,width:"100%"},children:[{id:"within-city",name:"Within-City",description:"Same city delivery"},{id:"inter-city",name:"Inter-City",description:"Between cities"},{id:"international",name:"International",description:"Cross-border delivery"}].map(e=>{let n="within-city"===e.id&&U||"inter-city"===e.id&&Y||"international"===e.id&&K;return(0,a.jsx)(f.default,{badgeContent:n?(0,a.jsx)(v.default,{sx:{fontSize:16}}):null,color:"success",overlap:"circular",anchorOrigin:{vertical:"top",horizontal:"right"},sx:{flex:1,minWidth:0},children:(0,a.jsx)(g.$n,{selected:t.selectedMethod===e.id,onClick:()=>i({type:"SET_METHOD",payload:e.id}),size:"small",sx:{width:"100%",flexDirection:"column",py:1.5,minWidth:0,px:2},children:(0,a.jsx)(c.default,{variant:"caption",sx:{fontWeight:"bold",lineHeight:1.2,fontSize:"0.7rem",whiteSpace:"nowrap"},children:e.name})})},e.id)})})]}),"within-city"===t.selectedMethod&&(0,a.jsxs)(p.A,{spacing:3,children:[(0,a.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)(c.default,{variant:"h6",children:"Package Details"}),U&&(0,a.jsx)(y.default,{title:"Clear all fields",children:(0,a.jsx)(x.A,{size:"small",color:"error",onClick:()=>{i({type:"SET_WITHIN_CITY_FIELD",field:"fromLocation",value:null}),i({type:"SET_WITHIN_CITY_FIELD",field:"toLocation",value:null}),i({type:"SET_WITHIN_CITY_FIELD",field:"pickupDateTime",value:null})},sx:{ml:1},children:(0,a.jsx)(m.A,{fontSize:"small"})})})]}),(0,a.jsxs)(r.default,{children:[(0,a.jsx)(c.default,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Select pickup and delivery locations"}),(0,a.jsx)(T,{deliveryType:"within-city",onFromLocationSelect:e=>i({type:"SET_WITHIN_CITY_FIELD",field:"fromLocation",value:e}),onToLocationSelect:e=>i({type:"SET_WITHIN_CITY_FIELD",field:"toLocation",value:e}),initialFromLocation:t.withinCity.fromLocation||void 0,initialToLocation:t.withinCity.toLocation||void 0})]}),(0,a.jsx)(g.K7,{type:"datetime",label:"Preferred Pickup Date & Time",value:t.withinCity.pickupDateTime,onChange:e=>i({type:"SET_WITHIN_CITY_FIELD",field:"pickupDateTime",value:e}),disablePast:!0})]}),"inter-city"===t.selectedMethod&&(0,a.jsxs)(p.A,{spacing:3,children:[(0,a.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)(c.default,{variant:"h6",children:"Package Details"}),Y&&(0,a.jsx)(y.default,{title:"Clear all fields",children:(0,a.jsx)(x.A,{size:"small",color:"error",onClick:()=>{i({type:"SET_INTER_CITY_FIELD",field:"fromLocation",value:null}),i({type:"SET_INTER_CITY_FIELD",field:"toLocation",value:null}),i({type:"SET_INTER_CITY_FIELD",field:"preferredDeliveryDate",value:null})},sx:{ml:1},children:(0,a.jsx)(m.A,{fontSize:"small"})})})]}),(0,a.jsxs)(r.default,{children:[(0,a.jsx)(c.default,{variant:"subtitle2",sx:{mb:1,color:"text.secondary"},children:"Select sender and delivery locations"}),(0,a.jsx)(T,{deliveryType:"inter-city",onFromLocationSelect:e=>i({type:"SET_INTER_CITY_FIELD",field:"fromLocation",value:e}),onToLocationSelect:e=>i({type:"SET_INTER_CITY_FIELD",field:"toLocation",value:e}),initialFromLocation:t.interCity.fromLocation||void 0,initialToLocation:t.interCity.toLocation||void 0})]}),(0,a.jsx)(g.K7,{type:"datetime",label:"Preferred Delivery Date & Time",value:t.interCity.preferredDeliveryDate,onChange:e=>i({type:"SET_INTER_CITY_FIELD",field:"preferredDeliveryDate",value:e}),disablePast:!0})]}),"international"===t.selectedMethod&&(0,a.jsxs)(p.A,{spacing:3,children:[(0,a.jsxs)(r.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)(c.default,{variant:"h6",children:"Package Details"}),K&&(0,a.jsx)(y.default,{title:"Clear all fields",children:(0,a.jsx)(x.A,{size:"small",color:"error",onClick:()=>{i({type:"SET_INTERNATIONAL_FIELD",field:"pickupCountry",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"pickupCity",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"pickupAddress",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"destinationCountry",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"destinationCity",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"destinationAddress",value:""}),i({type:"SET_INTERNATIONAL_FIELD",field:"deliveryDate",value:null})},sx:{ml:1},children:(0,a.jsx)(m.A,{fontSize:"small"})})})]}),(0,a.jsx)(g.l6,{label:"Pickup Country",options:B,value:t.international.pickupCountry,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"pickupCountry",value:e}),placeholder:"Select pickup country"}),(0,a.jsx)(g.ks,{label:"Pickup City",placeholder:"Enter pickup city",value:t.international.pickupCity,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"pickupCity",value:e.target.value}),fullWidth:!0}),(0,a.jsx)(g.ks,{label:"Pickup Address",placeholder:"Enter pickup address",value:t.international.pickupAddress,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"pickupAddress",value:e.target.value}),fullWidth:!0}),(0,a.jsx)(g.l6,{label:"Destination Country",options:B,value:t.international.destinationCountry,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"destinationCountry",value:e}),placeholder:"Select destination country"}),(0,a.jsx)(g.ks,{label:"Destination City",placeholder:"Enter destination city",value:t.international.destinationCity,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"destinationCity",value:e.target.value}),fullWidth:!0}),(0,a.jsx)(g.ks,{label:"Destination Address",placeholder:"Enter destination address",value:t.international.destinationAddress,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"destinationAddress",value:e.target.value}),fullWidth:!0}),(0,a.jsx)(g.K7,{type:"datetime",label:"Preferred Delivery Date & Time",value:t.international.deliveryDate,onChange:e=>i({type:"SET_INTERNATIONAL_FIELD",field:"deliveryDate",value:e}),disablePast:!0})]}),(0,a.jsx)(r.default,{sx:{mt:4},children:q?(0,a.jsx)(g.$n,{onClick:()=>{if(q){let i=null,a=null;switch(t.selectedMethod){case"within-city":i=t.withinCity.fromLocation,a=t.withinCity.toLocation;break;case"inter-city":i=t.interCity.fromLocation,a=t.interCity.toLocation;break;case"international":i={lat:0,lng:0,address:"".concat(t.international.pickupAddress,", ").concat(t.international.pickupCity,", ").concat(t.international.pickupCountry),city:t.international.pickupCity},a={lat:0,lng:0,address:"".concat(t.international.destinationAddress,", ").concat(t.international.destinationCity,", ").concat(t.international.destinationCountry),city:t.international.destinationCity}}let n={selectedMethod:t.selectedMethod,fromLocation:i,toLocation:a};localStorage.setItem("deliveryData",JSON.stringify(n)),e.push("/package-type")}},fullWidth:!0,size:"large",children:"Next: Package Details"}):t.selectedMethod?(0,a.jsx)(r.default,{sx:{p:2,textAlign:"center",color:"text.secondary",backgroundColor:"background.paper",borderRadius:1,border:1,borderColor:"divider"},children:(0,a.jsx)(c.default,{variant:"body2",children:"within-city"===t.selectedMethod?"Fill all fields to request picker":"inter-city"===t.selectedMethod||"international"===t.selectedMethod?"Fill all fields to continue":"This delivery type is coming soon"})}):(0,a.jsx)(r.default,{sx:{p:2,textAlign:"center",color:"text.secondary",backgroundColor:"background.paper",borderRadius:1,border:1,borderColor:"divider"},children:(0,a.jsx)(c.default,{variant:"body2",children:"Choose a delivery type to continue"})})})]}),"manage"===h&&(0,a.jsx)(A,{deliveries:S,loading:w,onRefresh:O}),"incoming"===h&&(0,a.jsx)(L,{deliveries:D,loading:F,onRefresh:H})]})}),(0,a.jsx)(b.default,{unreadChatsCount:z,unreadNotificationsCount:P,activeOrdersCount:M})]})}},14140:(e,t,i)=>{"use strict";i.d(t,{j:()=>r});var a=i(23915),n=i(45404);let l=(0,a.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),r=(0,n.xI)(l)},16509:(e,t,i)=>{"use strict";i.d(t,{TJ:()=>s,_z:()=>o,createChat:()=>n,iS:()=>d,m7:()=>r,ug:()=>l});var a=i(51070);let n=async e=>a.xh.post("/chat/create",e),l=async()=>a.xh.get("/chat"),r=async e=>a.xh.get("/chat/delivery/".concat(e)),s=async e=>a.xh.get("/chat/".concat(e)),o=async(e,t)=>a.xh.post("/chat/".concat(e,"/messages"),t),d=async e=>a.xh.patch("/chat/".concat(e,"/messages/mark-read"))},21717:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});var a=i(51070);let n={getUserNotifications:async()=>(await a.xh.get("/notifications")).data,getUnreadCount:async()=>(await a.xh.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await a.xh.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await a.xh.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await a.xh.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await a.xh.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await a.xh.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await a.xh.post("/notifications/status-update",e)).data,createNotification:async e=>(await a.xh.post("/notifications/create",e)).data}},21787:(e,t,i)=>{"use strict";i.d(t,{IT:()=>s,S1:()=>u,TS:()=>f,XE:()=>o,confirmRecipient:()=>h,createDeliveryRequest:()=>l,qM:()=>c,rg:()=>p,updateDeliveryRequest:()=>d,vd:()=>n,zW:()=>r});var a=i(51070);let n=async()=>a.Bb.get("/delivery/pickers"),l=async e=>a.xh.post("/delivery/requests",e),r=async()=>a.xh.get("/delivery/requests"),s=async e=>a.xh.get("/delivery/requests/".concat(e)),o=async(e,t)=>a.xh.put("/delivery/requests/".concat(e,"/status"),{status:t}),d=async(e,t)=>a.xh.patch("/delivery/requests/".concat(e),t),c=async()=>a.xh.get("/delivery/completed"),u=async()=>a.xh.get("/delivery/cancelled"),h=async(e,t)=>a.xh.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),p=async e=>a.xh.post("/delivery/find-receiver",{email:e}),f=async()=>a.xh.get("/delivery/incoming")},27604:(e,t,i)=>{"use strict";i.d(t,{K:()=>r});var a=i(12115),n=i(21717),l=i(16509);function r(){let[e,t]=(0,a.useState)(0),[i,r]=(0,a.useState)(0),[s,o]=(0,a.useState)(0),[d,c]=(0,a.useState)(!0),u=(0,a.useCallback)(async()=>{try{let[e,i]=await Promise.all([(0,l.ug)().catch(()=>({data:[]})),n.n.getUnreadCount().catch(()=>0)]),a=e.data.reduce((e,t)=>e+(t.unreadCount||0),0);t(a),r(i),o(0)}catch(e){console.error("Failed to fetch navigation badge counts:",e)}finally{c(!1)}},[]);return(0,a.useEffect)(()=>{u()},[u]),(0,a.useEffect)(()=>{let e=setInterval(u,3e4);return()=>clearInterval(e)},[u]),(0,a.useEffect)(()=>{let e=()=>{u()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[u]),{unreadChats:e,unreadNotifications:i,activeOrders:s,isLoading:d,refresh:u}}},51070:(e,t,i)=>{"use strict";i.d(t,{Bb:()=>s,H$:()=>l,xh:()=>r,y3:()=>o});var a=i(23464),n=i(14140);let l=i(6267).Ii.isNativePlatform()?"http://10.0.2.2:4242":"http://localhost:4242",r=a.A.create({baseURL:l,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(async e=>{let t=n.j.currentUser;if(t)try{let i=await t.getIdToken();e.headers.Authorization="Bearer ".concat(i)}catch(e){}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a.A.create({baseURL:l,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function o(){try{return await a.A.get("".concat(l,"/api"),{timeout:5e3}),!0}catch(e){return!1}}s.interceptors.response.use(e=>e,e=>Promise.reject(e))},95876:(e,t,i)=>{Promise.resolve().then(i.bind(i,1081))},97704:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>y});var a=i(95155),n=i(12115),l=i(35695),r=i(18407),s=i(40541),o=i(9111),d=i(26564),c=i(11335),u=i(21888),h=i(43290),p=i(60807);let f=e=>e>99?"99+":e,y=(0,n.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:i=0,unreadNotificationsCount:y=0,userRole:x}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},v=(0,l.useRouter)(),m=(0,l.usePathname)(),[g,b]=(0,n.useState)(()=>localStorage.getItem("userRole"));(0,n.useEffect)(()=>{if(!x){let e=null;m.startsWith("/available-deliveries")?e="picker":m.startsWith("/delivery-methods")&&(e="sender"),e&&e!==g&&(b(e),localStorage.setItem("userRole",e))}},[m,x,g]);let C=x||g,j=(0,n.useMemo)(()=>m.startsWith("/delivery-methods")||m.startsWith("/orders")||m.startsWith("/available-deliveries")?0:m.startsWith("/chat")?1:m.startsWith("/notifications")?2:3*!!m.startsWith("/profile"),[m]),[T,I]=(0,n.useState)(j),E=(0,n.useCallback)((e,t)=>{switch(I(t),t){case 0:"picker"===C?v.push("/available-deliveries"):v.push("/delivery-methods");break;case 1:v.push("/chats");break;case 2:v.push("/notifications");break;case 3:v.push("/profile")}},[v,C]);return(0,a.jsx)(r.A,{className:e,sx:{position:"fixed",bottom:0,left:0,right:0,width:"100vw",zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:0,paddingRight:0,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)"},elevation:0,children:(0,a.jsxs)(s.A,{value:T,onChange:E,sx:{backgroundColor:"background.paper",width:"100%",height:"68px",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"},children:[(0,a.jsx)(o.A,{label:"Orders",icon:(0,a.jsx)(d.default,{badgeContent:f(i),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,a.jsx)(c.default,{})})}),(0,a.jsx)(o.A,{label:"Chat",icon:(0,a.jsx)(d.default,{badgeContent:f(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,a.jsx)(u.A,{})})}),(0,a.jsx)(o.A,{label:"Notifications",icon:(0,a.jsx)(d.default,{badgeContent:f(y),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,a.jsx)(h.A,{})})}),(0,a.jsx)(o.A,{label:"Profile",icon:(0,a.jsx)(p.default,{})})]})})})}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,1101,5207,8449,1190,9283,1986,7262,2649,7212,2205,8343,8441,5964,7358],()=>e(e.s=95876)),_N_E=e.O()}]);