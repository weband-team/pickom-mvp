(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2445,6509],{6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>l,TK:()=>s,op:()=>o,wz:()=>r});var i=a(51070);let r=async e=>(await i.xh.get("/user/".concat(e))).data,s=async(e,t)=>(await i.xh.put("/user/".concat(e),t)).data,l=async()=>(await i.xh.get("/auth/me")).data,n=async(e,t)=>(await i.xh.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,o=async e=>(await i.xh.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var i=a(23915),r=a(45404);let s=(0,i.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),l=(0,r.xI)(s)},16509:(e,t,a)=>{"use strict";a.d(t,{TJ:()=>n,_z:()=>o,createChat:()=>r,iS:()=>d,m7:()=>l,ug:()=>s});var i=a(51070);let r=async e=>i.xh.post("/chat/create",e),s=async()=>i.xh.get("/chat"),l=async e=>i.xh.get("/chat/delivery/".concat(e)),n=async e=>i.xh.get("/chat/".concat(e)),o=async(e,t)=>i.xh.post("/chat/".concat(e,"/messages"),t),d=async e=>i.xh.patch("/chat/".concat(e,"/messages/mark-read"))},21717:(e,t,a)=>{"use strict";a.d(t,{n:()=>r});var i=a(51070);let r={getUserNotifications:async()=>(await i.xh.get("/notifications")).data,getUnreadCount:async()=>(await i.xh.get("/notifications/unread-count")).data.count,markAsRead:async e=>(await i.xh.patch("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>{await i.xh.patch("/notifications/mark-all-read")},notifyOfferReceived:async e=>(await i.xh.post("/notifications/offer-received",e)).data,notifyOfferAccepted:async e=>(await i.xh.post("/notifications/offer-accepted",e)).data,notifyIncomingDelivery:async e=>(await i.xh.post("/notifications/incoming-delivery",e)).data,notifyStatusUpdate:async e=>(await i.xh.post("/notifications/status-update",e)).data,createNotification:async e=>(await i.xh.post("/notifications/create",e)).data}},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>n,S1:()=>u,TS:()=>p,XE:()=>o,confirmRecipient:()=>x,createDeliveryRequest:()=>s,qM:()=>c,rg:()=>h,updateDeliveryRequest:()=>d,vd:()=>r,zW:()=>l});var i=a(51070);let r=async()=>i.Bb.get("/delivery/pickers"),s=async e=>i.xh.post("/delivery/requests",e),l=async()=>i.xh.get("/delivery/requests"),n=async e=>i.xh.get("/delivery/requests/".concat(e)),o=async(e,t)=>i.xh.put("/delivery/requests/".concat(e,"/status"),{status:t}),d=async(e,t)=>i.xh.patch("/delivery/requests/".concat(e),t),c=async()=>i.xh.get("/delivery/completed"),u=async()=>i.xh.get("/delivery/cancelled"),x=async(e,t)=>i.xh.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),h=async e=>i.xh.post("/delivery/find-receiver",{email:e}),p=async()=>i.xh.get("/delivery/incoming")},27604:(e,t,a)=>{"use strict";a.d(t,{K:()=>l});var i=a(12115),r=a(21717),s=a(16509);function l(){let[e,t]=(0,i.useState)(0),[a,l]=(0,i.useState)(0),[n,o]=(0,i.useState)(0),[d,c]=(0,i.useState)(!0),u=(0,i.useCallback)(async()=>{try{let[e,a]=await Promise.all([(0,s.ug)().catch(()=>({data:[]})),r.n.getUnreadCount().catch(()=>0)]),i=e.data.reduce((e,t)=>e+(t.unreadCount||0),0);t(i),l(a),o(0)}catch(e){console.error("Failed to fetch navigation badge counts:",e)}finally{c(!1)}},[]);return(0,i.useEffect)(()=>{u()},[u]),(0,i.useEffect)(()=>{let e=setInterval(u,3e4);return()=>clearInterval(e)},[u]),(0,i.useEffect)(()=>{let e=()=>{u()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[u]),{unreadChats:e,unreadNotifications:a,activeOrders:n,isLoading:d,refresh:u}}},51070:(e,t,a)=>{"use strict";a.d(t,{Bb:()=>n,H$:()=>s,xh:()=>l,y3:()=>o});var i=a(23464),r=a(14140);let s=a(6267).Ii.isNativePlatform()?"http://10.0.2.2:4242":"http://localhost:4242",l=i.A.create({baseURL:s,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(async e=>{let t=r.j.currentUser;if(t)try{let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}catch(e){}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>Promise.reject(e));let n=i.A.create({baseURL:s,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function o(){try{return await i.A.get("".concat(s,"/api"),{timeout:5e3}),!0}catch(e){return!1}}n.interceptors.response.use(e=>e,e=>Promise.reject(e))},76921:(e,t,a)=>{Promise.resolve().then(a.bind(a,82838))},82838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>et});var i=a(95155),r=a(12115),s=a(54581),l=a(71116),n=a(48158),o=a(93874),d=a(41101),c=a(95888),u=a(78449),x=a(68534),h=a(70541),p=a(18096),f=a(14426),v=a(92302),g=a(5716),y=a(3127),m=a(31747),b=a(11414),j=a(74637),C=a(12837),w=a(11335),k=a(26886),A=a(69242),S=a(35695),T=a(43452),I=a(97704),W=a(21787),D=a(6864),P=a(21717),z=a(41218),O=a(16632),R=a(74802),E=a(74588),N=a(58674),L=a(28890);function B(e){let{isOnline:t,price:a,rating:n,onToggleOnline:o,onViewCard:c,onEdit:u}=e,[h,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{p(!0)},[]);let f=!!h&&t;return(0,i.jsx)(z.A,{sx:{mb:2,backgroundColor:"background.paper",borderLeft:4,borderColor:"divider",transition:"all 0.3s ease"},children:(0,i.jsxs)(O.A,{sx:{py:2,"&:last-child":{pb:2}},children:[(0,i.jsx)(s.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[f?(0,i.jsx)(R.default,{sx:{color:"success.main",fontSize:20}}):(0,i.jsx)(E.A,{sx:{color:"grey.500",fontSize:20}}),(0,i.jsx)(l.default,{variant:"subtitle2",fontWeight:600,children:"My Picker Card"}),(0,i.jsx)(d.A,{label:f?"Online":"Offline",size:"small",color:f?"success":"default",sx:{height:20,fontSize:"0.7rem"}})]})}),(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:2,mb:1.5},children:[(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",children:["Base price: ",(0,i.jsxs)("strong",{children:[a," zł"]})]}),(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",children:["Rating: ",(0,i.jsxs)("strong",{children:["⭐ ",n.toFixed(1)]})]})]}),(0,i.jsxs)(s.default,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[(0,i.jsx)(x.A,{variant:f?"outlined":"contained",color:"success",size:"small",onClick:o,sx:{flex:"1 1 auto",minHeight:44},children:f?"Go Offline":"Go Online"}),(0,i.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(N.A,{}),onClick:c,sx:{flex:"1 1 auto",minHeight:44},children:"View Card"}),(0,i.jsx)(x.A,{variant:"outlined",size:"small",startIcon:(0,i.jsx)(L.A,{}),onClick:u,sx:{flex:"0 1 auto",minHeight:44,minWidth:44,px:1},children:"Edit"})]})]})})}var M=a(72705),H=a(58343),F=a(66518);let _=()=>(0,i.jsx)(s.default,{sx:{width:40,height:4,backgroundColor:"action.disabled",borderRadius:2,position:"absolute",top:8,left:"calc(50% - 20px)"}});function q(e){let{open:t,onClose:a,onEdit:n,picker:o}=e,[d,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{c(document.querySelector("[data-mobile-container]"))},[]),(0,i.jsxs)(g.A,{anchor:"bottom",open:t,onClose:a,onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,container:d,ModalProps:{keepMounted:!1},PaperProps:{sx:{maxHeight:"90vh",width:"100vw",borderTopLeftRadius:24,borderTopRightRadius:24,backgroundColor:"background.paper",paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}},children:[(0,i.jsx)(_,{}),(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:1},children:[(0,i.jsx)(l.default,{variant:"h6",sx:{fontWeight:600},children:"My Picker Card Preview"}),(0,i.jsx)(y.A,{onClick:a,size:"small",children:(0,i.jsx)(A.A,{})})]}),(0,i.jsxs)(s.default,{sx:{px:3,pb:2,overflowY:"auto"},children:[(0,i.jsx)(s.default,{sx:F.de.base,children:(0,i.jsxs)(M.A,{direction:"row",spacing:2,alignItems:"flex-start",children:[(0,i.jsx)(H.H8,{type:"picker",name:o.fullName,src:o.avatarUrl,online:o.isOnline}),(0,i.jsxs)(s.default,{sx:{flex:1,minWidth:0},children:[(0,i.jsxs)(M.A,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[(0,i.jsx)(l.default,{variant:"subtitle2",sx:{fontWeight:"bold"},children:o.fullName}),o.isVerified&&(0,i.jsx)(H.wl,{type:"verified",verified:!0,size:"small",showLabel:!1})]}),(0,i.jsx)(H.Gk,{value:o.rating,readOnly:!0,size:"small",showValue:!0}),(0,i.jsx)(l.default,{variant:"body2",color:"text.secondary",sx:{mt:.5,mb:1},children:o.description}),(0,i.jsxs)(s.default,{sx:{display:"flex",gap:.5,mb:2,alignItems:"center"},children:[o.isPhoneVerified&&(0,i.jsx)(s.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(H.wl,{type:"phone",verified:!0,size:"small",showLabel:!1})}),o.isEmailVerified&&(0,i.jsx)(s.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(H.wl,{type:"email",verified:!0,size:"small",showLabel:!1})}),(0,i.jsx)(s.default,{sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(H.wl,{type:"delivery",verified:!0,value:o.deliveryCount,size:"small",showLabel:!1})})]}),(0,i.jsx)(M.A,{direction:"row",justifyContent:"space-between",alignItems:"center",children:(0,i.jsxs)(s.default,{children:[(0,i.jsxs)(l.default,{variant:"h6",sx:{fontWeight:"bold",color:F.w4.colors.primary},children:[o.price," zł"]}),(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",children:[o.duration," min"]})]})})]})]})}),(0,i.jsx)(l.default,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:2,textAlign:"center",fontStyle:"italic"},children:"This is how senders see your card"})]}),(0,i.jsxs)(s.default,{sx:{px:3,py:2,borderTop:1,borderColor:"divider",display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:a,variant:"outlined",fullWidth:!0,children:"Close"}),(0,i.jsx)(x.A,{onClick:n,variant:"contained",fullWidth:!0,children:"Edit Card"})]})]})}var U=a(27088),V=a(17348),Y=a(79892),J=a(77894);let K={price:50,vehicle:"car",workArea:"City Center",bio:"Fast and reliable delivery service",isOnline:!1},$=()=>{let e=localStorage.getItem("pickerCardSettings");return e?{...K,...JSON.parse(e)}:K},G=e=>{let t={...$(),...e};localStorage.setItem("pickerCardSettings",JSON.stringify(t))},X=()=>(0,i.jsx)(s.default,{sx:{width:40,height:4,backgroundColor:"action.disabled",borderRadius:2,position:"absolute",top:8,left:"calc(50% - 20px)"}});function Z(e){let{open:t,onClose:a,onSave:n,initialSettings:o}=e,[d,c]=(0,r.useState)(null),[h,p]=(0,r.useState)(o.price),[f,v]=(0,r.useState)(o.vehicle),[m,b]=(0,r.useState)(o.workArea),[j,C]=(0,r.useState)(o.bio),[w,k]=(0,r.useState)({});(0,r.useEffect)(()=>{c(document.querySelector("[data-mobile-container]"))},[]);let S=()=>{p(o.price),v(o.vehicle),b(o.workArea),C(o.bio),k({}),a()};return(0,i.jsxs)(g.A,{anchor:"bottom",open:t,onClose:S,onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,container:d,ModalProps:{keepMounted:!1},PaperProps:{sx:{maxHeight:"90vh",width:"100vw",borderTopLeftRadius:24,borderTopRightRadius:24,backgroundColor:"background.paper",paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}},children:[(0,i.jsx)(X,{}),(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:1},children:[(0,i.jsx)(l.default,{variant:"h6",sx:{fontWeight:600},children:"Edit Picker Card"}),(0,i.jsx)(y.A,{onClick:S,size:"small",children:(0,i.jsx)(A.A,{})})]}),(0,i.jsx)(s.default,{sx:{px:3,pb:2,overflowY:"auto"},children:(0,i.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",gap:2.5,py:1},children:[(0,i.jsx)(u.default,{label:"Base Price (zł)",type:"number",value:h,onChange:e=>p(Number(e.target.value)),error:!!w.price,helperText:w.price||"Your base delivery price",fullWidth:!0,inputProps:{min:1,max:1e3}}),(0,i.jsxs)(U.A,{fullWidth:!0,children:[(0,i.jsx)(V.A,{children:"Vehicle Type"}),(0,i.jsxs)(Y.A,{value:f,label:"Vehicle Type",onChange:e=>v(e.target.value),children:[(0,i.jsx)(J.A,{value:"car",children:"\uD83D\uDE97 Car"}),(0,i.jsx)(J.A,{value:"bike",children:"\uD83D\uDEB4 Bike"}),(0,i.jsx)(J.A,{value:"scooter",children:"\uD83D\uDEF4 Scooter"}),(0,i.jsx)(J.A,{value:"walking",children:"\uD83D\uDEB6 Walking"})]})]}),(0,i.jsx)(u.default,{label:"Work Area/Zone",value:m,onChange:e=>b(e.target.value),fullWidth:!0,helperText:"E.g., City Center, Downtown, etc."}),(0,i.jsx)(u.default,{label:"Bio/Description",value:j,onChange:e=>C(e.target.value),multiline:!0,rows:4,fullWidth:!0,error:!!w.bio,helperText:w.bio||"".concat(j.length,"/200 characters"),inputProps:{maxLength:200}})]})}),(0,i.jsxs)(s.default,{sx:{px:3,py:2,borderTop:1,borderColor:"divider",display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:S,variant:"outlined",fullWidth:!0,children:"Cancel"}),(0,i.jsx)(x.A,{onClick:()=>{if(!(()=>{let e={};return(h<=0||h>1e3)&&(e.price="Price must be between 1 and 1000 zł"),j.length>200&&(e.bio="Bio must be 200 characters or less"),k(e),0===Object.keys(e).length})())return;let e={price:h,vehicle:f,workArea:m,bio:j,isOnline:o.isOnline};G(e),n(e),a()},variant:"contained",fullWidth:!0,children:"Save Changes"})]})]})}var Q=a(27604),ee=a(98226);function et(){var e,t;let z=(0,S.useRouter)(),{unreadChats:O,unreadNotifications:R}=(0,Q.K)(),[E,N]=(0,r.useState)([]),[L,M]=(0,r.useState)(!0),[H,F]=(0,r.useState)(""),[_,U]=(0,r.useState)("available"),[V,Y]=(0,r.useState)(""),[J,K]=(0,r.useState)([]),[X,et]=(0,r.useState)(!1),[ea,ei]=(0,r.useState)(()=>{{let e=localStorage.getItem("pickerPlannedTrips");return e?JSON.parse(e):[]}}),[er,es]=(0,r.useState)({fromCity:"",toCity:"",departureDateTime:"",arrivalDateTime:""}),[el,en]=(0,r.useState)(()=>$()),[eo,ed]=(0,r.useState)(!1),[ec,eu]=(0,r.useState)(!1),[ex,eh]=(0,r.useState)(!1),[ep,ef]=(0,r.useState)(null),[ev,eg]=(0,r.useState)(0),[ey,em]=(0,r.useState)(""),[eb,ej]=(0,r.useState)(!1),eC={id:"current-user",fullName:"John Doe",email:"john@example.com",avatarUrl:"",rating:4.7,isVerified:!0,isOnline:el.isOnline,isPhoneVerified:!0,isEmailVerified:!0,price:el.price,duration:30,trustLevel:85,reviewCount:42,distance:0,vehicle:el.vehicle,completedDeliveries:127,deliveryCount:127,description:el.bio,age:19,country:"Poland",city:"Warsaw",userType:ee.u.PICKER};(0,r.useEffect)(()=>{(async()=>{try{let{user:e}=await (0,D.HW)();Y(e.uid);let t=el.isOnline;e.isOnline!==t&&await (0,D.$H)(e.uid,t)}catch(e){}})()},[]),(0,r.useEffect)(()=>{(async()=>{M(!0),F("");try{let e=await (0,W.zW)();N(e.data)}catch(e){F("Failed to load delivery requests. Please try again.")}finally{M(!1)}})()},[]),(0,r.useEffect)(()=>{"invitations"===_&&ew()},[_]);let ew=async()=>{et(!0);try{let e=(await P.n.getUserNotifications()).filter(e=>"new_delivery"===e.type&&e.related_delivery_id),t=(await Promise.all(e.map(async e=>{try{return(await (0,W.IT)(e.related_delivery_id)).data}catch(e){return null}}))).filter(e=>null!==e&&"pending"===e.status);K(t)}catch(e){}finally{et(!1)}},ek=(0,r.useMemo)(()=>E.filter(e=>"pending"===e.status),[E]),eA=(0,r.useMemo)(()=>E.filter(e=>"accepted"===e.status||"picked_up"===e.status),[E]),eS=(0,r.useMemo)(()=>E.filter(e=>"delivered"===e.status||"cancelled"===e.status),[E]),eT=(0,r.useMemo)(()=>{switch(_){case"available":default:return ek;case"active":return eA;case"history":return eS;case"invitations":return J}},[_,ek,eA,eS,J]),eI=async()=>{if(!ep||ev<=0)return void alert("Please enter a valid price");ej(!0);try{let{createOffer:e}=await a.e(8780).then(a.bind(a,78780));await e({deliveryId:ep.id,price:ev,message:ey||void 0}),alert("Offer submitted successfully!"),eh(!1),ef(null)}catch(a){var e,t;alert((null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to create offer. Please try again.")}finally{ej(!1)}},eW=async()=>{let e=(()=>{let e=!$().isOnline;return G({isOnline:e}),e})();if(en($()),V)try{await (0,D.$H)(V,e)}catch(e){}},eD=e=>t=>{es(a=>({...a,[e]:t.target.value}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T.MobileContainer,{showFrame:!1,children:(0,i.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,i.jsx)(s.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:1,borderColor:"divider"},children:(0,i.jsx)(l.default,{variant:"h5",sx:{fontWeight:600,fontSize:"1.5rem"},children:"Delivery Requests"})}),(0,i.jsx)(s.default,{sx:{px:2,pt:2},children:(0,i.jsx)(B,{isOnline:el.isOnline,price:el.price,rating:eC.rating,onToggleOnline:eW,onViewCard:()=>{ed(!0)},onEdit:()=>{eu(!0)}})}),(0,i.jsxs)(n.A,{sx:{boxShadow:"none",borderBottom:1,borderColor:"divider"},children:[(0,i.jsx)(o.A,{expandIcon:(0,i.jsx)(m.A,{}),sx:{backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)(b.A,{color:"primary"}),(0,i.jsx)(l.default,{variant:"subtitle1",sx:{fontWeight:600},children:"Plan a Trip"}),ea.length>0&&(0,i.jsx)(d.A,{label:ea.length,size:"small",color:"primary",sx:{height:20,fontSize:"0.75rem"}})]})}),(0,i.jsx)(c.A,{sx:{p:2},children:(0,i.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsx)(u.default,{label:"From City",value:er.fromCity,onChange:eD("fromCity"),size:"small",fullWidth:!0}),(0,i.jsx)(u.default,{label:"To City",value:er.toCity,onChange:eD("toCity"),size:"small",fullWidth:!0}),(0,i.jsx)(u.default,{label:"Departure Date & Time",type:"datetime-local",value:er.departureDateTime,onChange:eD("departureDateTime"),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0}}),(0,i.jsx)(u.default,{label:"Arrival Date & Time",type:"datetime-local",value:er.arrivalDateTime,onChange:eD("arrivalDateTime"),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0}}),(0,i.jsx)(x.A,{variant:"contained",startIcon:(0,i.jsx)(j.A,{}),onClick:()=>{if(!er.fromCity||!er.toCity||!er.departureDateTime||!er.arrivalDateTime)return;let e=[...ea,{id:Date.now().toString(),fromCity:er.fromCity,toCity:er.toCity,departureDateTime:er.departureDateTime,arrivalDateTime:er.arrivalDateTime,createdAt:new Date().toISOString()}];ei(e),localStorage.setItem("pickerPlannedTrips",JSON.stringify(e)),es({fromCity:"",toCity:"",departureDateTime:"",arrivalDateTime:""})},disabled:!er.fromCity||!er.toCity||!er.departureDateTime||!er.arrivalDateTime,sx:{textTransform:"none"},children:"Add Trip"}),ea.length>0&&(0,i.jsxs)(s.default,{sx:{mt:2},children:[(0,i.jsxs)(l.default,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:["Planned Trips (",ea.length,")"]}),ea.map(e=>(0,i.jsx)(s.default,{sx:{p:1.5,mb:1,borderRadius:1,backgroundColor:"background.default",border:1,borderColor:"divider"},children:(0,i.jsxs)(s.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)(s.default,{sx:{flex:1},children:[(0,i.jsxs)(l.default,{variant:"body2",sx:{fontWeight:600},children:[e.fromCity," → ",e.toCity]}),(0,i.jsxs)(l.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Depart: ",new Date(e.departureDateTime).toLocaleString("en-US")]}),(0,i.jsxs)(l.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["Arrive: ",new Date(e.arrivalDateTime).toLocaleString("en-US")]})]}),(0,i.jsx)(x.A,{size:"small",color:"error",onClick:()=>(e=>{let t=ea.filter(t=>t.id!==e);ei(t),localStorage.setItem("pickerPlannedTrips",JSON.stringify(t))})(e.id),sx:{textTransform:"none",minWidth:"auto"},children:"Delete"})]})},e.id))]})]})})]}),(0,i.jsxs)(h.A,{value:_,onChange:(e,t)=>{U(t)},variant:"scrollable",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider",minHeight:56,px:2,"& .MuiTabs-flexContainer":{pl:0},"& .MuiTabs-scroller":{ml:0},"& .MuiTab-root":{minHeight:56,fontSize:"0.75rem",fontWeight:500,textTransform:"none",minWidth:80,px:1.5,"&:first-of-type":{pl:0}}},children:[(0,i.jsx)(p.A,{label:"Available (".concat(ek.length,")"),value:"available"}),(0,i.jsx)(p.A,{label:(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,i.jsx)(C.A,{sx:{fontSize:16}}),"Invitations (",J.length,")"]}),value:"invitations"}),(0,i.jsx)(p.A,{label:"Active (".concat(eA.length,")"),value:"active"}),(0,i.jsx)(p.A,{label:"History (".concat(eS.length,")"),value:"history"})]}),(0,i.jsx)(s.default,{sx:{flex:1,overflow:"auto",pb:8},children:L||"invitations"===_&&X?(0,i.jsx)(s.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:8},children:(0,i.jsx)(f.default,{})}):H?(0,i.jsx)(s.default,{sx:{p:3},children:(0,i.jsx)(v.A,{severity:"error",children:H})}):0===eT.length?(0,i.jsxs)(s.default,{sx:{p:3,textAlign:"center",py:8},children:["invitations"===_?(0,i.jsx)(C.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}):(0,i.jsx)(w.default,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,i.jsxs)(l.default,{variant:"h6",sx:{mb:1,fontWeight:600},children:["available"===_&&"No available deliveries","active"===_&&"No active deliveries","history"===_&&"No delivery history","invitations"===_&&"No invitations"]}),(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",children:["available"===_&&"Check back later for new delivery requests","active"===_&&"Accepted deliveries will appear here","history"===_&&"Your completed and cancelled deliveries will appear here","invitations"===_&&"Senders will invite you to deliver their packages"]})]}):(0,i.jsx)(s.default,{sx:{p:2},children:eT.map(e=>{var t,a;return(0,i.jsxs)(s.default,{onClick:()=>{var t;return t=e.id,void z.push("/delivery-details/".concat(t))},sx:{p:2,mb:2,borderRadius:2,backgroundColor:"background.paper",border:1,borderColor:"divider",cursor:"pointer",transition:"all 0.2s","&:hover":{boxShadow:2,borderColor:"primary.main"}},children:[(0,i.jsxs)(s.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,i.jsxs)(l.default,{variant:"subtitle2",sx:{fontWeight:600},children:["Delivery #",e.id]}),e.deliveryType&&(0,i.jsx)(d.A,{label:"within-city"===e.deliveryType?"Within City":"Inter-City",size:"small",color:"within-city"===e.deliveryType?"primary":"warning",icon:"within-city"===e.deliveryType?(0,i.jsx)(k.A,{sx:{fontSize:14}}):(0,i.jsx)(b.A,{sx:{fontSize:14}}),sx:{height:20,fontSize:"0.7rem"}})]}),(0,i.jsx)(d.A,{label:(e=>{switch(e){case"pending":return"Pending";case"accepted":return"Accepted";case"picked_up":return"In Transit";case"delivered":return"Delivered";case"cancelled":return"Cancelled";default:return e}})(e.status),size:"small",color:(e=>{switch(e){case"pending":return"warning";case"accepted":return"info";case"picked_up":return"primary";case"delivered":return"success";case"cancelled":return"error";default:return"default"}})(e.status),sx:{height:20,fontSize:"0.75rem"}})]}),(0,i.jsxs)(s.default,{sx:{mb:1},children:[(0,i.jsx)(l.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:"From"}),(0,i.jsx)(l.default,{variant:"body2",sx:{fontWeight:500},children:null==(t=e.fromLocation)?void 0:t.address})]}),(0,i.jsxs)(s.default,{sx:{mb:1},children:[(0,i.jsx)(l.default,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:"To"}),(0,i.jsx)(l.default,{variant:"body2",sx:{fontWeight:500},children:null==(a=e.toLocation)?void 0:a.address})]}),(0,i.jsxs)(s.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[(0,i.jsxs)(l.default,{variant:"h6",sx:{color:"primary.main",fontWeight:"bold"},children:[Number(e.price||0).toFixed(2)," zl"]}),(0,i.jsx)(l.default,{variant:"caption",color:"text.secondary",children:new Date(e.createdAt).toLocaleDateString("en-US")})]}),"available"===_&&(0,i.jsx)(x.A,{variant:"contained",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),ef(e),eg(Number(e.price)||0),em(""),eh(!0)},children:"Make Offer"}),"invitations"===_&&(0,i.jsx)(x.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Invitation"}),"active"===_&&(0,i.jsx)(x.A,{variant:"contained",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Details"}),"history"===_&&(0,i.jsx)(x.A,{variant:"outlined",fullWidth:!0,sx:{mt:2},onClick:t=>{t.stopPropagation(),z.push("/delivery-details/".concat(e.id))},children:"View Details"})]},e.id)})})})]})}),(0,i.jsx)(I.default,{unreadChatsCount:O,unreadNotificationsCount:R}),(0,i.jsx)(q,{open:eo,onClose:()=>ed(!1),onEdit:()=>{ed(!1),eu(!0)},picker:eC}),(0,i.jsx)(Z,{open:ec,onClose:()=>eu(!1),onSave:e=>{en(e),eu(!1)},initialSettings:el}),(0,i.jsxs)(g.A,{anchor:"bottom",open:ex,onClose:()=>!eb&&eh(!1),onOpen:()=>{},disableSwipeToOpen:!0,disablePortal:!0,PaperProps:{sx:{maxHeight:"90vh",width:"100vw",borderTopLeftRadius:24,borderTopRightRadius:24,backgroundColor:"background.paper",paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}},children:[(0,i.jsx)(s.default,{sx:{width:40,height:4,backgroundColor:"action.disabled",borderRadius:2,position:"absolute",top:8,left:"calc(50% - 20px)"}}),(0,i.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,pt:3,pb:2},children:[(0,i.jsx)(l.default,{variant:"h6",sx:{fontWeight:600},children:"Make an Offer"}),(0,i.jsx)(y.A,{onClick:()=>eh(!1),size:"small",disabled:eb,children:(0,i.jsx)(A.A,{})})]}),(0,i.jsx)(s.default,{sx:{px:3,pb:3},children:ep&&(0,i.jsxs)(s.default,{children:[(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["From: ",null==(e=ep.toLocation)?void 0:e.address]}),(0,i.jsxs)(l.default,{variant:"body2",color:"text.secondary",sx:{mb:3},children:["To: ",null==(t=ep.toLocation)?void 0:t.address]}),(0,i.jsx)(u.default,{label:"Your Price (zł)",type:"number",fullWidth:!0,value:ev,onChange:e=>eg(Number(e.target.value)),sx:{mb:2},inputProps:{min:0,step:.01},disabled:eb}),(0,i.jsx)(u.default,{label:"Message (optional)",multiline:!0,rows:3,fullWidth:!0,value:ey,onChange:e=>em(e.target.value),placeholder:"Add a message to the sender...",disabled:eb,sx:{mb:3}}),(0,i.jsxs)(s.default,{sx:{display:"flex",gap:2},children:[(0,i.jsx)(x.A,{onClick:()=>eh(!1),disabled:eb,variant:"outlined",fullWidth:!0,children:"Cancel"}),(0,i.jsx)(x.A,{onClick:eI,variant:"contained",disabled:eb||ev<=0,fullWidth:!0,children:eb?"Submitting...":"Submit Offer"})]})]})})]})]})}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var i=a(95155),r=a(12115),s=a(35695),l=a(18407),n=a(40541),o=a(9111),d=a(26564),c=a(11335),u=a(21888),x=a(43290),h=a(60807);let p=e=>e>99?"99+":e,f=(0,r.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:f=0,userRole:v}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=(0,s.useRouter)(),y=(0,s.usePathname)(),[m,b]=(0,r.useState)(()=>localStorage.getItem("userRole"));(0,r.useEffect)(()=>{if(!v){let e=null;y.startsWith("/available-deliveries")?e="picker":y.startsWith("/delivery-methods")&&(e="sender"),e&&e!==m&&(b(e),localStorage.setItem("userRole",e))}},[y,v,m]);let j=v||m,C=(0,r.useMemo)(()=>y.startsWith("/delivery-methods")||y.startsWith("/orders")||y.startsWith("/available-deliveries")?0:y.startsWith("/chat")?1:y.startsWith("/notifications")?2:3*!!y.startsWith("/profile"),[y]),[w,k]=(0,r.useState)(C),A=(0,r.useCallback)((e,t)=>{switch(k(t),t){case 0:"picker"===j?g.push("/available-deliveries"):g.push("/delivery-methods");break;case 1:g.push("/chats");break;case 2:g.push("/notifications");break;case 3:g.push("/profile")}},[g,j]);return(0,i.jsx)(l.A,{className:e,sx:{position:"fixed",bottom:0,left:0,right:0,width:"100vw",zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:0,paddingRight:0,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)"},elevation:0,children:(0,i.jsxs)(n.A,{value:w,onChange:A,sx:{backgroundColor:"background.paper",width:"100%",height:"68px",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"},children:[(0,i.jsx)(o.A,{label:"Orders",icon:(0,i.jsx)(d.default,{badgeContent:p(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(c.default,{})})}),(0,i.jsx)(o.A,{label:"Chat",icon:(0,i.jsx)(d.default,{badgeContent:p(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(u.A,{})})}),(0,i.jsx)(o.A,{label:"Notifications",icon:(0,i.jsx)(d.default,{badgeContent:p(f),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,i.jsx)(x.A,{})})}),(0,i.jsx)(o.A,{label:"Profile",icon:(0,i.jsx)(h.default,{})})]})})})},98226:(e,t,a)=>{"use strict";a.d(t,{u:()=>i,y:()=>r});var i=function(e){return e.SENDER="sender",e.PICKER="picker",e}({}),r=function(e){return e.WITHIN_CITY="within_city",e.INTER_CITY="inter_city",e.INTERNATIONAL="international",e.COMBINED="combined",e}({})}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,1101,5207,8449,1190,9283,1986,7262,2649,7212,5394,1274,9146,8343,8441,5964,7358],()=>e(e.s=76921)),_N_E=e.O()}]);