(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2454],{14140:(e,r,a)=>{"use strict";a.d(r,{j:()=>i});var t=a(23915),s=a(45404);let l=(0,t.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),i=(0,s.xI)(l)},19710:(e,r,a)=>{Promise.resolve().then(a.bind(a,31851))},28069:(e,r,a)=>{"use strict";a.d(r,{Nq:()=>n,c4:()=>l,mH:()=>o,mg:()=>i,vx:()=>d});var t=a(51070),s=a(14140);let l=async()=>{let e=s.j.currentUser;return e?await e.getIdToken():null},i=async e=>t.Bb.post("/auth/login",{},{headers:{Authorization:"Bearer ".concat(e)}}),o=async(e,r,a,s)=>t.Bb.post("/auth/register",{role:e,phone:a,name:s},{headers:{Authorization:"Bearer ".concat(r)}}),n=async()=>t.xh.get("/auth/me"),d=async()=>t.xh.post("/auth/logout")},31851:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>v});var t=a(95155),s=a(12115),l=a(35695),i=a(54581),o=a(71116),n=a(92302),d=a(72705),u=a(58343),c=a(98226),p=a(6874),h=a.n(p),y=a(41819),m=a(45404),f=a(14140),b=a(28069);let g={step:"userData",selectedUserType:null,userData:{},pickerData:{},password:"",confirmPassword:"",errors:{}};function x(e,r){switch(r.type){case"UPDATE_USER_DATA":return{...e,userData:{...e.userData,...r.payload}};case"UPDATE_PICKER_DATA":return{...e,pickerData:{...e.pickerData,...r.payload}};case"UPDATE_PASSWORD":return{...e,password:r.payload};case"UPDATE_CONFIRM_PASSWORD":return{...e,confirmPassword:r.payload};case"SET_ERRORS":return{...e,errors:{...e.errors,...r.payload}};case"CLEAR_ERROR":return{...e,errors:{...e.errors,[r.payload]:void 0}};case"SET_USER_TYPE":return{...e,selectedUserType:r.payload};case"NEXT_STEP":if("userData"===e.step&&e.selectedUserType===c.u.PICKER)return{...e,step:"pickerData"};return e;case"PREV_STEP":if("pickerData"===e.step)return{...e,step:"userData"};return e;default:return e}}function v(){let[e,r]=(0,s.useReducer)(x,g),[a,p]=(0,s.useState)(!1),[v,D]=(0,s.useState)(""),T=(0,l.useRouter)();(0,s.useEffect)(()=>{let e=sessionStorage.getItem("selectedUserType");if(!e)return void T.push("/user-type");r({type:"SET_USER_TYPE",payload:e})},[T]);let P=(a,t)=>{let s,l=String(t);switch(a){case"fullName":s=(0,y.Tl)(l);break;case"email":s=(0,y.DT)(l);break;case"age":s=(0,y.Gn)(Number(t));break;case"country":s=(0,y.Lo)(l);break;case"city":s=(0,y.Y$)(l);break;case"phoneNumber":s=(0,y.Q7)(l);break;case"password":s=(0,y.Oj)(l);break;case"confirmPassword":s=(0,y.nY)(e.password,l);break;default:return}s.isValid?r({type:"CLEAR_ERROR",payload:a}):r({type:"SET_ERRORS",payload:{[a]:s.error}})},k=e=>a=>{let t="age"===e?parseInt(a.target.value)||0:a.target.value;r({type:"UPDATE_USER_DATA",payload:{[e]:t}}),P(e,a.target.value)},E=e=>a=>{let t=a.target.value;"password"===e?r({type:"UPDATE_PASSWORD",payload:t}):r({type:"UPDATE_CONFIRM_PASSWORD",payload:t}),P(e,t)},j=async()=>{let a={fullName:(0,y.Tl)(e.userData.fullName||""),email:(0,y.DT)(e.userData.email||""),age:(0,y.Gn)(e.userData.age||0),country:(0,y.Lo)(e.userData.country||""),city:(0,y.Y$)(e.userData.city||""),phoneNumber:(0,y.Q7)(e.userData.phoneNumber||""),password:(0,y.Oj)(e.password),confirmPassword:(0,y.nY)(e.password,e.confirmPassword)},t={},s=!1;if(Object.entries(a).forEach(e=>{let[r,a]=e;a.isValid||(t[r]=a.error,s=!0)}),s)return void r({type:"SET_ERRORS",payload:t});p(!0),D("");try{let r=await (0,m.eJ)(f.j,e.userData.email,e.password),a=await r.user.getIdToken(),t=e.selectedUserType===c.u.PICKER?"picker":"sender";await (0,b.mH)(t,a,e.userData.phoneNumber,e.userData.fullName),"picker"===t?T.push("/available-deliveries"):T.push("/delivery-methods")}catch(r){let e="Registration failed. Please try again.";if(r&&"object"==typeof r&&"code"in r)"auth/email-already-in-use"===r.code?e="This email is already registered. Please sign in instead.":"auth/weak-password"===r.code?e="Password is too weak. Please use a stronger password.":"auth/invalid-email"===r.code&&(e="Invalid email address.");else{var l,i;(null==(i=r.response)||null==(l=i.data)?void 0:l.message)&&(e=r.response.data.message)}D(e)}finally{p(!1)}},w=()=>{let{fullName:r,email:a,age:t,country:s,city:l}=e.userData;return r&&a&&t&&s&&l&&e.password&&e.confirmPassword},A=e.selectedUserType;return(0,t.jsx)(i.default,{sx:{minHeight:"100vh",bgcolor:"background.default",display:"flex",alignItems:"center",justifyContent:"center",p:2},children:(0,t.jsx)(u.kc,{showFrame:!1,children:(0,t.jsxs)(i.default,{sx:{p:3},children:[(0,t.jsxs)(i.default,{sx:{textAlign:"center",mb:4},children:[(0,t.jsx)(u.Lm,{variant:"full",size:"large"}),(0,t.jsx)(o.default,{variant:"h4",sx:{fontWeight:"bold",mt:2,mb:1},children:"Create Account"}),(0,t.jsxs)(o.default,{variant:"body1",color:"text.secondary",children:[A===c.u.SENDER?"\uD83D\uDCE6 Sender":"\uD83D\uDE80 Picker"," Registration"]})]}),v&&(0,t.jsx)(n.A,{severity:"error",sx:{mb:3},children:v}),"userData"===e.step&&(0,t.jsxs)(d.A,{spacing:3,children:[(0,t.jsx)(i.default,{sx:{textAlign:"center",mb:2},children:(0,t.jsx)(o.default,{variant:"h6",sx:{fontWeight:"bold"},children:"Tell us about yourself"})}),(0,t.jsx)(u.ks,{label:"Full Name",value:e.userData.fullName||"",onChange:k("fullName"),error:!!e.errors.fullName,helperText:e.errors.fullName,fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"Email",type:"email",value:e.userData.email||"",onChange:k("email"),error:!!e.errors.email,helperText:e.errors.email,fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"Age",type:"number",value:e.userData.age||"",onChange:k("age"),error:!!e.errors.age,helperText:e.errors.age,fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"Country",value:e.userData.country||"",onChange:k("country"),error:!!e.errors.country,helperText:e.errors.country,fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"City",value:e.userData.city||"",onChange:k("city"),error:!!e.errors.city,helperText:e.errors.city,fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"Phone Number (Optional)",placeholder:"e.g., +1234567890",value:e.userData.phoneNumber||"",onChange:k("phoneNumber"),error:!!e.errors.phoneNumber,helperText:e.errors.phoneNumber||"International format with country code",fullWidth:!0}),(0,t.jsx)(u.ks,{label:"Password",type:"password",value:e.password,onChange:E("password"),error:!!e.errors.password,helperText:e.errors.password||"Minimum 8 characters with letters and numbers",fullWidth:!0,required:!0}),(0,t.jsx)(u.ks,{label:"Confirm Password",type:"password",value:e.confirmPassword,onChange:E("confirmPassword"),error:!!e.errors.confirmPassword,helperText:e.errors.confirmPassword,fullWidth:!0,required:!0}),(0,t.jsxs)(d.A,{direction:"row",spacing:2,sx:{mt:3},children:[(0,t.jsx)(u.$n,{variant:"outlined",onClick:()=>T.push("/user-type"),fullWidth:!0,children:"Back"}),A===c.u.SENDER?(0,t.jsx)(u.$n,{onClick:j,disabled:!w()||Object.values(e.errors).some(e=>!!e)||a,fullWidth:!0,children:a?"Creating Account...":"Create Account"}):(0,t.jsx)(u.$n,{onClick:()=>r({type:"NEXT_STEP"}),disabled:!w()||Object.values(e.errors).some(e=>!!e)||a,fullWidth:!0,children:"Next"})]})]}),"pickerData"===e.step&&A===c.u.PICKER&&(0,t.jsxs)(d.A,{spacing:3,children:[(0,t.jsxs)(i.default,{sx:{textAlign:"center",mb:2},children:[(0,t.jsx)(o.default,{variant:"h6",sx:{fontWeight:"bold"},children:"\uD83D\uDE80 Picker Details"}),(0,t.jsx)(o.default,{variant:"body2",color:"text.secondary",children:"Tell us about your delivery preferences"})]}),(0,t.jsxs)(i.default,{children:[(0,t.jsx)(o.default,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold"},children:"Delivery Methods (Select all that apply):"}),(0,t.jsx)(d.A,{spacing:1,children:Object.values(c.y).map(a=>{var s;return(0,t.jsx)(u.$n,{variant:(null==(s=e.pickerData.deliveryMethods)?void 0:s.includes(a))?"contained":"outlined",onClick:()=>{let t=e.pickerData.deliveryMethods||[];r({type:"UPDATE_PICKER_DATA",payload:{deliveryMethods:t.includes(a)?t.filter(e=>e!==a):[...t,a]}})},fullWidth:!0,children:a.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())},a)})})]}),(0,t.jsx)(u.l6,{label:"Vehicle Type",value:e.pickerData.vehicleType||"",onChange:e=>r({type:"UPDATE_PICKER_DATA",payload:{vehicleType:e}}),options:[{value:"car",label:"\uD83D\uDE97 Car"},{value:"bike",label:"\uD83C\uDFCDï¸ Bike"},{value:"walking",label:"\uD83D\uDEB6 Walking"},{value:"public_transport",label:"\uD83D\uDE8C Public Transport"}],fullWidth:!0}),(0,t.jsx)(u.ks,{label:"Bio (Optional)",value:e.pickerData.bio||"",onChange:e=>r({type:"UPDATE_PICKER_DATA",payload:{bio:e.target.value}}),multiline:!0,rows:3,fullWidth:!0,placeholder:"Tell senders about yourself and your delivery experience..."}),(0,t.jsxs)(d.A,{direction:"row",spacing:2,sx:{mt:3},children:[(0,t.jsx)(u.$n,{variant:"outlined",onClick:()=>r({type:"PREV_STEP"}),fullWidth:!0,children:"Back"}),(0,t.jsx)(u.$n,{onClick:j,disabled:!(e.pickerData.deliveryMethods&&e.pickerData.deliveryMethods.length>0)||a,fullWidth:!0,children:a?"Creating Account...":"Create Account"})]})]}),(0,t.jsxs)(i.default,{sx:{mt:3,textAlign:"center"},children:[(0,t.jsx)(o.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Already have an account?"}),(0,t.jsx)(h(),{href:"/",passHref:!0,children:(0,t.jsx)(u.$n,{variant:"outlined",fullWidth:!0,children:"Sign In"})})]})]})})})}},41819:(e,r,a)=>{"use strict";a.d(r,{DT:()=>t,Gn:()=>l,Lo:()=>n,Oj:()=>s,Q7:()=>o,Tl:()=>i,Y$:()=>d,nY:()=>u});let t=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0}:{isValid:!1,error:"Please enter a valid email address"}:{isValid:!1,error:"Email is required"},s=e=>{if(!e)return{isValid:!1,error:"Password is required"};if(e.length<8)return{isValid:!1,error:"Password must be at least 8 characters long"};let r=/[a-zA-Z]/.test(e),a=/\d/.test(e);return r&&a?{isValid:!0}:{isValid:!1,error:"Password must contain both letters and numbers"}},l=e=>!e||isNaN(e)?{isValid:!1,error:"Age is required"}:e<18?{isValid:!1,error:"You must be at least 18 years old"}:e>80?{isValid:!1,error:"Age must be 80 or less"}:{isValid:!0},i=e=>{if(!e)return{isValid:!1,error:"Full name is required"};let r=e.trim();return r.length<2?{isValid:!1,error:"Full name must be at least 2 characters long"}:r.length>50?{isValid:!1,error:"Full name must be 50 characters or less"}:{isValid:!0}},o=e=>e?/^\+[1-9]\d{1,3}\d{4,14}$/.test(e)?{isValid:!0}:{isValid:!1,error:"Please enter a valid international phone number (e.g., +1234567890)"}:{isValid:!0},n=e=>e?e.trim().length<2?{isValid:!1,error:"Please enter a valid country name"}:{isValid:!0}:{isValid:!1,error:"Country is required"},d=e=>e?e.trim().length<2?{isValid:!1,error:"Please enter a valid city name"}:{isValid:!0}:{isValid:!1,error:"City is required"},u=(e,r)=>r?e!==r?{isValid:!1,error:"Passwords do not match"}:{isValid:!0}:{isValid:!1,error:"Please confirm your password"}},51070:(e,r,a)=>{"use strict";a.d(r,{Bb:()=>o,H$:()=>l,xh:()=>i,y3:()=>n});var t=a(23464),s=a(14140);let l=a(6267).Ii.isNativePlatform()?"http://10.0.2.2:4242":"http://localhost:4242",i=t.A.create({baseURL:l,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(async e=>{let r=s.j.currentUser;if(r)try{let a=await r.getIdToken();e.headers.Authorization="Bearer ".concat(a)}catch(e){}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,e=>Promise.reject(e));let o=t.A.create({baseURL:l,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function n(){try{return await t.A.get("".concat(l,"/api"),{timeout:5e3}),!0}catch(e){return!1}}o.interceptors.response.use(e=>e,e=>Promise.reject(e))},98226:(e,r,a)=>{"use strict";a.d(r,{u:()=>t,y:()=>s});var t=function(e){return e.SENDER="sender",e.PICKER="picker",e}({}),s=function(e){return e.WITHIN_CITY="within_city",e.INTER_CITY="inter_city",e.INTERNATIONAL="international",e.COMBINED="combined",e}({})}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,1101,5207,8449,1190,9283,1986,7262,2649,7212,4171,8343,8441,5964,7358],()=>e(e.s=19710)),_N_E=e.O()}]);