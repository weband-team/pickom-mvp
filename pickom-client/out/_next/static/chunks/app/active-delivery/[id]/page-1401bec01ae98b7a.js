(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2790],{6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>l,TK:()=>s,op:()=>o,wz:()=>i});var r=a(51070);let i=async e=>(await r.xh.get("/user/".concat(e))).data,s=async(e,t)=>(await r.xh.put("/user/".concat(e),t)).data,l=async()=>(await r.xh.get("/auth/me")).data,n=async(e,t)=>(await r.xh.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,o=async e=>(await r.xh.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var r=a(23915),i=a(45404);let s=(0,r.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),l=(0,i.xI)(s)},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>o,S1:()=>h,TS:()=>p,XE:()=>d,confirmRecipient:()=>x,createDeliveryRequest:()=>l,fI:()=>s,qM:()=>u,rg:()=>f,updateDeliveryRequest:()=>c,vd:()=>i,zW:()=>n});var r=a(51070);let i=async()=>r.Bb.get("/delivery/pickers"),s=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"within-city";return r.Bb.get("/delivery/pickers/nearby?lat=".concat(e,"&lng=").concat(t,"&deliveryType=").concat(a))},l=async e=>r.xh.post("/delivery/requests",e),n=async()=>r.xh.get("/delivery/requests"),o=async e=>r.xh.get("/delivery/requests/".concat(e)),d=async(e,t)=>r.xh.put("/delivery/requests/".concat(e,"/status"),{status:t}),c=async(e,t)=>r.xh.patch("/delivery/requests/".concat(e),t),u=async()=>r.xh.get("/delivery/completed"),h=async()=>r.xh.get("/delivery/cancelled"),x=async(e,t)=>r.xh.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),f=async e=>r.xh.post("/delivery/find-receiver",{email:e}),p=async()=>r.xh.get("/delivery/incoming")},43452:(e,t,a)=>{"use strict";a.d(t,{MobileContainer:()=>n});var r=a(95155);a(12115);var i=a(54581),s=a(18407),l=a(35695);let n=e=>{let{children:t,width:a=375,height:n=812,showFrame:o=!0,backgroundColor:d,showBottomNav:c=!0}=e,u=(0,l.usePathname)(),h=(null==u?void 0:u.includes("/login"))||(null==u?void 0:u.includes("/register")),x=c&&!h;return o?(0,r.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",padding:3,backgroundColor:"#f5f5f5"},children:(0,r.jsx)(s.A,{elevation:3,sx:{width:a,height:x?"calc(".concat(n,"px - 70px)"):n,borderRadius:6,overflow:"hidden",position:"relative",bgcolor:d||"background.default",border:"8px solid #000000","&::before":{content:'""',position:"absolute",top:12,left:"50%",transform:"translateX(-50%)",width:134,height:6,backgroundColor:"#000000",borderRadius:3,zIndex:1},"&::after":{content:'""',position:"absolute",bottom:8,left:"50%",transform:"translateX(-50%)",width:134,height:5,backgroundColor:"#000000",borderRadius:2.5,zIndex:1}},children:(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100%",height:"100%",paddingTop:"calc(24px + var(--safe-area-top))",overflow:"auto",position:"relative","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{paddingBottom:"calc(16px + var(--safe-area-bottom))",minHeight:"100%"},children:t})})})}):(0,r.jsx)(i.default,{"data-mobile-container":!0,sx:{width:"100vw",height:"100vh",bgcolor:d||"background.default",overflow:"hidden",position:"fixed",left:0,right:0,bottom:0,pt:"env(safe-area-inset-top)",pb:x?"68px":0,margin:0,"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:(0,r.jsx)(i.default,{sx:{width:"100%",height:"100%",overflow:"auto",margin:0,padding:0,"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"},children:t})})}},49569:(e,t,a)=>{Promise.resolve().then(a.bind(a,77702))},51070:(e,t,a)=>{"use strict";a.d(t,{Bb:()=>d,xh:()=>o,y3:()=>c});var r=a(23464),i=a(14140),s=a(6267),l=a(87358);let n=s.Ii.isNativePlatform()?"https://pickom.qirelab.com":l.env.NEXT_PUBLIC_API_URL||"https://pickom.qirelab.com",o=r.A.create({baseURL:n,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(async e=>{let t=i.j.currentUser;if(t)try{let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}catch(e){}return e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>Promise.reject(e));let d=r.A.create({baseURL:n,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function c(){try{return await r.A.get("".concat(n,"/api"),{timeout:5e3}),!0}catch(e){return!1}}d.interceptors.response.use(e=>e,e=>Promise.reject(e))},54670:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var r=a(95155),i=a(54581),s=a(71803),l=a(42663),n=a(71116),o=a(41101),d=a(37429),c=a(26290),u=a(2582),h=a(64341);function x(e){let{sender:t,variant:a="compact",showContact:x=!1}=e,f=t.isPhoneVerified&&t.isEmailVerified;return(0,r.jsx)(i.default,{sx:{p:2,borderRadius:2,backgroundColor:"background.paper",border:1,borderColor:"divider"},children:(0,r.jsxs)(s.A,{direction:"row",spacing:2,alignItems:"flex-start",children:[(0,r.jsx)(l.default,{src:t.avatarUrl,sx:{width:"full"===a?64:48,height:"full"===a?64:48,bgcolor:"primary.main",fontSize:"full"===a?"1.5rem":"1.2rem"},children:t.fullName.charAt(0).toUpperCase()}),(0,r.jsxs)(i.default,{sx:{flex:1},children:[(0,r.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:.5,mb:.5},children:[(0,r.jsx)(n.default,{variant:"full"===a?"h6":"subtitle2",sx:{fontWeight:600},children:t.fullName}),f&&(0,r.jsx)(d.A,{sx:{fontSize:18,color:"primary.main"}})]}),(0,r.jsxs)(n.default,{variant:"body2",color:"text.secondary",sx:{mb:1},children:["⭐ ",t.rating.toFixed(1)," • ",t.totalOrders," ",1===t.totalOrders?"order":"orders"]}),(0,r.jsxs)(i.default,{sx:{display:"flex",gap:1,flexWrap:"wrap",mb:1},children:[t.isPhoneVerified&&(0,r.jsx)(o.A,{icon:(0,r.jsx)(c.default,{sx:{fontSize:14}}),label:"Phone",size:"small",color:"success",variant:"outlined",sx:{height:24,fontSize:"0.7rem"}}),t.isEmailVerified&&(0,r.jsx)(o.A,{icon:(0,r.jsx)(u.default,{sx:{fontSize:14}}),label:"Email",size:"small",color:"success",variant:"outlined",sx:{height:24,fontSize:"0.7rem"}})]}),"full"===a&&(0,r.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:.5,mt:1},children:[(0,r.jsx)(h.A,{sx:{fontSize:14,color:"text.secondary"}}),(0,r.jsxs)(n.default,{variant:"caption",color:"text.secondary",children:["Member since ",new Date(t.memberSince).toLocaleDateString("en-US",{month:"short",year:"numeric"})]})]}),x&&"full"===a&&(0,r.jsxs)(i.default,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[(0,r.jsx)(n.default,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:"Contact Information"}),t.phone&&(0,r.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[(0,r.jsx)(c.default,{sx:{fontSize:16,color:"text.secondary"}}),(0,r.jsx)(n.default,{variant:"body2",children:t.phone})]}),t.email&&(0,r.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(u.default,{sx:{fontSize:16,color:"text.secondary"}}),(0,r.jsx)(n.default,{variant:"body2",children:t.email})]})]})]})]})})}},77702:(e,t,a)=>{"use strict";a.d(t,{default:()=>R});var r=a(95155),i=a(12115),s=a(54581),l=a(14426),n=a(92302),o=a(3127),d=a(71116),c=a(41101),u=a(41218),h=a(16632),x=a(74964),f=a(68534),p=a(36114),m=a(54492),g=a(99927),b=a(76871),v=a(71977),y=a(38464),j=a(52836),k=a(11335),w=a(63645),C=a(21888),A=a(74802),S=a(35695),I=a(43452),W=a(97704),z=a(54670),P=a(21787),T=a(6864);function R(e){var t,a;let{params:R}=e,D=(0,i.use)(R),_=(0,S.useRouter)(),U=Number(D.id),[B,F]=(0,i.useState)(null),[N,q]=(0,i.useState)(null),[E,H]=(0,i.useState)(!0),[M,L]=(0,i.useState)(""),[O,V]=(0,i.useState)({open:!1,newStatus:null}),[X,K]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{H(!0),L("");try{let e=(await (0,P.IT)(U)).data;F(e);let t=(await (0,T.wz)(e.senderId)).user,a={uid:t.uid,fullName:t.name,avatarUrl:t.avatarUrl,rating:4.8,totalOrders:45,isPhoneVerified:!!t.phone,isEmailVerified:!0,memberSince:t.createdAt,phone:t.phone,email:t.email};q(a)}catch(e){L("Failed to load delivery details. Please try again.")}finally{H(!1)}})()},[U]);let Y=e=>{V({open:!0,newStatus:e})},G=async()=>{if(O.newStatus){K(!0);try{await (0,P.XE)(U,O.newStatus),F(e=>e?{...e,status:O.newStatus}:null),alert({picked_up:"Delivery marked as picked up! The sender has been notified.",delivered:"Delivery marked as delivered! Great job!"}[O.newStatus]),"delivered"===O.newStatus&&_.push("/available-deliveries")}catch(e){alert("Failed to update status. Please try again.")}finally{K(!1),V({open:!1,newStatus:null})}}},$=()=>{V({open:!1,newStatus:null})};if(E)return(0,r.jsx)(s.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(l.default,{})});if(M||!B||!N)return(0,r.jsx)(s.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",p:2},children:(0,r.jsx)(n.A,{severity:"error",sx:{maxWidth:375},children:M||"Delivery not found"})});let J="accepted"===B.status,Q="picked_up"===B.status;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.MobileContainer,{showFrame:!1,children:(0,r.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"background.default"},children:[(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:1,p:2,borderBottom:1,borderColor:"divider"},children:[(0,r.jsx)(o.A,{onClick:()=>{_.push("/available-deliveries")},size:"small",children:(0,r.jsx)(y.A,{})}),(0,r.jsxs)(d.default,{variant:"h6",sx:{fontWeight:600,flex:1},children:["Active Delivery #",B.id]}),(0,r.jsx)(c.A,{label:(e=>{switch(e){case"accepted":return"Accepted";case"picked_up":return"Picked Up";case"delivered":return"Delivered";default:return e}})(B.status),size:"small",color:(e=>{switch(e){case"accepted":return"info";case"picked_up":return"primary";case"delivered":return"success";default:return"default"}})(B.status),sx:{fontWeight:600}})]}),(0,r.jsxs)(s.default,{sx:{flex:1,overflow:"auto",pb:20},children:[(0,r.jsx)(u.A,{sx:{m:2,boxShadow:1},children:(0,r.jsxs)(h.A,{children:[(0,r.jsx)(d.default,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Route Details"}),(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(j.A,{sx:{color:"success.main",mt:.5}}),(0,r.jsxs)(s.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Pickup"}),(0,r.jsx)(d.default,{variant:"body2",sx:{fontWeight:500},children:null==(t=B.fromLocation)?void 0:t.address})]})]}),(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(j.A,{sx:{color:"error.main",mt:.5}}),(0,r.jsxs)(s.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Dropoff"}),(0,r.jsx)(d.default,{variant:"body2",sx:{fontWeight:500},children:null==(a=B.toLocation)?void 0:a.address})]})]}),(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[(0,r.jsx)(k.default,{sx:{color:"text.secondary",mt:.5}}),(0,r.jsxs)(s.default,{children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Package"}),(0,r.jsxs)(d.default,{variant:"body2",sx:{fontWeight:500},children:[B.size.charAt(0).toUpperCase()+B.size.slice(1)," parcel",B.weight&&" • ".concat(B.weight," kg")]})]})]}),B.notes&&(0,r.jsxs)(s.default,{sx:{mt:2,p:1.5,borderRadius:1,backgroundColor:"action.hover"},children:[(0,r.jsx)(d.default,{variant:"caption",color:"text.secondary",children:"Notes"}),(0,r.jsx)(d.default,{variant:"body2",children:B.notes})]}),(0,r.jsx)(x.A,{sx:{my:2}}),(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(w.A,{sx:{fontSize:20,color:"primary.main"}}),(0,r.jsxs)(d.default,{variant:"h6",sx:{color:"primary.main",fontWeight:"bold"},children:[B.price," zł"]})]})]})}),(0,r.jsxs)(s.default,{sx:{mx:2,mb:2},children:[(0,r.jsx)(d.default,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"Sender Information"}),(0,r.jsx)(z.A,{sender:N,variant:"full",showContact:!0})]})]}),(0,r.jsx)(s.default,{sx:{position:"absolute",bottom:0,left:0,right:0,p:2,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",boxShadow:3,pb:10},children:(0,r.jsxs)(s.default,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[(0,r.jsx)(f.A,{variant:"outlined",startIcon:(0,r.jsx)(C.A,{}),onClick:()=>{alert("Chat functionality coming soon!")},fullWidth:!0,sx:{minHeight:48,textTransform:"none"},children:"Chat with Sender"}),J&&(0,r.jsx)(f.A,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(A.default,{}),onClick:()=>Y("picked_up"),fullWidth:!0,sx:{minHeight:48,textTransform:"none",fontWeight:600},children:"Mark as Picked Up"}),Q&&(0,r.jsx)(f.A,{variant:"contained",color:"success",startIcon:(0,r.jsx)(A.default,{}),onClick:()=>Y("delivered"),fullWidth:!0,sx:{minHeight:48,textTransform:"none",fontWeight:600},children:"Mark as Delivered"})]})})]})}),(0,r.jsx)(W.default,{}),(0,r.jsxs)(p.A,{open:O.open,onClose:$,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(m.A,{children:"picked_up"===O.newStatus?"Confirm Pickup":"Confirm Delivery"}),(0,r.jsx)(g.A,{children:(0,r.jsx)(b.A,{children:"picked_up"===O.newStatus?(0,r.jsxs)(r.Fragment,{children:["You are about to mark this delivery as ",(0,r.jsx)("strong",{children:"picked up"}),". The sender will be notified that you have collected the package."]}):(0,r.jsxs)(r.Fragment,{children:["You are about to mark this delivery as ",(0,r.jsx)("strong",{children:"delivered"}),". The sender will be notified that the package has been delivered successfully. This will complete the delivery."]})})}),(0,r.jsxs)(v.A,{sx:{px:3,py:2},children:[(0,r.jsx)(f.A,{onClick:$,variant:"outlined",disabled:X,children:"Cancel"}),(0,r.jsx)(f.A,{onClick:G,variant:"contained",color:"picked_up"===O.newStatus?"primary":"success",disabled:X,children:X?"Updating...":"Confirm"})]})]})]})}},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var r=a(95155),i=a(12115),s=a(35695),l=a(18407),n=a(40541),o=a(9111),d=a(26564),c=a(11335),u=a(21888),h=a(43290),x=a(60807);let f=e=>e>99?"99+":e,p=(0,i.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:p=0,userRole:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=(0,s.useRouter)(),b=(0,s.usePathname)(),[v,y]=(0,i.useState)(()=>localStorage.getItem("userRole"));(0,i.useEffect)(()=>{if(!m){let e=null;b.startsWith("/available-deliveries")?e="picker":b.startsWith("/delivery-methods")&&(e="sender"),e&&e!==v&&(y(e),localStorage.setItem("userRole",e))}},[b,m,v]);let j=m||v,k=(0,i.useMemo)(()=>b.startsWith("/delivery-methods")||b.startsWith("/orders")||b.startsWith("/available-deliveries")?0:b.startsWith("/chat")?1:b.startsWith("/notifications")?2:3*!!b.startsWith("/profile"),[b]),[w,C]=(0,i.useState)(k),A=(0,i.useCallback)((e,t)=>{switch(C(t),t){case 0:"picker"===j?g.push("/available-deliveries"):g.push("/delivery-methods");break;case 1:g.push("/chats");break;case 2:g.push("/notifications");break;case 3:g.push("/profile")}},[g,j]);return(0,r.jsx)(l.A,{className:e,sx:{position:"fixed",bottom:0,left:0,right:0,width:"100vw",zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:0,paddingRight:0,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)"},elevation:0,children:(0,r.jsxs)(n.A,{value:w,onChange:A,sx:{backgroundColor:"background.paper",width:"100%",height:"68px",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"},children:[(0,r.jsx)(o.A,{label:"Orders",icon:(0,r.jsx)(d.default,{badgeContent:f(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(c.default,{})})}),(0,r.jsx)(o.A,{label:"Chat",icon:(0,r.jsx)(d.default,{badgeContent:f(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(u.A,{})})}),(0,r.jsx)(o.A,{label:"Notifications",icon:(0,r.jsx)(d.default,{badgeContent:f(p),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,r.jsx)(h.A,{})})}),(0,r.jsx)(o.A,{label:"Profile",icon:(0,r.jsx)(x.default,{})})]})})})}},e=>{e.O(0,[3965,7225,3964,8202,6592,8534,7844,1101,5207,8652,5394,7719,8441,5964,7358],()=>e(e.s=49569)),_N_E=e.O()}]);