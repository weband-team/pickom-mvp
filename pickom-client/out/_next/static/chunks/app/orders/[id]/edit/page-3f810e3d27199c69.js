(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5969],{5825:(e,t,a)=>{"use strict";a.d(t,{default:()=>j});var s=a(95155),r=a(12115),i=a(54581),l=a(14426),n=a(92302),o=a(3127),c=a(71116),d=a(72705),u=a(41218),h=a(16632),p=a(38464),g=a(51935),x=a(35695),v=a(43452),f=a(58343),b=a(97704),m=a(21787),y=a(6864);function j(e){let{params:t}=e,a=(0,r.use)(t),j=(0,x.useRouter)(),k=Number(a.id),[A,C]=(0,r.useState)(null),[S,W]=(0,r.useState)(!0),[w,I]=(0,r.useState)(!1),[R,B]=(0,r.useState)(""),[M,F]=(0,r.useState)(""),[P,z]=(0,r.useState)(""),[D,N]=(0,r.useState)(""),[H,L]=(0,r.useState)(""),[T,q]=(0,r.useState)(""),[E,_]=(0,r.useState)(0),[O,$]=(0,r.useState)("small"),[U,K]=(0,r.useState)(0),[X,Y]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{W(!0),B("");try{var e,t;let a=await (0,y.HW)();F(a.user.uid);let s=(await (0,m.IT)(k)).data;if(C(s),s.senderId!==a.user.uid)return void B("You are not authorized to edit this delivery");if("pending"!==s.status)return void B("You can only edit pending deliveries");z(s.title||""),N(s.description||""),L((null==(e=s.fromLocation)?void 0:e.address)||""),q((null==(t=s.toLocation)?void 0:t.address)||""),_(s.price||0),$(s.size||"small"),K(s.weight||0),Y(s.notes||"")}catch(e){B("Failed to load delivery. Please try again.")}finally{W(!1)}})()},[k]);let V=async()=>{if(A){I(!0),B("");try{await (0,m.updateDeliveryRequest)(k,{title:P,description:D,price:E,size:O,weight:U,notes:X}),alert("Delivery updated successfully!"),j.push("/orders/".concat(k))}catch(e){B("Failed to update delivery. Please try again.")}finally{I(!1)}}},G=()=>{j.push("/orders/".concat(k))};return S?(0,s.jsx)(i.default,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,s.jsx)(l.default,{})}):R?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(v.MobileContainer,{showFrame:!1,children:(0,s.jsxs)(i.default,{sx:{p:3},children:[(0,s.jsx)(n.A,{severity:"error",children:R}),(0,s.jsx)(f.$n,{fullWidth:!0,onClick:()=>j.push("/orders"),sx:{mt:2},children:"Back to Orders"})]})})}):A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.MobileContainer,{showFrame:!1,children:(0,s.jsxs)(i.default,{sx:{minHeight:"100vh",backgroundColor:"background.default",pb:10},children:[(0,s.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:1,borderColor:"divider",backgroundColor:"background.paper"},children:[(0,s.jsx)(o.A,{onClick:G,size:"small",children:(0,s.jsx)(p.A,{})}),(0,s.jsx)(c.default,{variant:"h6",sx:{fontWeight:600},children:"Edit Delivery"}),(0,s.jsx)(o.A,{onClick:V,disabled:w,size:"small",sx:{color:"primary.main"},children:(0,s.jsx)(g.A,{})})]}),(0,s.jsx)(i.default,{sx:{p:2},children:(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Basic Information"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(f.ks,{label:"Title",value:P,onChange:e=>z(e.target.value),placeholder:"Package title",fullWidth:!0}),(0,s.jsx)(f.ks,{label:"Description",value:D,onChange:e=>N(e.target.value),placeholder:"Describe your package",multiline:!0,rows:3,fullWidth:!0})]})]})}),(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Addresses"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(f.ks,{label:"Pickup Address",value:H,onChange:e=>L(e.target.value),placeholder:"From where?",fullWidth:!0}),(0,s.jsx)(f.ks,{label:"Delivery Address",value:T,onChange:e=>q(e.target.value),placeholder:"To where?",fullWidth:!0})]})]})}),(0,s.jsx)(u.A,{children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.default,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Package Details"}),(0,s.jsxs)(d.A,{spacing:2,children:[(0,s.jsx)(f.l6,{label:"Package Size",value:O,onChange:e=>$(e),options:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}],fullWidth:!0}),(0,s.jsx)(f.ks,{label:"Weight (kg)",type:"number",value:U.toString(),onChange:e=>K(Number(e.target.value)),placeholder:"0",fullWidth:!0}),(0,s.jsx)(f.ks,{label:"Price (zÅ‚)",type:"number",value:E.toString(),onChange:e=>_(Number(e.target.value)),placeholder:"0",fullWidth:!0}),(0,s.jsx)(f.ks,{label:"Notes",value:X,onChange:e=>Y(e.target.value),placeholder:"Additional notes",multiline:!0,rows:2,fullWidth:!0})]})]})}),(0,s.jsxs)(d.A,{direction:"row",spacing:2,sx:{pt:2},children:[(0,s.jsx)(f.$n,{variant:"outlined",fullWidth:!0,onClick:G,disabled:w,children:"Cancel"}),(0,s.jsx)(f.$n,{variant:"contained",fullWidth:!0,onClick:V,disabled:w,children:w?"Saving...":"Save Changes"})]})]})})]})}),(0,s.jsx)(b.default,{})]}):null}},6864:(e,t,a)=>{"use strict";a.d(t,{$H:()=>n,HW:()=>l,TK:()=>i,op:()=>o,wz:()=>r});var s=a(51070);let r=async e=>(await s.xh.get("/user/".concat(e))).data,i=async(e,t)=>(await s.xh.put("/user/".concat(e),t)).data,l=async()=>(await s.xh.get("/auth/me")).data,n=async(e,t)=>(await s.xh.put("/user/".concat(e,"/online-status"),{isOnline:t})).data,o=async e=>(await s.xh.get("/user/".concat(e,"/balance"))).data},14140:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var s=a(23915),r=a(45404);let i=(0,s.Wp)({apiKey:"AIzaSyDiclg8XNo2L1hDBoaSoHmFMBggUKYjHH4",authDomain:"pickom-mvp.firebaseapp.com",projectId:"pickom-mvp",storageBucket:"pickom-mvp.firebasestorage.app",messagingSenderId:"168767828055",appId:"1:168767828055:web:2853961b44970c114ab312"}),l=(0,r.xI)(i)},21787:(e,t,a)=>{"use strict";a.d(t,{IT:()=>n,S1:()=>u,TS:()=>g,XE:()=>o,confirmRecipient:()=>h,createDeliveryRequest:()=>i,qM:()=>d,rg:()=>p,updateDeliveryRequest:()=>c,vd:()=>r,zW:()=>l});var s=a(51070);let r=async()=>s.Bb.get("/delivery/pickers"),i=async e=>s.xh.post("/delivery/requests",e),l=async()=>s.xh.get("/delivery/requests"),n=async e=>s.xh.get("/delivery/requests/".concat(e)),o=async(e,t)=>s.xh.put("/delivery/requests/".concat(e,"/status"),{status:t}),c=async(e,t)=>s.xh.patch("/delivery/requests/".concat(e),t),d=async()=>s.xh.get("/delivery/completed"),u=async()=>s.xh.get("/delivery/cancelled"),h=async(e,t)=>s.xh.put("/delivery/requests/".concat(e,"/confirm-recipient"),{confirmed:t}),p=async e=>s.xh.post("/delivery/find-receiver",{email:e}),g=async()=>s.xh.get("/delivery/incoming")},38464:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(31418),r=a(95155);let i=(0,s.A)((0,r.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},51070:(e,t,a)=>{"use strict";a.d(t,{Bb:()=>n,H$:()=>i,xh:()=>l,y3:()=>o});var s=a(23464),r=a(14140);let i=a(6267).Ii.isNativePlatform()?"http://10.0.2.2:4242":"http://localhost:4242",l=s.A.create({baseURL:i,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(async e=>{let t=r.j.currentUser;if(t)try{let a=await t.getIdToken();e.headers.Authorization="Bearer ".concat(a)}catch(e){}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>Promise.reject(e));let n=s.A.create({baseURL:i,withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json"}});async function o(){try{return await s.A.get("".concat(i,"/api"),{timeout:5e3}),!0}catch(e){return!1}}n.interceptors.response.use(e=>e,e=>Promise.reject(e))},51935:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(31418),r=a(95155);let i=(0,s.A)((0,r.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},54147:(e,t,a)=>{Promise.resolve().then(a.bind(a,5825))},72705:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var s=a(12115),r=a(52596),i=a(72890),l=a(90870),n=a(17472);let o=(0,a(11772).Ay)();var c=a(25560),d=a(5300),u=a(85799),h=a(648),p=a(83130),g=a(95155);let x=(0,u.A)(),v=o("div",{name:"MuiStack",slot:"Root"});function f(e){return(0,c.A)({props:e,name:"MuiStack",defaultTheme:x})}let b=e=>{let{ownerState:t,theme:a}=e,s={display:"flex",flexDirection:"column",...(0,h.NI)({theme:a},(0,h.kW)({values:t.direction,breakpoints:a.breakpoints.values}),e=>({flexDirection:e}))};if(t.spacing){let e=(0,p.LX)(a),r=Object.keys(a.breakpoints.values).reduce((e,a)=>(("object"==typeof t.spacing&&null!=t.spacing[a]||"object"==typeof t.direction&&null!=t.direction[a])&&(e[a]=!0),e),{}),l=(0,h.kW)({values:t.direction,base:r}),n=(0,h.kW)({values:t.spacing,base:r});"object"==typeof l&&Object.keys(l).forEach((e,t,a)=>{if(!l[e]){let s=t>0?l[a[t-1]]:"column";l[e]=s}}),s=(0,i.A)(s,(0,h.NI)({theme:a},n,(a,s)=>t.useFlexGap?{gap:(0,p._W)(e,a)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[s?l[s]:t.direction])]:(0,p._W)(e,a)}}))}return(0,h.iZ)(a.breakpoints,s)};var m=a(75955),y=a(10186);let j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{createStyledComponent:t=v,useThemeProps:a=f,componentName:i="MuiStack"}=e,o=t(b);return s.forwardRef(function(e,t){let c=a(e),{component:u="div",direction:h="column",spacing:p=0,divider:x,children:v,className:f,useFlexGap:b=!1,...m}=(0,d.A)(c),y=(0,n.A)({root:["root"]},e=>(0,l.Ay)(i,e),{});return(0,g.jsx)(o,{as:u,ownerState:{direction:h,spacing:p,useFlexGap:b},ref:t,className:(0,r.A)(y.root,f),...m,children:x?function(e,t){let a=s.Children.toArray(e).filter(Boolean);return a.reduce((e,r,i)=>(e.push(r),i<a.length-1&&e.push(s.cloneElement(t,{key:"separator-".concat(i)})),e),[])}(v,x):v})})}({createStyledComponent:(0,m.Ay)("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>(0,y.b)({props:e,name:"MuiStack"})})},97704:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(95155),r=a(12115),i=a(35695),l=a(18407),n=a(40541),o=a(9111),c=a(26564),d=a(11335),u=a(21888),h=a(43290),p=a(60807);let g=e=>e>99?"99+":e,x=(0,r.memo)(function(){let{className:e,unreadChatsCount:t=0,activeOrdersCount:a=0,unreadNotificationsCount:x=0,userRole:v}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=(0,i.useRouter)(),b=(0,i.usePathname)(),[m,y]=(0,r.useState)(()=>localStorage.getItem("userRole"));(0,r.useEffect)(()=>{if(!v){let e=null;b.startsWith("/available-deliveries")?e="picker":b.startsWith("/delivery-methods")&&(e="sender"),e&&e!==m&&(y(e),localStorage.setItem("userRole",e))}},[b,v,m]);let j=v||m,k=(0,r.useMemo)(()=>b.startsWith("/delivery-methods")||b.startsWith("/orders")||b.startsWith("/available-deliveries")?0:b.startsWith("/chat")?1:b.startsWith("/notifications")?2:3*!!b.startsWith("/profile"),[b]),[A,C]=(0,r.useState)(k),S=(0,r.useCallback)((e,t)=>{switch(C(t),t){case 0:"picker"===j?f.push("/available-deliveries"):f.push("/delivery-methods");break;case 1:f.push("/chats");break;case 2:f.push("/notifications");break;case 3:f.push("/profile")}},[f,j]);return(0,s.jsx)(l.A,{className:e,sx:{position:"fixed",bottom:0,left:0,right:0,width:"100vw",zIndex:1200,paddingBottom:"env(safe-area-inset-bottom)",paddingLeft:0,paddingRight:0,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",borderRadius:0,boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)"},elevation:0,children:(0,s.jsxs)(n.A,{value:A,onChange:S,sx:{backgroundColor:"background.paper",width:"100%",height:"68px",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"},children:[(0,s.jsx)(o.A,{label:"Orders",icon:(0,s.jsx)(c.default,{badgeContent:g(a),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(d.default,{})})}),(0,s.jsx)(o.A,{label:"Chat",icon:(0,s.jsx)(c.default,{badgeContent:g(t),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(u.A,{})})}),(0,s.jsx)(o.A,{label:"Notifications",icon:(0,s.jsx)(c.default,{badgeContent:g(x),color:"error",max:99,sx:{"& .MuiBadge-badge":{backgroundColor:"#FF9500",color:"#000000",fontWeight:600}},children:(0,s.jsx)(h.A,{})})}),(0,s.jsx)(o.A,{label:"Profile",icon:(0,s.jsx)(p.default,{})})]})})})}},e=>{e.O(0,[3965,7225,9313,1623,3806,8534,1101,5207,8449,1190,9283,1986,7262,2649,7212,5394,8343,8441,5964,7358],()=>e(e.s=54147)),_N_E=e.O()}]);