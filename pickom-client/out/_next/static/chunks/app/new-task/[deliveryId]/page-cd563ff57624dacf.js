(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6159],{335:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(31418),l=r(95155);let n=(0,a.A)([(0,l.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,l.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule")},11414:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(31418),l=r(95155);let n=(0,a.A)((0,l.jsx)("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16m11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M5 11l1.5-4.5h11L19 11z"}),"DirectionsCar")},26346:(e,t,r)=>{"use strict";r.d(t,{default:()=>S});var a=r(95155),l=r(12115),n=r(35695),o=r(55028),i=r(54581),s=r(14426),c=r(92302),d=r(18407),u=r(71116),f=r(41101),h=r(42663),p=r(31418);let x=(0,p.A)((0,a.jsx)("path",{d:"M12.01 21.49 23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01z"}),"SignalWifi4Bar"),g=(0,p.A)((0,a.jsx)("path",{d:"M24 8.98C20.93 5.9 16.69 4 12 4S3.07 5.9 0 8.98L12 21v-9h8.99zM19.59 14l-2.09 2.09L15.41 14 14 15.41l2.09 2.09L14 19.59 15.41 21l2.09-2.08L19.59 21 21 19.59l-2.08-2.09L21 15.41z"}),"SignalWifiConnectedNoInternet4");var v=r(11414),m=r(335),y=r(60807),j=r(68558),b=r(21787),A=r(6864),k=r(3376);let w=(0,o.default)(()=>Promise.all([r.e(9484),r.e(1761),r.e(2028)]).then(r.bind(r,72028)),{loadableGenerated:{webpack:()=>[72028]},ssr:!1,loading:()=>(0,a.jsx)(i.default,{sx:{height:"60vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(s.default,{})})});function S(){let e=(0,n.useParams)(),t=null==e?void 0:e.deliveryId,[r,o]=(0,l.useState)(null),[p,S]=(0,l.useState)(null),[C,I]=(0,l.useState)(null),[L,M]=(0,l.useState)(null),[z,P]=(0,l.useState)(!0),[N,D]=(0,l.useState)(""),[W,E]=(0,l.useState)(null),[F,R]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,A.HW)();E(e.user)}catch(e){console.error("Error loading current user:",e)}})()},[]);let T=W&&p&&W.id===p.id;(0,k.c)({deliveryId:Number(t),userId:(null==W?void 0:W.id)||0,enabled:!!T&&(null==r?void 0:r.status)==="picked_up",onPermissionDenied:()=>{R(!1)},onPermissionGranted:()=>{R(!0)}});let{isConnected:_}=(0,k.E)({deliveryId:Number(t),userId:(null==W?void 0:W.id)||0,enabled:!!W&&!!r,onLocationUpdate:e=>{console.log("Picker location updated via WebSocket:",e),I({lat:e.lat,lng:e.lng})},onStatusUpdate:e=>{console.log("Delivery status updated via WebSocket:",e),r&&o({...r,status:e})},onTrackingData:e=>{console.log("Received full tracking data:",e),e.pickerLocation&&I({lat:e.pickerLocation.lat,lng:e.pickerLocation.lng})},onError:e=>{console.error("WebSocket error:",e),D(e)}});(0,l.useEffect)(()=>{(async()=>{try{P(!0);let e=await (0,b.IT)(Number(t));if(o(e.data),e.data.pickerId){let t=await (0,A.wz)(e.data.pickerId);S(t.user),t.user.location&&I(t.user.location)}P(!1)}catch(e){console.error("Error loading delivery:",e),D(e.message||"Failed to load delivery information"),P(!1)}})()},[t]);let B=async(e,t)=>{try{let r="https://router.project-osrm.org/route/v1/driving/".concat(e.lng,",").concat(e.lat,";").concat(t.lng,",").concat(t.lat,"?overview=full&geometries=geojson"),a=await fetch(r),l=await a.json();if("Ok"!==l.code||!l.routes||0===l.routes.length)return{distance:"N/A",duration:"N/A",coordinates:[[e.lat,e.lng],[t.lat,t.lng]]};let n=l.routes[0],o=n.geometry.coordinates.map(e=>[e[1],e[0]]);return{distance:"".concat((n.distance/1e3).toFixed(1)," km"),duration:"".concat(Math.round(n.duration/60)," min"),coordinates:o}}catch(r){return console.error("Route calculation error:",r),{distance:"N/A",duration:"N/A",coordinates:[[e.lat,e.lng],[t.lat,t.lng]]}}};return((0,l.useEffect)(()=>{C&&(null==r?void 0:r.toLocation)&&(async()=>{try{let e=await B(C,r.toLocation);M(e)}catch(e){console.error("Error calculating route:",e)}})()},[C,null==r?void 0:r.toLocation]),z)?(0,a.jsx)(i.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:(0,a.jsx)(s.default,{})}):N||!r?(0,a.jsx)(i.default,{sx:{p:2},children:(0,a.jsx)(c.A,{severity:"error",children:N||"Delivery not found"})}):(0,a.jsxs)(i.default,{sx:{p:2,maxWidth:"1200px",margin:"0 auto"},children:[(0,a.jsxs)(d.A,{sx:{p:2,mb:2},children:[(0,a.jsxs)(i.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,a.jsx)(u.default,{variant:"h5",children:"Delivery Tracking"}),(0,a.jsx)(f.A,{icon:_&&(F||!T)?(0,a.jsx)(x,{}):(0,a.jsx)(g,{}),label:_&&(F||!T)?"Live Tracking":_&&!F&&T?"Permission Denied":"Connecting...",color:_&&(F||!T)?"success":_&&!F&&T?"error":"default",size:"small"})]}),(0,a.jsxs)(i.default,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[(0,a.jsx)(f.A,{label:r.status.replace("_"," ").toUpperCase(),color:(e=>{switch(e){case"pending":return"warning";case"accepted":return"info";case"picked_up":return"primary";case"delivered":return"success";case"cancelled":return"error";default:return"default"}})(r.status),size:"small"}),L&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{icon:(0,a.jsx)(v.A,{}),label:"Distance: ".concat(L.distance),size:"small",variant:"outlined"}),(0,a.jsx)(f.A,{icon:(0,a.jsx)(m.A,{}),label:"ETA: ".concat(L.duration),size:"small",variant:"outlined"})]})]})]}),(0,a.jsx)(d.A,{sx:{mb:2,overflow:"hidden",borderRadius:2},children:(0,a.jsx)(w,{delivery:r,picker:p,pickerLocation:C,route:L})}),(0,a.jsxs)(d.A,{sx:{p:2,mb:2},children:[(0,a.jsx)(u.default,{variant:"h6",gutterBottom:!0,children:r.title}),r.description&&(0,a.jsx)(u.default,{variant:"body2",color:"text.secondary",sx:{mb:2},children:r.description}),(0,a.jsxs)(i.default,{sx:{display:"flex",gap:2,flexWrap:"wrap",mt:2},children:[(0,a.jsxs)(i.default,{children:[(0,a.jsx)(u.default,{variant:"caption",color:"text.secondary",children:"Size"}),(0,a.jsx)(u.default,{variant:"body2",fontWeight:600,children:r.size})]}),(0,a.jsxs)(i.default,{children:[(0,a.jsx)(u.default,{variant:"caption",color:"text.secondary",children:"Price"}),(0,a.jsxs)(u.default,{variant:"body2",fontWeight:600,children:["$",r.price]})]}),r.weight&&(0,a.jsxs)(i.default,{children:[(0,a.jsx)(u.default,{variant:"caption",color:"text.secondary",children:"Weight"}),(0,a.jsxs)(u.default,{variant:"body2",fontWeight:600,children:[r.weight," kg"]})]})]})]}),p&&(0,a.jsxs)(d.A,{sx:{p:2},children:[(0,a.jsxs)(u.default,{variant:"subtitle1",gutterBottom:!0,fontWeight:600,children:[(0,a.jsx)(y.default,{})," Courier Information"]}),(0,a.jsxs)(i.default,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,a.jsx)(h.default,{src:p.avatarUrl,sx:{width:60,height:60},children:p.name.charAt(0)}),(0,a.jsxs)(i.default,{children:[(0,a.jsx)(u.default,{variant:"body1",fontWeight:600,children:p.name}),(0,a.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,a.jsx)(j.default,{fontSize:"small",sx:{color:"gold"}}),(0,a.jsx)(u.default,{variant:"body2",children:p.rating?Number(p.rating).toFixed(1):"N/A"}),(0,a.jsxs)(u.default,{variant:"caption",color:"text.secondary",children:["(",p.totalRatings||0," ratings)"]})]}),(0,a.jsxs)(u.default,{variant:"body2",color:"text.secondary",children:[p.completedDeliveries||0," completed deliveries"]})]})]})]})]})}},42663:(e,t,r)=>{"use strict";r.d(t,{default:()=>y});var a=r(12115),l=r(52596),n=r(17472),o=r(75955),i=r(40680),s=r(10186),c=r(31418),d=r(95155);let u=(0,c.A)((0,d.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");var f=r(55170),h=r(90870);function p(e){return(0,h.Ay)("MuiAvatar",e)}(0,f.A)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var x=r(47798);let g=(0,o.Ay)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],r.colorDefault&&t.colorDefault]}})((0,i.A)(e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}})),v=(0,o.Ay)("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),m=(0,o.Ay)(u,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"}),y=a.forwardRef(function(e,t){let r=(0,s.b)({props:e,name:"MuiAvatar"}),{alt:o,children:i,className:c,component:u="div",slots:f={},slotProps:h={},imgProps:y,sizes:j,src:b,srcSet:A,variant:k="circular",...w}=r,S=null,C={...r,component:u,variant:k},I=function(e){let{crossOrigin:t,referrerPolicy:r,src:l,srcSet:n}=e,[o,i]=a.useState(!1);return a.useEffect(()=>{if(!l&&!n)return;i(!1);let e=!0,a=new Image;return a.onload=()=>{e&&i("loaded")},a.onerror=()=>{e&&i("error")},a.crossOrigin=t,a.referrerPolicy=r,a.src=l,n&&(a.srcset=n),()=>{e=!1}},[t,r,l,n]),o}({...y,..."function"==typeof h.img?h.img(C):h.img,src:b,srcSet:A}),L=b||A,M=L&&"error"!==I;C.colorDefault=!M,delete C.ownerState;let z=(e=>{let{classes:t,variant:r,colorDefault:a}=e;return(0,n.A)({root:["root",r,a&&"colorDefault"],img:["img"],fallback:["fallback"]},p,t)})(C),[P,N]=(0,x.A)("root",{ref:t,className:(0,l.A)(z.root,c),elementType:g,externalForwardedProps:{slots:f,slotProps:h,component:u,...w},ownerState:C}),[D,W]=(0,x.A)("img",{className:z.img,elementType:v,externalForwardedProps:{slots:f,slotProps:{img:{...y,...h.img}}},additionalProps:{alt:o,src:b,srcSet:A,sizes:j},ownerState:C}),[E,F]=(0,x.A)("fallback",{className:z.fallback,elementType:m,externalForwardedProps:{slots:f,slotProps:h},shouldForwardComponentProp:!0,ownerState:C});return S=M?(0,d.jsx)(D,{...W}):i||0===i?i:L&&o?o[0]:(0,d.jsx)(E,{...F}),(0,d.jsx)(P,{...N,children:S})})},60807:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var a=r(31418),l=r(95155);let n=(0,a.A)((0,l.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person")},68558:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var a=r(31418),l=r(95155);let n=(0,a.A)((0,l.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star")},70118:(e,t,r)=>{Promise.resolve().then(r.bind(r,26346))}},e=>{e.O(0,[3965,7225,3964,8202,6592,1101,4874,5053,8441,5964,7358],()=>e(e.s=70118)),_N_E=e.O()}]);